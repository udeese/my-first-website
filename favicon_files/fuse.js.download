!function(e){"function"==typeof fuseDefine&&fuseDefine.amd?fuseDefine(e):e()}((function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function t(e,t,i){return t=s(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,i||[],s(e).constructor):t.apply(e,i))}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t,i){return(t=g(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,o,r,s,a=[],u=!0,l=!1;try{if(r=(i=i.call(e)).next,0===t);else for(;!(u=(n=r.call(i)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function f(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var o,r,s=0|t,a=Math.max(0<=s?s:n-Math.abs(s),0);a<n;){if((o=i[a])===(r=e)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;a++}return!1}}),"undefined"!=typeof window&&window.NodeList&&!window.NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(i,n){return Array.isArray(n)?i.push.apply(i,e.call(n,t-1)):i.push(n),i}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var p=["verbose","debug","info","warn","error","off"],v=function(){return o((function e(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"off";i(this,e),this.console=t,this.logName=n,this.fuseDob=o,this.logLevel=r,this.logs=[]}),[{key:"setFuseDob",value:function(e){this.fuseDob=e}},{key:"getTimestamp",value:function(){return this.fuseDob?" [".concat(Date.now()-this.fuseDob,"]"):""}},{key:"callLogMethod",value:function(e){if("off"!==e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o=["[".concat(this.logName,"]-").concat(i[0]).concat(this.getTimestamp())].concat(d(i.slice(1)));if("warn"!==e&&"error"!==e||(this.logs.length>=1e3&&(this.logs=[]),this.logs.push({level:e,params:o})),!("error"!==e&&p.indexOf(e)<p.indexOf(this.logLevel))){var r="verbose"!=e?e:"debug";this.console[r].apply(null,o)}}}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.callLogMethod("error",t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.callLogMethod("warn",t)}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.callLogMethod("info",t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.callLogMethod("info",t)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.callLogMethod("debug",t)}},{key:"setLogLevel",value:function(e){this.logLevel=e}},{key:"getLogLevel",value:function(){return this.logLevel}},{key:"getLogs",value:function(){return this.logs}}])}();function b(e){return"number"==typeof e&&e==e}function m(e){return null==e}function S(e){return void 0===e}function y(e){return!m(e)}function k(e){return Array.isArray(e)&&e.length>0}function I(e){throw new Error("exhaustiveCheck(".concat(e,") should not have been called"))}var w=function(){return o((function e(){i(this,e),this.sessionId=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t="",i=0;i<e;++i)t+=Math.floor(16*Math.random()).toString(16);return t}()}),[{key:"isInDebugMode",value:function(){return"true"===this.getQueryParam("fuse_debug")[1]}},{key:"getWindowLocation",value:function(){if(!this.location)try{this.location=this.getBrowserWindowObject().self.location}catch(e){this.location=this.getBrowserWindowObject().location}return this.location}},{key:"getFuseDob",value:function(){var e,t=this.getBrowserWindowObject().performance;return(null===(e=null==t?void 0:t.timing)||void 0===e?void 0:e.navigationStart)||t.timeOrigin}},{key:"getPackageMajorVersion",value:function(){return 2}},{key:"getBrowserWindowObject",value:function(){return window.self}},{key:"getQueryParam",value:function(e){var t=this.getWindowLocation().search.split(/[?&]/).filter((function(e){return""!==e})).map((function(e){return e.split("=")})).filter((function(t){return t[0]===e}));return t[0]||[]}},{key:"getMainLogPrefix",value:function(){return"FUSE"}},{key:"getLogLevel",value:function(){var e;if(this.isInDebugMode()||y(this.fuseDebugger))return"debug";if(null===(e=this.getQueryParam("fuse_log_level"))||void 0===e?void 0:e[1]){var t=this.getQueryParam("fuse_log_level")[1];return-1!==p.indexOf(t)?t:"off"}return"off"}},{key:"getLogger",value:function(){return this.logger||(this.logger=new v(this.getBrowserWindowObject().console,this.getMainLogPrefix(),this.getFuseDob(),this.getLogLevel())),this.logger}},{key:"getFuseDebugger",value:function(){var e;if(S(this.fuseDebugger)){var t=E.getBrowserWindowObject().fuseDebugger;this.fuseDebugger=null!=t?t:null,this.fuseDebugger&&(this.fuseDebugger.connect(),this.getLogger().debug("[MONITORING]: Debugger attached"))}return null!==(e=this.fuseDebugger)&&void 0!==e?e:void 0}},{key:"getSessionId",value:function(){return this.sessionId}}])}(),E=new w;function C(e,t){e&&t()}function T(e,t,i,n){e&&e>0?(i.info("[DELAY]: Delaying by ".concat(e,"ms to ").concat(t)),setTimeout(n,e)):n()}var x,_,A,R=function(e){return/[E]dge/.test(e.navigator.userAgent)},P=E.getBrowserWindowObject(),O=E.getLogger(),D=function(e,t){var i;O.debug("[INIT]: Downloading library ".concat(e.name));var n=P.document.createElement("script");if(n.async=!0,n.type="text/javascript",e.id&&(n.id=e.id),e.attributes&&Object.keys(e.attributes).forEach((function(t){n.setAttribute(t,e.attributes[t])})),"function"==typeof t&&(n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()}),n.src="https:".concat(e.url).concat(e.file),e.query&&(n.src="".concat(n.src,"?").concat(e.query)),e.insertSelector){var o=P.document.querySelector(e.insertSelector);o?o.appendChild(n):O.warn("[INIT]: Injection library ".concat(e.name,". Element with selector ").concat(e.insertSelector," not found"))}else{var r=P.document.getElementsByTagName("script")[0];null===(i=r.parentNode)||void 0===i||i.insertBefore(n,r)}};!function(e){e.Desktop="desktop",e.Tablet="tablet",e.Mobile="mobile"}(x||(x={})),function(e){e.Chrome="chrome",e.Safari="safari",e.Opera="opera",e.Edge="edge",e.IE11="ie11",e.Firefox="firefox",e.Other="other"}(_||(_={})),function(e){e.IOS="ios",e.MacOS="mac",e.Android="android",e.Windows="windows",e.Linux="linux",e.ChromeOs="chromeos",e.Other="other"}(A||(A={}));var z=[{regex:/\sedg\//i,browser:_.Edge},{regex:/edg([ea]|ios)/i,browser:_.Edge},{regex:/opera/i,browser:_.Opera},{regex:/opr\/|opios/i,browser:_.Opera},{regex:/chrome|crios|crmo/i,browser:_.Chrome},{regex:/firefox|iceweasel|fxios/i,browser:_.Firefox},{regex:/safari|applewebkit/i,browser:_.Safari}],L=[{regex:/huawei/i,device:x.Mobile},{regex:/nexus\s*(?:7|8|9|10).*/i,device:x.Tablet},{regex:/ipad/i,device:x.Tablet},{regex:/tablet(?! pc)/i,device:x.Tablet},{regex:/(ipod|iphone)/i,device:x.Mobile},{regex:/nexus\s*[0-6].*/i,device:x.Mobile},{regex:/[^-]mobi/i,device:x.Mobile}],N=[{os:A.MacOS,regex:/macintosh/i},{os:A.IOS,regex:/(ipod|iphone|ipad)/i},{os:A.Android,regex:/android/i},{os:A.Windows,regex:/windows /i},{os:A.Linux,regex:/linux/i},{os:A.ChromeOs,regex:/CrOS/}],B=function(){return o((function e(t){i(this,e),this.browserWindow=t,this.userAgent=t.navigator.userAgent,this.device=this.parseDevice(),this.browser=this.parseBrowser(),this.os=this.parseOperatingSystem()}),[{key:"parseDevice",value:function(){var e,t=this,i=L.filter((function(e){return e.regex.test(t.userAgent)}));return i.length>0?i[0].device:(null===(e=this.browserWindow.navigator.userAgentData)||void 0===e?void 0:e.mobile)?x.Mobile:x.Desktop}},{key:"parseBrowser",value:function(){var e=this,t=z.filter((function(t){return t.regex.test(e.userAgent)}));return t.length>0?t[0].browser:_.Other}},{key:"parseOperatingSystem",value:function(){var e=this,t=N.filter((function(t){return t.regex.test(e.userAgent)}));return t.length>0?t[0].os:A.Other}},{key:"getDevice",value:function(){return this.device}},{key:"getBrowser",value:function(){return this.browser}},{key:"getOperatingSystem",value:function(){return this.os}}])}(),M=function(){return o((function e(t,n){var o=this;i(this,e),this.fuseDob=t,this.states=[],this.events=[],this.slotProblems=[],this.firstSlotLoaded=!1,this.firstSlotRenderEnded=!1,this.firstImpressionViewed=!1;var s=Date.now();this._tagLoadedMs=s-this.getFuseDob(),this.states.push(r(r(r({},"tag_loaded",!0),"ts",s),"load_time_ms",this._tagLoadedMs)),n.onSlotLoaded.subscribe((function(e){o.firstSlotLoaded||(o.setStateStatus("gpt_first_slot_loaded"),o.firstSlotLoaded=!0),o.addAdEvent("gpt_slot_loaded_".concat(e.slot.getSlotElementId()))})),n.onSlotResponse.subscribe((function(e){o.firstSlotRenderEnded||(o.setStateStatus("gpt_first_slot_render_ended"),o.firstSlotRenderEnded=!0),o.addAdEvent("gpt_slot_render_ended_".concat(e.slot.getSlotElementId()))})),n.onImpressionViewable.subscribe((function(e){o.firstImpressionViewed||(o.setStateStatus("gpt_first_impression_viewable"),o.firstImpressionViewed=!0),o.addAdEvent("gpt_impression_viewable_".concat(e.slot.getSlotElementId()))}))}),[{key:"getSlotProblems",value:function(){return this.slotProblems}},{key:"addSlotProblem",value:function(e){this.slotProblems.length>=1e3&&(this.slotProblems=this.slotProblems.slice(100)),this.slotProblems.push(Object.assign(Object.assign({},e),{time:this.getElapsedTime()}))}},{key:"getFuseDob",value:function(){return this.fuseDob}},{key:"getElapsedTime",value:function(){return(new Date).getTime()-this.getFuseDob()}},{key:"reportFirstGptRequest",value:function(){this._firstGptRequestMs=this.getElapsedTime()}},{key:"firstGptRequestMs",get:function(){return this._firstGptRequestMs}},{key:"reportCmpLoadFinish",value:function(){this._cmpLoadFinishMs=this._cmpLoadFinishMs||this.getElapsedTime()}},{key:"cmpLoadFinishMs",get:function(){return this._cmpLoadFinishMs}},{key:"cmpGdprCached",get:function(){return Boolean(this._cmpGdprElapsedMs&&this._cmpGdprElapsedMs<=10)}},{key:"reportCmpGdprDetermined",value:function(){this._cmpGdprElapsedMs=this._cmpGdprElapsedMs||this.getElapsedTime()-this.cmpLoadFinishMs}},{key:"cmpGdprElapsedMs",get:function(){return this._cmpGdprElapsedMs}},{key:"reportFirstZone",value:function(){this._firstZoneMs=this._firstZoneMs||this.getElapsedTime()}},{key:"firstZoneMs",get:function(){return this._firstZoneMs}},{key:"reportHbAuctionStart",value:function(){this._hbAuctionStartMs=this._hbAuctionStartMs||this.getElapsedTime()}},{key:"hbAuctionStartMs",get:function(){return this._hbAuctionStartMs}},{key:"tagLoadedMs",get:function(){return this._tagLoadedMs}},{key:"setStateStatus",value:function(e){var t=Date.now();this.states.push(r(r(r({},e,!0),"ts",t),"load_time_ms",t-this.getFuseDob()))}},{key:"addAdEvent",value:function(e,t){var i=Date.now();this.events.push(Object.assign(Object.assign({adEvent:e},t),{ts:i,event_time_ms:i-this.getFuseDob()}))}},{key:"getIsCmpPromptShown",value:function(){return Boolean(this.states.find((function(e){return e.cmp_prompt_shown})))}}])}();function F(e){if(e>=1e4)return"over_9999";var t=e<4e3?500:1e3,i=Math.floor(e/t)*t;return"".concat(i,"-").concat(i+t-1)}var j=function(e){return e<50?e.toString():e<76?"50-75":e<101?"76-100":e<151?"101-150":e<201?"151-200":e<301?"201-300":e<401?"301-400":e<501?"401-500":"over_500"};function U(e){return{_tag:"loading",loadStart:e,deferredLoad:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}function G(e,t,i){return{_tag:"ready",loadStart:e.loadStart,loadFinish:t,loadElapsed:t-e.loadStart,deferredLoad:e.deferredLoad,output:i}}var W=function(){return o((function e(t,n,o){i(this,e),this.onComponentInitEvent=t,this.logger=n,this.reporter=o,this._state={yandex:{_tag:"pending"},gpt:{_tag:"pending"},prebid:{_tag:"pending"},cmp:{_tag:"pending"},uam:{_tag:"pending"},docReadyScan:{_tag:"pending"}}}),[{key:"state",get:function(){return this._state}},{key:"updateState",value:function(e,t){this._state[e]=t,this.reporter.setStateStatus("component_init_".concat(e,"_").concat(t._tag)),"ready"===t._tag&&this.logger.log("[INIT]: Component ".concat(e," is ready")),this.onComponentInitEvent.emit({component:e,state:t})}}])}();function V(e){return"disabled"==e._tag||"ready"===e._tag&&e.output.allowPersonalisation}function H(e){return"ready"==e._tag?e.output.jurisdiction:"unknown"}function Z(e){switch(e._tag){case"ready":return F(e.loadFinish);case"deferred":case"disabled":return"disabled";case"cancelled":return e._tag;case"pending":case"loading":return"not_ready";default:I(e)}}var q,Y=function(e){return e[0]+"x"+e[1]},J=function(e){return e.split("x").map(Number)},Q=function(e){var t=[1,1];return e.forEach((function(e){e[0]>t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])})),t},K=function(e,t){return parseInt((100*(e/t-1)).toFixed())},X=-1,$=function(e){addEventListener("pageshow",(function(t){t.persisted&&(X=t.timeStamp,e(t))}),!0)},ee=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},te=function(){var e=ee();return e&&e.activationStart||0},ie=function(e,t){var i=ee(),n="navigate";return X>=0?n="back-forward-cache":i&&(document.prerendering||te()>0?n="prerender":document.wasDiscarded?n="restore":i.type&&(n=i.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},ne=function(e,t,i){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return n.observe(Object.assign({type:e,buffered:!0},i||{})),n}}catch(e){}},oe=function(e,t,i,n){var o,r;return function(s){t.value>=0&&(s||n)&&((r=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=r,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,i),e(t))}},re=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},se=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},ae=function(e){var t=!1;return function(){t||(e(),t=!0)}},ue=-1,le=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},ce=function(e){"hidden"===document.visibilityState&&ue>-1&&(ue="visibilitychange"===e.type?e.timeStamp:0,ge())},de=function(){addEventListener("visibilitychange",ce,!0),addEventListener("prerenderingchange",ce,!0)},ge=function(){removeEventListener("visibilitychange",ce,!0),removeEventListener("prerenderingchange",ce,!0)},he=function(){return ue<0&&(ue=le(),de(),$((function(){setTimeout((function(){ue=le(),de()}),0)}))),{get firstHiddenTime(){return ue}}},fe=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},pe=[1800,3e3],ve=function(e,t){t=t||{},fe((function(){var i,n=he(),o=ie("FCP"),r=ne("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(r.disconnect(),e.startTime<n.firstHiddenTime&&(o.value=Math.max(e.startTime-te(),0),o.entries.push(e),i(!0)))}))}));r&&(i=oe(e,o,pe,t.reportAllChanges),$((function(n){o=ie("FCP"),i=oe(e,o,pe,t.reportAllChanges),re((function(){o.value=performance.now()-n.timeStamp,i(!0)}))})))}))},be=[.1,.25],me=0,Se=1/0,ye=0,ke=function(e){e.forEach((function(e){e.interactionId&&(Se=Math.min(Se,e.interactionId),ye=Math.max(ye,e.interactionId),me=ye?(ye-Se)/7+1:0)}))},Ie=function(){return q?me:performance.interactionCount||0},we=function(){"interactionCount"in performance||q||(q=ne("event",ke,{type:"event",buffered:!0,durationThreshold:0}))},Ee=[],Ce=new Map,Te=0,xe=[],_e=function(e){if(xe.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=Ee[Ee.length-1],i=Ce.get(e.interactionId);if(i||Ee.length<10||e.duration>t.latency){if(i)e.duration>i.latency?(i.entries=[e],i.latency=e.duration):e.duration===i.latency&&e.startTime===i.entries[0].startTime&&i.entries.push(e);else{var n={id:e.interactionId,latency:e.duration,entries:[e]};Ce.set(n.id,n),Ee.push(n)}Ee.sort((function(e,t){return t.latency-e.latency})),Ee.length>10&&Ee.splice(10).forEach((function(e){return Ce.delete(e.id)}))}}},Ae=function(e){var t=self.requestIdleCallback||self.setTimeout,i=-1;return e=ae(e),"hidden"===document.visibilityState?e():(i=t(e),se(e)),i},Re=[200,500],Pe=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},fe((function(){var i;we();var n,o=ie("INP"),r=function(e){Ae((function(){e.forEach(_e);var t=function(){var e=Math.min(Ee.length-1,Math.floor((Ie()-Te)/50));return Ee[e]}();t&&t.latency!==o.value&&(o.value=t.latency,o.entries=t.entries,n())}))},s=ne("event",r,{durationThreshold:null!==(i=t.durationThreshold)&&void 0!==i?i:40});n=oe(e,o,Re,t.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),se((function(){r(s.takeRecords()),n(!0)})),$((function(){Te=Ie(),Ee.length=0,Ce.clear(),o=ie("INP"),n=oe(e,o,Re,t.reportAllChanges)})))})))},Oe=[2500,4e3],De={},ze=[800,1800],Le=function e(t){document.prerendering?fe((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Ne=function(e,t){t=t||{};var i=ie("TTFB"),n=oe(e,i,ze,t.reportAllChanges);Le((function(){var o=ee();o&&(i.value=Math.max(o.responseStart-te(),0),i.entries=[o],n(!0),$((function(){i=ie("TTFB",0),(n=oe(e,i,ze,t.reportAllChanges))(!0)})))}))},Be=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},Me=function(e){var t,i,n;if("LCP"===e.name)n=null===(t=e.entries[0])||void 0===t?void 0:t.element;else if("CLS"===e.name){var o=e.entries.reduce((function(e,t){return!e||t.value>e.value?t:e}),void 0);n=null===(i=null==o?void 0:o.sources[o.sources.length-1])||void 0===i?void 0:i.node}else if("INP"===e.name){var r=e.entries.reduce((function(e,t){return!e||t.duration>e.duration?t:e}),void 0);n=null==r?void 0:r.target}return n?function(e){var t,i;if(!(null==e?void 0:e.tagName)||!(null==e?void 0:e.classList))return"";var n=e.tagName.toLowerCase(),o=e.id?" #".concat(e.id):"",r=e.classList.length>0?" .".concat(e.classList.value):"",s=null!==(i=null===(t=e.style)||void 0===t?void 0:t.cssText)&&void 0!==i?i:"",a=e.getAttribute("data-fuse"),u=a?' [data-fuse="'.concat(a,'"]'):"";return"".concat(n).concat(o).concat(r).concat(u," ").concat(s).trim()}(n):void 0},Fe=function(){return o((function e(t,n,o,r,s,a,u,l,c,d,g,h){var f=this;i(this,e),this.componentState=t,this.deviceInfo=n,this.logger=o,this.browserWindow=r,this.sessionId=s,this.gptCountManager=a,this.reporter=u,this.comboZoneState=l,this.requestMethod=c,this.settings=d,this.objectToCompressedBase64=h,this.backgroundRequestTimeout=void 0,this.requestQueue=new Set,this.baseUrl=d.getFuseCDN(),this.fuseCDNPlatform=d.getFuseCDNPlatform(),this.fuseUuid=d.getFuseUUID(),this.fuseId=d.getFuseId(),this.publicationId=d.getPublicationId(),this.adServer=d.isYandexEnabled()?"yandex":"gpt",this.tenantId=d.getTenantCode(),this.accountCode=d.getAccountCode(),this.isBidCacheEnabled=d.isBidCacheEnabled(),this.prebidTelemetrySampleRate=d.getPrebidTelemetrySampleRate(),this.slotRequestTelemetrySampleRate=d.getSlotRequestTelemetrySampleRate(),this.prebidAdRenderSucceededTelemetrySampleRate=d.getPrebidAdRenderSucceededTelemetrySampleRate(),this.experiments=Object.assign(Object.assign({},d.getYieldExperimentsTargeting()),d.getAdditionalYieldExperimentsTargeting()),d.getUseTelemetry()&&(g.onSlotRequested.subscribe((function(e){var t=e.slot.getAdUnitPath(),i=d.getFuseSlots().filter((function(e){return e.slot===t}))[0];i&&f.recordSlotRequest(i.id)})),g.onPageInit.subscribe((function(e){e.isPageTransition&&f.recordPageTransition(r.scrollY)})),g.onComponentInitEvent.subscribe((function(e){if("cmp"===e.component&&["ready","disabled"].includes(e.state._tag)){var t="ready"===e.state._tag?e.state:void 0,i=f.componentState.state;f.recordCmpDetermined({gdpr:"gdpr"===H(i.cmp)||!1,TCData:null==t?void 0:t.output.tcData,prebid_nry:"ready"!==i.prebid._tag||!1,uam_nry:"ready"!==i.uam._tag||!1,adserver_nry:"ready"!==i.gpt._tag&&"ready"!==i.yandex._tag||!1,docscan_nry:"ready"!==i.docReadyScan._tag||!1,no_cmp:"disabled"===e.state._tag},d.getCmpDeterminedSampleRate())}})))}),[{key:"recordSlotRequest",value:function(e){this.sendTelemetryRequest("slot-request",{auid:e,srate:this.slotRequestTelemetrySampleRate},this.getCmpData()),this.logDetails(e,"slot-request")}},{key:"recordPrebidAdRenderFailed",value:function(e){var t,i,n,o=this,r={bid:e.bid,size:null===(t=e.bid)||void 0===t?void 0:t.size,mediaType:null===(i=e.bid)||void 0===i?void 0:i.mediaType,bidder:null===(n=e.bid)||void 0===n?void 0:n.bidder,message:e.message,reason:e.reason,adId:e.adId};try{!r.bidder&&this.browserWindow.fusePbjs&&e.adId&&Object.values(this.browserWindow.fusePbjs.getBidResponses()).forEach((function(t){var i=t.bids.find((function(t){return t.adId===e.adId}));i&&(r.bidder=i.bidder,r.size=i.size,r.mediaType=i.mediaType)}))}catch(t){this.logger.error("[TELEMETRY]: Error getting bid response for adId ".concat(e.adId,": ").concat(JSON.stringify(t)))}return this.compressPayload(r,"prebid-ad-render-failed",3e3).then((function(e){var t=e.compressedData,i=e.errMsg;return o.sendTelemetryRequest("prebid-ad-render-failed",{pbAdRenderFailedGzipped:t,errMsg:i})}))}},{key:"recordPrebidAdRenderSucceeded",value:function(e){var t,i,n,o=this,r={size:null===(t=e.bid)||void 0===t?void 0:t.size,mediaType:null===(i=e.bid)||void 0===i?void 0:i.mediaType,bidder:null===(n=e.bid)||void 0===n?void 0:n.bidder,adId:e.adId};return this.compressPayload(r,"prebid-ad-render-succeeded",3e3).then((function(e){var t=e.compressedData,i=e.errMsg;return o.sendTelemetryRequest("prebid-ad-render-succeeded",{pbAdRenderSucceededGzipped:t,srate:o.prebidAdRenderSucceededTelemetrySampleRate,errMsg:i})}))}},{key:"recordPrebidAuctionEnd",value:function(e,t,i){var n=this,o=Array.from(new Set(e.adUnits.map((function(e){return e.code})))),r={pbVer:t,aucId:e.auctionId,aucTimeout:e.timeout,aucStart:e.timestamp,aucEnd:e.auctionEnd,bidCacheEnabled:this.isBidCacheEnabled,zones:o.map((function(t){var o=i.getSlot(t),r=n.gptCountManager.getSlotRefreshCount(t),s=n.gptCountManager.getTemplateUsageCount(null==o?void 0:o.zoneTemplateId);return{id:t,isRefresh:r>0,slotPrevReq:j(r),templatePrevReq:j(s),bidders:e.bidderRequests.filter((function(e){return e.bids.find((function(e){return e.adUnitCode===t}))})).map((function(e){return e.bidderCode})),bidsReceived:e.bidsReceived.filter((function(e){return e.adUnitCode===t})).map((function(e){return{bidder:e.bidder,connectType:e.source,mediaType:e.mediaType,size:e.size,timeToRespond:e.timeToRespond,cpm:e.cpm,currency:e.currency,dealId:e.dealId}})),bids:e.adUnits.filter((function(e){return e.code===t})).reduce((function(e,t){return e.concat(t.bids.map((function(e){return{mediaTypes:t.mediaTypes,bidder:e.bidder,params:e.params,bidSizes:e.bidSizes}})))}),[])}}))};return this.compressPayload(r,"prebid-auction-end").then((function(e){var t=e.compressedData,i=e.errMsg;n.sendTelemetryRequest("prebid-auction-end",Object.assign({pbAuctionGzipped:t,errMsg:i,srate:n.prebidTelemetrySampleRate},n.getComponentsStatePayload()))}))}},{key:"recordFuseLoad",value:function(e){this.sendTelemetryRequest("fuse-load",{sdi:e})}},{key:"recordPageTransition",value:function(e){this.sendTelemetryRequest("page-transition",Object.assign({sdi:e},this.getComponentsStatePayload()))}},{key:"recordCmpDetermined",value:function(e,t){var i=this;if(e.TCData){this.logger.log("[TELEMETRY]: TCData found, sending cmp-determined with compressed TCData");var n=e.TCData;n.vendor;var o=Be(n,["vendor"]);this.compressPayload(o,"cmp-determined",1e4).then((function(n){var o=n.compressedData,r=n.errMsg;i.sendTelemetryRequest("cmp-determined",Object.assign(Object.assign({},e),{TCData:o,errMsg:r,srate:t}),i.getCmpData())})).catch((function(e){i.logger.error("[TELEMETRY]: Error sending cmp-determined event telemetry with compressed TCData: ".concat(e))}))}else this.logger.log("[TELEMETRY]: TCData not found, sending cmp-determined without compression"),this.sendTelemetryRequest("cmp-determined",Object.assign(Object.assign({},e),{srate:t}))}},{key:"recordRogueBidderResponse",value:function(e,t,i){this.sendTelemetryRequest("rogue-bidder-response",{slotId:e,bidder:t.bidder,pbTrId:t.transactionId,pbReqId:t.requestId,pbAdId:t.adId,pbCrId:t.creativeId,pbSize:t.size,size:Y(i),wDiff:K(t.width,i[0]),hDiff:K(t.height,i[1])},this.getCmpData())}},{key:"recordRogueAdxResponse",value:function(e,t,i){var n,o,r=t.size;this.sendTelemetryRequest("rogue-bidder-response",{slotId:e,bidder:"adx",pbAdId:null===(n=t.sourceAgnosticLineItemId)||void 0===n?void 0:n.toString(),pbCrId:null===(o=t.sourceAgnosticCreativeId)||void 0===o?void 0:o.toString(),pbSize:Y(r),size:Y(i),wDiff:K(r[0],i[0]),hDiff:K(r[1],i[1])},this.getCmpData())}},{key:"prepareRecordingWebVitals",value:function(){var e=this;if(this.deviceInfo.getBrowser()===_.Chrome){var t=function(t){var i=function(e){return{name:e.name,value:"".concat(e.value),rating:e.rating,id:e.id,delta:"".concat(e.delta),element:Me(e)}}(t);e.logInfo("[WEB-VITALS]: ".concat(JSON.stringify(i))),e.queueBackgroundRequest("web-vitals",{cwvRep:[i]},e.getCmpData())};this.logInfo("[WEB-VITALS]: Set up web vitals callbacks"),function(e,t){t=t||{},ve(ae((function(){var i,n=ie("CLS",0),o=0,r=[],s=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=r[0],i=r[r.length-1];o&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,r.push(e)):(o=e.value,r=[e])}})),o>n.value&&(n.value=o,n.entries=r,i())},a=ne("layout-shift",s);a&&(i=oe(e,n,be,t.reportAllChanges),se((function(){s(a.takeRecords()),i(!0)})),$((function(){o=0,n=ie("CLS",0),i=oe(e,n,be,t.reportAllChanges),re((function(){return i()}))})),setTimeout(i,0))})))}(t,{reportAllChanges:!0}),ve(t),Pe(t),function(e,t){t=t||{},fe((function(){var i,n=he(),o=ie("LCP"),r=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<n.firstHiddenTime&&(o.value=Math.max(e.startTime-te(),0),o.entries=[e],i())}))},s=ne("largest-contentful-paint",r);if(s){i=oe(e,o,Oe,t.reportAllChanges);var a=ae((function(){De[o.id]||(r(s.takeRecords()),s.disconnect(),De[o.id]=!0,i(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return Ae(a)}),{once:!0,capture:!0})})),se(a),$((function(n){o=ie("LCP"),i=oe(e,o,Oe,t.reportAllChanges),re((function(){o.value=performance.now()-n.timeStamp,De[o.id]=!0,i(!0)}))}))}}))}(t,{reportAllChanges:!0}),Ne(t)}else this.logInfo("[WEB-VITALS]: Disabled web vitals recording for non-chrome browser")}},{key:"prepareBackgroundRequestProcessor",value:function(){var e=this;this.browserWindow.addEventListener("visibilitychange",(function(){"hidden"===e.browserWindow.document.visibilityState&&e.flushQueue()}))}},{key:"logInfo",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.logger.info("".concat(t.map((function(e){return JSON.stringify(e)}))))}},{key:"flushQueue",value:function(){var e;if(!(this.requestQueue.size<=0)){this.logInfo("Flushing request queue");var t,i,n=[],o=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=f(e))||t){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(this.requestQueue);try{for(o.s();!(i=o.n()).done;){var r=i.value;"web-vitals"===r.eventType&&(null===(e=r.record)||void 0===e?void 0:e.cwvRep)?(n.push.apply(n,d(r.record.cwvRep)),r.cmpData&&(t=r.cmpData)):this.sendTelemetryRequest(r.eventType,r.record,r.cmpData)}}catch(e){o.e(e)}finally{o.f()}for(;n.length>=1;)this.sendTelemetryRequest("web-vitals",{cwvRep:n.splice(0,10)},t);this.requestQueue.clear()}}},{key:"makeUrl",value:function(e,t,i){var n=this.buildQueryParameters(Object.assign(Object.assign(Object.assign({},t),{cmpj:null==i?void 0:i.jurisdiction,cmpdialog:null==i?void 0:i.dialogShown}),this.getCommonMetadata(e,null==t?void 0:t.srate))),o="https://".concat(this.baseUrl);return"https://".concat(this.getHostName(o),"/telemetry/noconsent").concat(n)}},{key:"sendTelemetryRequest",value:function(e,t,i){var n;100*Math.random()<=(null!==(n=null==t?void 0:t.srate)&&void 0!==n?n:100)&&this.requestMethod(this.makeUrl(e,t,i))}},{key:"queueBackgroundRequest",value:function(e,t,i){var n=this;this.requestQueue.add({eventType:e,record:t,cmpData:i}),clearTimeout(this.backgroundRequestTimeout),this.backgroundRequestTimeout=setTimeout((function(){n.flushQueue()}),5e3)}},{key:"logDetails",value:function(e,t){this.logger.debug("[STATS]: Record ".concat(t," event for fuse ").concat(this.fuseId,", ad ").concat(e," on device ").concat(this.deviceInfo.getDevice()," and browser ").concat(this.deviceInfo.getBrowser()))}},{key:"buildQueryParameters",value:function(e){return Object.entries(e).reduce((function(e,t){var i=c(t,2),n=i[0],o=i[1];return o?("object"===h(o)&&(o=JSON.stringify(o)),"".concat(e?e+"&":"?").concat(encodeURIComponent(n),"=").concat(encodeURIComponent(o))):e}),"")}},{key:"getCommonMetadata",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=[this.browserWindow.location.href,this.getReferrer()],n=i[0],o=i[1];return{v:"1",ttm:Date.now(),cookie:this.browserWindow.navigator.cookieEnabled,res:"".concat(screen.width,"x").concat(screen.height),device:this.deviceInfo.getDevice(),browser:this.deviceInfo.getBrowser(),fuuid:this.fuseUuid,fid:this.fuseId,pubid:this.publicationId,url:this.purify(n),refr:this.purify(o),sid:this.sessionId,srate:t,adserver:this.adServer,etm:this.reporter.getElapsedTime(),e:e,tenant:this.tenantId,sd:this.browserWindow.scrollY,fusecdn:this.fuseCDNPlatform,tlt:this.reporter.tagLoadedMs,account:this.accountCode,experiments:Object.keys(this.experiments).length?this.experiments:void 0,sf:this.settings.isForceSafeFrames(),cz:this.comboZoneState.comboZoneState}}},{key:"getCmpData",value:function(){var e=this.componentState.state.cmp;return{jurisdiction:H(e),personalisation:V(e),dialogShown:this.reporter.getIsCmpPromptShown()}}},{key:"getHostName",value:function(e){var t=/^(?:(?:https?|ftp):)\/*(?:[^@]+@)?([^:/#]+)/.exec(e);return t?t[1]:e}},{key:"fromQuerystring",value:function(e,t){var i=new RegExp("^[^#]*[?&]"+e+"=([^&#]*)").exec(t);return i?decodeURIComponent(i[1].replace(/\+/g," ")):null}},{key:"getReferrer",value:function(e){var t=this.fromQuerystring("referrer",this.browserWindow.location.href)||this.fromQuerystring("referer",this.browserWindow.location.href);if(t)return t;if(e)return e;try{if(this.browserWindow.top)return this.browserWindow.top.document.referrer;if(this.browserWindow.parent)return this.browserWindow.parent.document.referrer}catch(e){}return this.browserWindow.document.referrer}},{key:"purify",value:function(e){return e.replace(/#.*/,"").replace(/[{}]/g,"")}},{key:"compressPayload",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:11e3;return this.browserWindow.CompressionStream?this.objectToCompressedBase64(e).then((function(e){return e.length>n?(i.logger.warn("[AUCTION]: Compressed payload too long: ".concat(e.length," bytes. It will not be sent.")),{errMsg:"Compressed payload too long"}):{compressedData:e}})).catch((function(e){return i.logger.error("[AUCTION]: Error compressing event - ".concat(t," - telemetry: ").concat(e)),{errMsg:"Error compressing payload: ".concat(e.message)}})):Promise.resolve({errMsg:"CompressionStream API unavailable"})}},{key:"getComponentsStatePayload",value:function(){var e=this.componentState.state;return{prebid_ready_ms:Z(e.prebid),uam_ready_ms:Z(e.uam),gpt_ready_ms:Z(e.gpt),cmp_load_finish_ms:this.reporter.cmpLoadFinishMs,cmp_determined_ms:Z(e.cmp),cmp_gdpr_cached:this.reporter.cmpGdprCached}}}])}(),je=function(){return o((function e(t){i(this,e),this.initialiser=t,this._field=null}),[{key:"field",get:function(){var e;return null!==(e=this._field)&&void 0!==e?e:this._field=this.initialiser()}}])}();function Ue(e){return function(){return new je(e).field}}var Ge=function(){return o((function e(t,n){i(this,e),this.logger=t,this.eventName=n,this.subscribers=[],this.lastEmitted=null,this.wrapped=[]}),[{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"_unsubscribe",value:function(e){var t=this.subscribers.indexOf(e);return t>=0&&(this.subscribers.splice(t,1),!0)}},{key:"unsubscribe",value:function(e){var t=this.findWrapper(e);return t?this._unsubscribe(t):this._unsubscribe(e)}},{key:"findWrapper",value:function(e){var t;return null===(t=this.wrapped.filter((function(t){return t.subscriber===e})).shift())||void 0===t?void 0:t.wrapper}},{key:"once",value:function(e){var t=this,i=function(n){e(n),t.unsubscribe(i)};this.subscribe(i),this.wrapped.push({wrapper:i,subscriber:e})}},{key:"immediateOrOnce",value:function(e){return y(this.lastEmitted)?(this.logger.debug("[EVENT][".concat(this.eventName,"]: Already triggered, invoking callback synchronously")),e(this.lastEmitted),!0):(this.once(e),!1)}},{key:"emit",value:function(e){var t=this,i=this.subscribers.length;i>0?this.logger.debug("[EVENT][".concat(this.eventName,"]: Fired, start processing ").concat(i," callbacks")):this.logger.debug("[EVENT][".concat(this.eventName,"]: Fired, no pending callbacks")),this.lastEmitted=e,this.subscribers.map((function(e){return e})).forEach((function(i){try{i(e)}catch(i){i instanceof Error?t.logger.error("[EVENT][".concat(t.eventName,"]: Caught exception in callback with item ").concat(e),i.message,i.stack):t.logger.error("[EVENT][".concat(t.eventName,"]: Caught exception of invalid type in callback with item ").concat(e))}}))}},{key:"getSubscriberCount",value:function(){return this.subscribers.length}}])}(),We=function(){return o((function e(t,n,o,r){var s=this;i(this,e),this.logger=t,this.eventName=n,this.source=o,this.filter=r,this.delegate=new Ge(t,n),o.subscribe((function(e){var t=s.filter(e);y(t)&&s.delegate.emit(t)}))}),[{key:"subscribe",value:function(e){this.delegate.subscribe(e)}},{key:"unsubscribe",value:function(e){this.delegate.unsubscribe(e)}},{key:"once",value:function(e){this.delegate.once(e)}},{key:"immediateOrOnce",value:function(e){return this.delegate.immediateOrOnce(e)}}])}(),Ve=function(){return o((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};i(this,e),this.logger=t,this.addDebugProxy=n,this.emitters={},this.observables={}}),[{key:"onTagInitComplete",get:function(){return this.getEmitter("onTagInitComplete")}},{key:"pageInitObservable",get:function(){return this.onPageInit}},{key:"onPageInit",get:function(){return this.getEmitter("onPageInit")}},{key:"onPageReset",get:function(){return this.getEmitter("onPageReset")}},{key:"onZoneEvent",get:function(){return this.getEmitter("onZoneEvent")}},{key:"onAuctionEvent",get:function(){return this.getEmitter("onAuctionEvent")}},{key:"onZoneRegistered",get:function(){return this.getFiltered("register_zone",this.onZoneEvent,(function(e){return"registered"==e.zoneEventType?e:null}))}},{key:"onZoneDeleted",get:function(){return this.getFiltered("delete_zone",this.onZoneEvent,(function(e){return"deleted"==e.zoneEventType?e:null}))}},{key:"onZoneActivateApi",get:function(){return this.getFiltered("activate_zone_api",this.onZoneEvent,(function(e){return"activate_zone_api"==e.zoneEventType?e:null}))}},{key:"activateZoneCalledObservable",get:function(){return this.onZoneActivateApi}},{key:"onComponentInitEvent",get:function(){return this.getEmitter("onComponentInitEvent")}},{key:"onInitManagerReady",get:function(){return this.getEmitter("onInitManagerReady")}},{key:"onWindowResized",get:function(){return this.getEmitter("onWindowResized")}},{key:"onSlotLoaded",get:function(){return this.getEmitter("onSlotLoaded")}},{key:"onSlotRender",get:function(){return this.getEmitter("onSlotRender")}},{key:"onSlotResponse",get:function(){return this.getEmitter("onSlotResponse")}},{key:"onSlotRequested",get:function(){return this.getEmitter("onSlotRequested")}},{key:"onImpressionViewable",get:function(){return this.getEmitter("onImpressionViewable")}},{key:"onPrebidAuctionEnd",get:function(){return this.getEmitter("onPrebidAuctionEnd")}},{key:"onPrebidAdRenderFailed",get:function(){return this.getEmitter("onPrebidAdRenderFailed")}},{key:"onPrebidAdRenderSucceeded",get:function(){return this.getEmitter("onPrebidAdRenderSucceeded")}},{key:"onBreakpointChanged",get:function(){return this.getFiltered("onBreakpointChanged",this.onWindowResized,(function(e){return e.crossedBp?e:null}))}},{key:"getEmitter",value:function(e){var t,i,n=new Ge(this.logger(),e),o=this.addDebugProxy(),r=o?o(n):n;return null!==(t=(i=this.emitters)[e])&&void 0!==t?t:i[e]=r}},{key:"getFiltered",value:function(e,t,i){var n,o;return null!==(n=(o=this.observables)[e])&&void 0!==n?n:o[e]=new We(this.logger(),e,t,i)}}])}(),He=new Ve(Ue((function(){return E.getLogger()})),Ue((function(){var e;return null===(e=E.getFuseDebugger())||void 0===e?void 0:e.fuseEventEmitterWrapper()}))),Ze=function(){return o((function e(t){i(this,e),this.options={capture:!0,passive:!0},this.window=t.api.viewportInfo.browserWindow,this.triggeredCB=t.onTriggeredCB,this.window.addEventListener("scroll",this.triggeredCB,this.options)}),[{key:"destroy",value:function(){this.window.removeEventListener("scroll",this.triggeredCB,this.options)}}])}(),qe="InView",Ye=function(){return o((function e(t){i(this,e),this.params=t,this.name=qe}),[{key:"buildTriggers",value:function(e){return[new Ze(e)]}},{key:"check",value:function(e,t){var i=t.slotRegistry.getSlot(e);if(i){var n=t.viewportInfo.getCurrentBreakpoint().name,o=this.params[n];return!(!m(o)&&!1!==o)||i.isInView(o)}return!1}}])}(),Je=function(){return o((function e(t,n,o){i(this,e);var r=function(e){o(e)&&t.onTriggeredCB()};this.unsubscribe=function(){return n.unsubscribe(r)},n.subscribe(r)}),[{key:"destroy",value:function(){this.unsubscribe()}}])}(),Qe=function(e){function n(e){i(this,n);var o=e.api.slotRegistry.getSlot(e.id).zoneInstanceId;return t(this,n,[e,e.api.events.onZoneActivateApi,function(e){return e.instanceId===o}])}return a(n,e),o(n)}(Je),Ke="ManualActivate",Xe=function(){return o((function e(){i(this,e),this.name=Ke}),[{key:"buildTriggers",value:function(e){return[new Qe(e)]}},{key:"check",value:function(e,t){var i,n=null===(i=t.slotRegistry.getSlot(e))||void 0===i?void 0:i.zoneInstanceId;return y(n)&&t.zoneRegistry.isManuallyActivated(n)}}])}(),$e=E.getLogger(),et=function(e){var t=E.getQueryParam(e)[1];if(t){var i=parseInt(t);if(Number.isInteger(i))return i;$e.info("[SETTINGS]: Could not parse ".concat(e," with value ").concat(t," as a number"))}return null},tt=function(e){var t=E.getQueryParam(e)[1];if(m(t))return null;var i=/^(false|true|1|0)$/i.test(t)?Boolean(/^(true|1)$/i.test(t)):null;return m(i)&&$e.info("[SETTINGS] Could not parse ".concat(e," with value: ").concat(t," as a boolean")),i},it=function(e){return E.getQueryParam(e)[1]||""},nt=function(e){var t=it(e);if(!m(t)&&""!==t){if("true"===t||"false"===t)return"true"===t;var i=parseInt(t,10);if(Number.isInteger(i))return i;$e.info("[SETTINGS] Could not parse ".concat(e," with value: ").concat(t," as a number"))}};function ot(e,t){var i=new RegExp("^fuse_(\\d+)_".concat(e,"(\\.\\w+|)$"),"i"),n=t.search.split(/[?&]/).filter((function(e){return""!==e})).map((function(e){return e.split("=")})).filter((function(e){return i.test(e[0])})),o={};return n.forEach((function(e){var t=i.exec(e[0]);if(null==t?void 0:t[1]){var n=decodeURIComponent(e[1]);"true"===e[1]?n=!0:"false"===e[1]&&(n=!1);var r=t[1];if(void 0===o[r]&&(o[r]={}),t[2]){var s=t[2].substring(1);o[r][s]=n}}})),o}var rt={account_code:"icons8",account_domain_map:{},fuse_blocked_url:[],fuse_breakpoints:{l:1295,m:750,s:510,xs:0},fuse_cdn:"cdn.fuseplatform.net",fuse_cdn_platform:"cloudflare",fuse_id:3743,fuse_industry:["IAB19"],fuse_settings:{adblock:!1,afs:{enabled:!1},amazonUam:{enabled:!0,pubID:"8b48e249-e9e6-4a52-8b48-396ea93403e8"},blockthrough:!0,cmp:"script",cmpProvider:{partner:"none"},confiant:!1,disableAutoLoadSlots:!1,disableGdprPersonalisation:!1,enableAutoRegistration:!1,enableMiniScrollers:!1,forceSafeFrame:!1,fullScreenAdExpansion:5,fuse_test_urls:[],headerbidding:1e3,id5:{enabled:!1},identity:{enabled:!1},in2wInjection:5,inskinWidth:1200,networkCode:"71161633",onLoadCallback:"",prebid:{analytics:[],breakpoint_options:{l:{enabled:!0,timeout:1e3},m:{enabled:!0,timeout:1e3},s:{enabled:!0,timeout:1e3},xs:{enabled:!0,timeout:1e3}},defaultTimeout:1e3,enabled:!0,sendAllBids:!1},quickstart:!1,responsive:!0,strict_cmp:!1,tagCategories:{},telemetry:"default",topStickyHeaderSelector:"",useAuctionSlotLimit:5,useBidCache:95,useComboZones:5,useCriteoId:95,useDomObserver:!1,useGptPreAuctionModule:95,useId5:95,useIncreaseInitialTimeout:95,useIndustry:95,useMaxViewports:5,usePrebidContextualSignals:5,useRandomBidderElimination:5,useRefreshPrebidTimeoutBuffering:95,useSharedId:95,useViewportRefresh:95,videoSettings:{enabled:!1},yandex:!1,yandexBlockId:""},fuse_slots:[{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"adagio",params:{adUnitElementId:"01J527VSWSEY5XB69GJD761Y7C",organizationId:"1140",placement:"icons_header",site:"icons8-com"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892343"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWSEY5XB69GJD761Y7C_1486317_300x50",zoneId:1486317}},{bidSizes:["320x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWSEY5XB69GJD761Y7C_1486319_320x50",zoneId:1486319}},{bidSizes:["728x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWSEY5XB69GJD761Y7C_1486324_728x90",zoneId:1486324}},{bidSizes:["970x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWSEY5XB69GJD761Y7C_1486325_970x90",zoneId:1486325}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_header",publisherId:"156762"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["320x50"],bidder:"sovrn",params:{tagid:"1246997"}},{bidSizes:["468x60"],bidder:"sovrn",params:{tagid:"1246998"}},{bidSizes:["728x90"],bidder:"sovrn",params:{tagid:"1246999"}},{bidSizes:["970x90"],bidder:"sovrn",params:{tagid:"1247000"}},{bidSizes:["1200x90","300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23199483872",id:"23199483872",sizeMapping:{l:[[728,90],[970,90],[1200,90]],m:[[468,60],[468,90],[728,90],[970,90],[1200,90]],s:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90]],xl:[[728,90],[970,90],[1200,90]],xs:[[300,50],[300,90],[320,50],[320,90]]},sizes:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90],[728,90],[970,90],[1200,90]],slot:"/71161633,23155897692/ICNS8_icons8/icons_header",zoneCategories:[]},{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x250"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x250"],bidder:"adagio",params:{adUnitElementId:"01J527VSWV4DN6T3A5E194C1GB",organizationId:"1140",placement:"icons_mrec_2",site:"icons8-com"}},{bidSizes:["300x250"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892348"}},{bidSizes:["300x250"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x250"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x250"],bidder:"criteo",params:{publisherSubId:"01J527VSWV4DN6T3A5E194C1GB_1486321_300x250",zoneId:1486321}},{bidSizes:["300x250"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x250"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x250"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x250"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_mrec_2",publisherId:"156762"}},{bidSizes:["300x250"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x250"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x250"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["300x250"],bidder:"sovrn",params:{tagid:"1246996"}},{bidSizes:["300x250"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23199483875",id:"23199483875",sizeMapping:{l:[[300,250]],m:[[300,250]],s:[[300,250]],xl:[[300,250]],xs:[[300,250]]},sizes:[[300,250]],slot:"/71161633,23155897692/ICNS8_icons8/icons_mrec_2",zoneCategories:[]},{activateConditionConfig:{type:"none"},afsAttributes:{maxTop:"4",width:"auto"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"adagio",params:{adUnitElementId:"01J527VSWTBVBQVCYNKT3D5A8P",organizationId:"1140",placement:"icons_incontent_1",site:"icons8-com"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892345"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTBVBQVCYNKT3D5A8P_1486317_300x50",zoneId:1486317}},{bidSizes:["320x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTBVBQVCYNKT3D5A8P_1486319_320x50",zoneId:1486319}},{bidSizes:["728x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTBVBQVCYNKT3D5A8P_1486324_728x90",zoneId:1486324}},{bidSizes:["970x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTBVBQVCYNKT3D5A8P_1486325_970x90",zoneId:1486325}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_incontent_1",publisherId:"156762"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["320x50"],bidder:"sovrn",params:{tagid:"1246997"}},{bidSizes:["468x60"],bidder:"sovrn",params:{tagid:"1246998"}},{bidSizes:["728x90"],bidder:"sovrn",params:{tagid:"1246999"}},{bidSizes:["970x90"],bidder:"sovrn",params:{tagid:"1247000"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],dynamicAttributes:{each:0,incrementEach:0,position:"in",repeatHeight:1e3,skip:0},gamAdUnitId:"23199484901",id:"23199484901",interscrollerAttributes:{showBanner:!1,zIndex:0},mediaTypes:[],sizeMapping:{l:[[728,90],[970,90]],m:[[468,60],[468,90],[728,90]],s:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90]],xl:[],xs:[[300,50],[300,90],[320,50],[320,90]]},sizes:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90],[728,90],[970,90]],slot:"/71161633,23155897692/ICNS8_icons8/icons_incontent_1",stickyAttributes:{allowClose:!1,allowReopen:!1,bgOpacity:0,compact:!1,isButtonOutside:!1,isHideForever:!1,isTop:!1,scrollCreative:!1},zoneCategories:[]},{activateConditionConfig:{type:"none"},afsAttributes:{maxTop:"4",width:"auto"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"adagio",params:{adUnitElementId:"01J527VSWTQJ4F4XYRSSQTQZS8",organizationId:"1140",placement:"icons_incontent_2",site:"icons8-com"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892346"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTQJ4F4XYRSSQTQZS8_1486317_300x50",zoneId:1486317}},{bidSizes:["320x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTQJ4F4XYRSSQTQZS8_1486319_320x50",zoneId:1486319}},{bidSizes:["728x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTQJ4F4XYRSSQTQZS8_1486324_728x90",zoneId:1486324}},{bidSizes:["970x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTQJ4F4XYRSSQTQZS8_1486325_970x90",zoneId:1486325}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_incontent_2",publisherId:"156762"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["320x50"],bidder:"sovrn",params:{tagid:"1246997"}},{bidSizes:["468x60"],bidder:"sovrn",params:{tagid:"1246998"}},{bidSizes:["728x90"],bidder:"sovrn",params:{tagid:"1246999"}},{bidSizes:["970x90"],bidder:"sovrn",params:{tagid:"1247000"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],dynamicAttributes:{each:0,incrementEach:0,position:"in",repeatHeight:1e3,skip:0},gamAdUnitId:"23199484904",id:"23199484904",interscrollerAttributes:{showBanner:!1,zIndex:0},mediaTypes:[],sizeMapping:{l:[[728,90],[970,90]],m:[[468,60],[468,90],[728,90]],s:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90]],xl:[],xs:[[300,50],[300,90],[320,50],[320,90]]},sizes:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90],[728,90],[970,90]],slot:"/71161633,23155897692/ICNS8_icons8/icons_incontent_2",stickyAttributes:{allowClose:!1,allowReopen:!1,bgOpacity:0,compact:!1,isButtonOutside:!1,isHideForever:!1,isTop:!1,scrollCreative:!1},zoneCategories:[]},{activateConditionConfig:{type:"none"},afsAttributes:{maxTop:"4",width:"auto"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"adagio",params:{adUnitElementId:"01J527VSWTRFH3YYAJPCXN51J5",organizationId:"1140",placement:"icons_incontent_3",site:"icons8-com"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892347"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTRFH3YYAJPCXN51J5_1486317_300x50",zoneId:1486317}},{bidSizes:["320x50"],bidder:"criteo",params:{publisherSubId:"01J527VSWTRFH3YYAJPCXN51J5_1486319_320x50",zoneId:1486319}},{bidSizes:["728x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTRFH3YYAJPCXN51J5_1486324_728x90",zoneId:1486324}},{bidSizes:["970x90"],bidder:"criteo",params:{publisherSubId:"01J527VSWTRFH3YYAJPCXN51J5_1486325_970x90",zoneId:1486325}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_incontent_3",publisherId:"156762"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["320x50"],bidder:"sovrn",params:{tagid:"1246997"}},{bidSizes:["468x60"],bidder:"sovrn",params:{tagid:"1246998"}},{bidSizes:["728x90"],bidder:"sovrn",params:{tagid:"1246999"}},{bidSizes:["970x90"],bidder:"sovrn",params:{tagid:"1247000"}},{bidSizes:["300x50","300x90","320x50","320x90","468x60","468x90","728x90","970x90"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],dynamicAttributes:{each:0,incrementEach:0,position:"in",repeatHeight:1e3,skip:0},gamAdUnitId:"23199484907",id:"23199484907",interscrollerAttributes:{showBanner:!1,zIndex:0},mediaTypes:[],sizeMapping:{l:[[728,90],[970,90]],m:[[468,60],[468,90],[728,90]],s:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90]],xl:[],xs:[[300,50],[300,90],[320,50],[320,90]]},sizes:[[300,50],[300,90],[320,50],[320,90],[468,60],[468,90],[728,90],[970,90]],slot:"/71161633,23155897692/ICNS8_icons8/icons_incontent_3",stickyAttributes:{allowClose:!1,allowReopen:!1,bgOpacity:0,compact:!1,isButtonOutside:!1,isHideForever:!1,isTop:!1,scrollCreative:!1},zoneCategories:[]},{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x250"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x250"],bidder:"adagio",params:{adUnitElementId:"01J527VSWTA39JR9NK19QK43YE",organizationId:"1140",placement:"icons_mrec_1",site:"icons8-com"}},{bidSizes:["300x250"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892344"}},{bidSizes:["300x250"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x250"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x250"],bidder:"criteo",params:{publisherSubId:"01J527VSWTA39JR9NK19QK43YE_1486321_300x250",zoneId:1486321}},{bidSizes:["300x250"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x250"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x250"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x250"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_mrec_1",publisherId:"156762"}},{bidSizes:["300x250"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x250"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x250"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["300x250"],bidder:"sovrn",params:{tagid:"1246996"}},{bidSizes:["300x250"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23199484910",id:"23199484910",sizeMapping:{l:[[300,250]],m:[[300,250]],s:[[300,250]],xl:[[300,250]],xs:[[300,250]]},sizes:[[300,250]],slot:"/71161633,23155897692/ICNS8_icons8/icons_mrec_1",zoneCategories:[]},{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:["300x250"],bidder:"33across",params:{productId:"siab",siteId:"d71uGOgrmr74kxrkHcnnVW"}},{bidSizes:["300x250"],bidder:"adagio",params:{adUnitElementId:"01J527VSWVF8Y4ZZP3FAC6CJ5X",organizationId:"1140",placement:"icons_mrec_3",site:"icons8-com"}},{bidSizes:["300x250"],bidder:"amx",params:{tagId:"cHVibGlmdC5jb20"}},{bidSizes:[],bidder:"appnexus",params:{placementId:"33892349"}},{bidSizes:["300x250"],bidder:"brightcom",params:{publisherId:20605}},{bidSizes:["300x250"],bidder:"connectad",params:{networkId:152,siteId:1113786}},{bidSizes:["300x250"],bidder:"criteo",params:{publisherSubId:"01J527VSWVF8Y4ZZP3FAC6CJ5X_1486321_300x250",zoneId:1486321}},{bidSizes:["300x250"],bidder:"nobid",params:{siteId:67636}},{bidSizes:["300x250"],bidder:"onetag",params:{pubId:"77253abd802c05e"}},{bidSizes:["300x250"],bidder:"openx",params:{delDomain:"publift-d.openx.net",unit:"560861665"}},{bidSizes:["300x250"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_mrec_3",publisherId:"156762"}},{bidSizes:["300x250"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x250"],bidder:"smartadserver",params:{domain:"https://prg-apac.smartadserver.com",formatId:116284,pageId:1720333,siteId:566977}},{bidSizes:["300x250"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["300x250"],bidder:"sovrn",params:{tagid:"1246996"}},{bidSizes:["300x250"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23199484913",id:"23199484913",sizeMapping:{l:[[300,250]],m:[[300,250]],s:[[300,250]],xl:[[300,250]],xs:[[300,250]]},sizes:[[300,250]],slot:"/71161633,23155897692/ICNS8_icons8/icons_mrec_3",zoneCategories:[]},{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:[],bidder:"appnexus",params:{placementId:"33900694"}},{bidSizes:["300x168"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/rewarded_ad",publisherId:"156762"}},{bidSizes:["300x168"],bidder:"sonobi",params:{placement_id:"4def6fa8fe3eeddda18a"}},{bidSizes:["300x168"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23199609554",id:"23199609554",sizeMapping:{l:[],m:[[300,168]],s:[[300,168]],xl:[],xs:[[300,168]]},sizes:[[300,168]],slot:"/71161633,23155897692/ICNS8_icons8/rewarded_ad",zoneCategories:[]},{activateConditionConfig:{type:"none"},attributes:{adblock:!1,afs:!1,comboZoneEnabled:!0,dynamic:!1,headerbidding:!0,interscroller:!1,interstitial:!1,miniscroller:!1,refresh:30,scrollToStick:!1,sticky:!1},bids:[{bidSizes:[],bidder:"appnexus",params:{placementId:"34159532"}},{bidSizes:["300x250"],bidder:"pubmatic",params:{adSlot:"/71161633/ICNS8_icons8/icons_mrec_4",publisherId:"156762"}},{bidSizes:["300x250"],bidder:"rubicon",params:{accountId:"11504",siteId:"558854",zoneId:"3510822"}},{bidSizes:["300x250"],bidder:"triplelift",params:{inventoryCode:"Icons8_StandardDisplay"}}],gamAdUnitId:"23205417086",id:"23205417086",sizeMapping:{l:[[300,250]],m:[[300,250]],s:[[300,250]],xl:[[300,250]],xs:[[300,250]]},sizes:[[300,250]],slot:"/71161633,23155897692/ICNS8_icons8/icons_mrec_4",zoneCategories:[]}],fuse_tenant:"publift",fuse_uuid:"a0f67d43-27b0-5b2c-9591-7c327f7c0a34",sco:{asi:"publift.com",sellerId:"01HYHQ370K9NCQE8VJF9CSDK84"},supported_sizes:{l:[[300,250],[728,90],[970,90],[1200,90]],m:[[300,168],[300,250],[468,60],[468,90],[728,90],[970,90],[1200,90]],s:[[300,50],[300,90],[300,168],[300,250],[320,50],[320,90],[468,60],[468,90]],xl:[[300,250],[728,90],[970,90],[1200,90]],xs:[[300,50],[300,90],[300,168],[300,250],[320,50],[320,90]]},tenantId:"DGKSPXNV53",fuse_flavour:"cf-default",publication_metadata:{publication_id:9,generation_version:"4.304180.0",generation_time:"2024-11-27T14:35:56.751Z",revision:"v5"},fuse_prebid_hash:"0b9b9682613ef1e8bcb712b46b68bf97"},st=function(){return o((function e(t){i(this,e),this.myWindow=t}),[{key:"isDevelopmentMode",value:function(){return 0==rt.publication_metadata.publication_id}},{key:"getAccountSettings",value:function(){var e=this.myWindow.field;return this.isDevelopmentMode()&&e.fuseConfig?e.fuseConfig:rt}},{key:"getBreakpoints",value:function(){var e={},t=this.getAccountSettings();return t.fuse_breakpoints.xl&&(e.xl=t.fuse_breakpoints.xl),t.fuse_breakpoints.l&&(e.l=t.fuse_breakpoints.l),e.m=t.fuse_breakpoints.m,e.s=t.fuse_breakpoints.s,e.xs=t.fuse_breakpoints.xs,e}},{key:"isUseBrowserOuterwidth",value:function(){var e,t;return null!==(t=null!==(e=tt("fuseUseBrowserOuterwidth"))&&void 0!==e?e:this.getAccountSettings().fuse_settings.isUseBrowserOuterwidth)&&void 0!==t&&t}}])}(),at=new st(new je((function(){return E.getBrowserWindowObject()}))),ut=function(){return o((function e(t,n){var o=this;if(i(this,e),this.layer=t,this.logger=n,this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.lastClickTime=0,this.cancelNextClick=!1,this.touchBoundary=10,this.tapDelay=200,this.tapTimeout=700,t.addEventListener("click",(function(e){return o.onClick(e)}),!0),t.addEventListener("touchstart",(function(e){return o.onTouchStart(e)}),!1),t.addEventListener("touchmove",(function(e){return o.onTouchMove(e)}),!1),t.addEventListener("touchend",(function(e){return o.onTouchEnd(e)}),!1),t.addEventListener("touchcancel",(function(){return o.onTouchCancel()}),!1),"function"==typeof t.onclick){this.logger.debug("[FASTCLICK] re-using existing onclick");var r=t.onclick;t.addEventListener("click",(function(e){r.call(o,e)}),!1),t.onclick=null}this.logger.debug("[FASTCLICK] FastClick enabled")}),[{key:"needsClick",value:function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if("file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)}},{key:"needsFocus",value:function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}}},{key:"sendClick",value:function(e,t){document.activeElement&&document.activeElement!==e&&document.activeElement.blur();var i=t.changedTouches[0],n=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,button:0,relatedTarget:null});n.forwardedTouchEvent=!0,e.dispatchEvent(n),this.logger.debug("[FASTCLICK] Sent click event to element ".concat(e.tagName))}},{key:"focus",value:function(e){if(e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type&&"email"!==e.type){var t=e.value.length;e.setSelectionRange(t,t)}else e.focus()}},{key:"updateScrollParent",value:function(e){var t=e.fastClickScrollParent;if(!t||!t.contains(e)){var i=e;do{if(i.scrollHeight>i.offsetHeight){t=i,e.fastClickScrollParent=i;break}i=i.parentElement}while(i)}t&&(t.fastClickLastScrollTop=t.scrollTop)}},{key:"getTargetElementFromEventTarget",value:function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e}},{key:"onTouchStart",value:function(e){if(e.targetTouches.length>1)return!0;var t=this.getTargetElementFromEventTarget(e.target),i=e.targetTouches[0],n=window.getSelection();return!(!n.rangeCount||n.isCollapsed)||(i.identifier&&i.identifier===this.lastTouchIdentifier?(e.preventDefault(),!1):(this.lastTouchIdentifier=i.identifier,this.updateScrollParent(t),this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=i.pageX,this.touchStartY=i.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0))}},{key:"touchHasMoved",value:function(e){var t=e.changedTouches[0],i=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>i||Math.abs(t.pageY-this.touchStartY)>i}},{key:"onTouchMove",value:function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)}},{key:"findControl",value:function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")}},{key:"onTouchEnd",value:function(e){var t=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp;var i=this.trackingClickStart;this.trackingClick=!1,this.trackingClickStart=0;var n=t.tagName.toLowerCase();if("label"===n){var o=this.findControl(t);o&&(this.focus(t),t=o)}else if(this.needsFocus(t))return e.timeStamp-i>100||window.top!==window&&"input"===n?(this.targetElement=null,!1):(this.focus(t),this.sendClick(t,e),"select"!==n&&(this.targetElement=null,e.preventDefault()),!1);var r=t.fastClickScrollParent;return!(!r||r.fastClickLastScrollTop===r.scrollTop)||(this.needsClick(t)||(e.preventDefault(),this.sendClick(t,e)),!1)}},{key:"onTouchCancel",value:function(){this.trackingClick=!1,this.targetElement=null}},{key:"onMouse",value:function(e){return!this.targetElement||(!!e.forwardedTouchEvent||(!e.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))))}},{key:"onClick",value:function(e){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===e.target.type&&0===e.detail)return!0;var t=this.onMouse(e);return t||(this.targetElement=null),t}},{key:"destroy",value:function(){this.layer.removeEventListener("click",this.onClick,!0),this.layer.removeEventListener("touchstart",this.onTouchStart,!1),this.layer.removeEventListener("touchmove",this.onTouchMove,!1),this.layer.removeEventListener("touchend",this.onTouchEnd,!1),this.layer.removeEventListener("touchcancel",this.onTouchCancel,!1)}}])}(),lt=function(){return o((function e(t,n){i(this,e),this.browserWindow=t,this.logger=n,this.isTouching=!1,this.isMonitoring=!1,this.monitorTouchDetect()}),[{key:"monitorTouchDetect",value:function(){var e=this;this.isMonitoring||(this.browserWindow.addEventListener("touchstart",(function(){e.isTouching=!0})),this.browserWindow.addEventListener("touchend",(function(){e.isTouching=!1})),this.browserWindow.addEventListener("touchcancel",(function(){e.isTouching=!1})),this.isMonitoring=!0,this.logger.debug("[TOUCH]: Monitoring touch events"))}},{key:"getIsTouching",value:function(){return this.isTouching}},{key:"waitForTouchEnd",value:function(e){var t=this;if(!this.isTouching)return e();var i=setInterval((function(){if(t.logger.debug("[TOUCH]: Checking if user is touching"),!t.isTouching)return clearInterval(i),e()}),100)}}])}();var ct=function(){return o((function e(t,n,o,r,s){i(this,e),this.logger=t,this.browserWindow=n,this.breakpoints=o,this.onWindowResized=r,this.options=s,this.initBpWatch(),this.logger.debug("[VIEWPORT]: Initialised at breakpoint ".concat(this.getCurrentBreakpoint().name))}),[{key:"getCurrentBreakpoint",value:function(){return e=this.breakpoints,t=this.getViewportStatus().width,i=null,Object.entries(e).forEach((function(e){var n=c(e,2),o=n[0],r=n[1];t>=r&&(!i||r>i.size)&&(i={size:r,name:o})})),i;var e,t,i}},{key:"breakpointSupplier",value:function(){return this.getCurrentBreakpoint.bind(this)}},{key:"isNotXsBreakpoint",value:function(){return"xs"!==this.getCurrentBreakpoint().name}},{key:"getViewportStatus",value:function(){var e=this.browserWindow;return{width:this.options.isUseOuterwidth.field?e.outerWidth:e.innerWidth,innerHeight:e.innerHeight,outerHeight:e.outerHeight,hidden:e.document.hidden,offset:{x:e.scrollX,y:e.scrollY}}}},{key:"initBpWatch",value:function(){var e,t,i,n,o,r,s,a,u=this,l=this.getCurrentBreakpoint().size;this.browserWindow.addEventListener("resize",(e=500,t=function(){var e=u.getCurrentBreakpoint(),t=e.size,i=e.name,n=l!==t;return n?u.logger.debug("[VIEWPORT]: Window was resized, new dimensions: ".concat(JSON.stringify(u.getViewportStatus()),". The breakpoint was changed to ").concat(i)):u.logger.debug("[VIEWPORT]: Window was resized to ".concat(JSON.stringify(u.getViewportStatus()),". The breakpoint was unchanged at ").concat(i)),l=t,u.onWindowResized.emit({crossedBp:n,name:i,currentFrom:t})},a=function(){var u=Date.now()-r;u<e&&u>=0?i=setTimeout(a,e-u):(i=null,s=t.apply(o,n),i||(o=n=null))},function(){return o=this,n=arguments,r=Date.now(),i||(i=setTimeout(a,e)),s}))}}])}();var dt=function(){return o((function e(t){i(this,e),this.browserWindow=t,this.incrementalCounter={}}),[{key:"createDivElement",value:function(e,t){return this.toHTML('<div id="'.concat(this.getZoneDivId(e),'" data-fuse="').concat(e,'" data-fuse-injected-at="').concat((new Date).getTime(),'" class="').concat(t,'"></div>'))}},{key:"toHTML",value:function(e){var t=this.browserWindow.document.createElement("div");return t.innerHTML=e,t.firstElementChild}},{key:"getZoneDivId",value:function(e){return this.incrementalCounter[e]||(this.incrementalCounter[e]=0),"fuse-injected-".concat(e,"-").concat(++this.incrementalCounter[e])}},{key:"insertStyles",value:function(e,t){var i=this.browserWindow.document.createElement("div");i.innerHTML='<style id="'.concat(e,'">').concat(t,"</style>"),this.browserWindow.document.querySelector("body").insertAdjacentElement("beforeend",i.firstElementChild)}}])}(),gt=new(function(){return o((function e(){i(this,e)}),[{key:"getCreateFuseDivElement",value:function(){return this.createFuseDivElement||(this.createFuseDivElement=new dt(E.getBrowserWindowObject())),this.createFuseDivElement}},{key:"getTouchObserver",value:function(){return this.touchObserver||(this.touchObserver=new lt(E.getBrowserWindowObject(),E.getLogger())),this.touchObserver}},{key:"enableFastClick",value:function(){this.fastClick||(this.fastClick=new ut(E.getBrowserWindowObject().document.body,E.getLogger()))}},{key:"getViewportInfo",value:function(){return this.viewportInfo||(this.viewportInfo=new ct(E.getLogger(),E.getBrowserWindowObject(),at.getBreakpoints(),He.onWindowResized,{isUseOuterwidth:new je((function(){return at.isUseBrowserOuterwidth()}))})),this.viewportInfo}}])}());var ht=function(e){return Array.isArray(e)?"fluid"!==e[0]:"fluid"!==e};function ft(e){var t=function(e){return e.filter(ht)}(e);return t.length>0?t:void 0}var pt=function(e,t){var i=function(e){if(e.includes("px")){var t=Number(e.split("px")[0]);return Number.isNaN(t)?void 0:t}};return{maxWidth:i(t.getComputedStyle(e).maxWidth),maxHeight:i(t.getComputedStyle(e).maxHeight)}};var vt=[{name:"H2@300x250",parentSize:[970,250],comboZoneSize:[300,250],computedSize:[620,250]},{name:"H3@300x250",parentSize:[970,250],comboZoneSize:[300,250],computedSize:[920,250]},{name:"V2@300x250",parentSize:[300,600],comboZoneSize:[300,250],computedSize:[300,510]},{name:"V2@728x90",parentSize:[970,250],comboZoneSize:[728,90],computedSize:[728,190]}];function bt(e){var t=c(e.split("@"),2),i=t[0],n=t[1];if(n)return{name:e,layout:"v"===i[0].toLowerCase()?"vertical":"horizontal",numZones:parseInt(i[1]),sizes:[J(n)]}}function mt(e,t){var i=Object.assign({},e);for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==t[n]&&(i[n]=t[n]);return i}var St=function(){return o((function e(t,n,o,s,a,u){var l=this;i(this,e),this.logger=t,this.accountSettings=n,this.breakpoints=o,this.viewportInfo=s,this.hostname=a,this.overrideParams=u,this.forceDisablePrebid=!1,this.v2Compatibility={disableWidgetsRenderer:!1},this.isUamEnabled=function(){var e;return!l.isYandexEnabled()&&(null===(e=l.fuseSettings.amazonUam)||void 0===e?void 0:e.enabled)},this.isResponsiveEnabled=function(){return l.fuseSettings.responsive},this.getInskinWidth=function(){return l.fuseSettings.inskinWidth},this.getSupportedSizes=function(e){return l.accountSettings.supported_sizes[e]};var c=this.applyQueryOverrides(n.fuse_settings);this.accountCode=this.determineAccount(a,n.account_code,n.account_domain_map);var d="71161633"===c.networkCode;this.yieldExperiments=this.makeYieldExperimentsSettings(d,c),this.logger.debug("[SETTINGS]: Yield experiments settings: ".concat(JSON.stringify(this.yieldExperiments))),this.forceSafeFrames=c.forceSafeFrame,this.fuseSettings=this.applyYieldExperimentsOverrides(c,this.yieldExperiments),this.logger.debug("[SETTINGS]: Final: ".concat(JSON.stringify(this.fuseSettings))),this.initFuseSlots(),this.yieldExperimentsTargeting=Object.values(this.yieldExperiments).reduce((function(e,t,i){if(!t.isYieldExperiment)return e;var n="fuse_exp_".concat(i),o=t.isEligible?"".concat(Boolean(t.experimentValue)):"ineligible";return Object.assign(Object.assign({},e),r({},n,o))}),{}),this.additionalYieldExperimentTargeting=Object.assign({},this.yieldExperiments.useRandomBidderElimination.experimentValue&&{"fuse_exp_20-val":this.getEliminatedBidders().length.toString()})}),[{key:"applyQueryOverrides",value:function(e){return mt(e,{useControl:nt("fuseUseControl"),useBidCache:nt("fuseUseBidCache"),in2wInjection:nt("fuseIn2wInjection"),useIndustry:nt("fuseUseIndustry"),useGptPreAuctionModule:nt("fuseUseGptPreAuctionModule"),useId5:nt("fuseUseId5"),useCriteoId:nt("fuseUseCriteoId"),useIncreaseInitialTimeout:nt("fuseUseIncreaseInitialTimeout"),useRefreshPrebidTimeoutBuffering:nt("fuseUseRefreshPrebidTimeoutBuffering"),useAuctionSlotLimit:nt("fuseUseAuctionSlotLimit"),useMaxViewports:nt("fuseUseMaxViewports"),forceSafeFrame:(t=tt("fuseForceSafeFrame"),null===t?void 0:t),in2wSafeframe:nt("fuseIn2wSafeframe"),forceAuctionBidSizes:nt("fuseForceAuctionBidSizes"),fullScreenAdExpansion:nt("fuseFullScreenAdExpansion"),usePrebidContextualSignals:nt("fuseUsePrebidContextualSignals"),useSharedId:nt("fuseUseSharedId"),useComboZones:nt("fuseUseComboZones"),usePairId:nt("fuseUsePairId"),useViewportRefresh:nt("fuseUseViewportRefresh"),useAbandonLazyAuction:nt("fuseUseAbandonLazyAuction"),useRandomBidderElimination:nt("fuseUseRandomBidderElimination")});var t}},{key:"applyYieldExperimentsOverrides",value:function(e,t){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n].experimentValue);return mt(e,i)}},{key:"getYieldExperiment",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=b(e);return{setting:e||!1,isYieldExperiment:i,isEligible:t,experimentValue:t&&i?100*Math.random()<Number(e):void 0}}},{key:"getYieldExperimentSettingValue",value:function(e){return"boolean"==typeof(t=e)&&t==t&&e;var t}},{key:"makeYieldExperimentsSettings",value:function(e,t){var i,n,o=!!e&&t.in2wInjection,r=!!e&&t.useId5;return{useControl:this.getYieldExperiment(m(t.useControl)?5:t.useControl),useBidCache:this.getYieldExperiment(t.useBidCache),in2wInjection:this.getYieldExperiment(o),useIndustry:this.getYieldExperiment(t.useIndustry),useGptPreAuctionModule:this.getYieldExperiment(t.useGptPreAuctionModule),useId5:this.getYieldExperiment(!(null===(i=t.id5)||void 0===i?void 0:i.enabled)&&r),useCriteoId:this.getYieldExperiment(t.useCriteoId),useIncreaseInitialTimeout:this.getYieldExperiment(t.useIncreaseInitialTimeout),useRefreshPrebidTimeoutBuffering:this.getYieldExperiment(t.useRefreshPrebidTimeoutBuffering),useAuctionSlotLimit:this.getYieldExperiment(t.useAuctionSlotLimit),useMaxViewports:this.getYieldExperiment(!t.maxViewportsFirstAuction&&t.useMaxViewports),in2wSafeframe:this.getYieldExperiment(t.forceSafeFrame?t.in2wSafeframe:void 0),forceAuctionBidSizes:this.getYieldExperiment(t.forceAuctionBidSizes),fullScreenAdExpansion:this.getYieldExperiment(t.fullScreenAdExpansion),usePrebidContextualSignals:this.getYieldExperiment(t.usePrebidContextualSignals),useSharedId:this.getYieldExperiment(t.useSharedId),useComboZones:this.getYieldExperiment(t.useComboZones),usePairId:this.getYieldExperiment(t.usePairId),useViewportRefresh:this.getYieldExperiment(t.useViewportRefresh),useAbandonLazyAuction:this.getYieldExperiment(t.useAbandonLazyAuction),useRandomBidderElimination:this.getYieldExperiment(t.useRandomBidderElimination,this.getAvailableBidders().length>=8&&(n=this.viewportInfo.getCurrentBreakpoint().name,"xs"===n||"s"===n))}}},{key:"getYieldExperimentsTargeting",value:function(){return this.yieldExperimentsTargeting}},{key:"getAdditionalYieldExperimentsTargeting",value:function(){return this.additionalYieldExperimentTargeting}},{key:"getUamSettings",value:function(){return this.fuseSettings.amazonUam}},{key:"isPrebidEnabled",value:function(){var e;return!this.isYandexEnabled()&&(!this.forceDisablePrebid&&(null===(e=this.fuseSettings.prebid)||void 0===e?void 0:e.enabled))}},{key:"isPrebidServer",value:function(){return this.getPrebidServerBidders().length>0&&(this.fuseSettings.enablePrebidServer||tt("fuseEnablePrebidServer"))}},{key:"isPrebidServerAnalytics",value:function(){return this.isPrebidServer&&(this.fuseSettings.enablePrebidServerAnalytics||tt("fuseEnablePrebidServerAnalytics"))}},{key:"getAssertiveYieldEntityId",value:function(){return this.fuseSettings.assertiveYieldEntityId}},{key:"getPrebidServerBidders",value:function(){return this.fuseSettings.prebidServerBidderCodes||[]}},{key:"getPrebidClientBidders",value:function(){return this.fuseSettings.prebidClientBidderCodes||[]}},{key:"getPrebidSettings",value:function(){return this.fuseSettings.prebid}},{key:"getFuseUUID",value:function(){return this.accountSettings.fuse_uuid}},{key:"getSco",value:function(){return this.accountSettings.sco}},{key:"getTagRevision",value:function(){return this.accountSettings.publication_metadata.revision}},{key:"getFuseId",value:function(){return this.accountSettings.fuse_id}},{key:"getUseTelemetry",value:function(){return"disabled"!==this.fuseSettings.telemetry}},{key:"getIosChromeClickHandle",value:function(){return Boolean(this.fuseSettings.iosChromeClickHandle)}},{key:"getReportPageInfo",value:function(){return Boolean(this.fuseSettings.useReportPageInfo)}},{key:"getEventHistoryTTLOverride",value:function(){var e;return null!==(e=this.fuseSettings.eventHistoryTTLOverride)&&void 0!==e?e:300}},{key:"getConfiantId",value:function(){return this.fuseSettings.confiantId}},{key:"getLowDwellPages",value:function(){return this.fuseSettings.lowDwellPages||[]}},{key:"getMaxViewportsFirstAuction",value:function(){var e;return null!==(e=this.fuseSettings.maxViewportsFirstAuction)&&void 0!==e?e:this.isUseMaxViewportsEnabled()?1:void 0}},{key:"getCmpProvider",value:function(){return this._cmpProvider||(this._cmpProvider=this.isCmpRequired()?this.fuseSettings.cmpProvider:{partner:"none"},this.isNoCmpTestMode()&&"none"===this._cmpProvider.partner&&(this.logger.warn("[SETTINGS]: No CMP provider configured for noCmpTestMode, forcing Quantcast"),this._cmpProvider={partner:"quantcast"})),this._cmpProvider}},{key:"isCmpRequired",value:function(){return!this.isYandexEnabled()&&("none"!==this.fuseSettings.cmp||this.isNoCmpTestMode())}},{key:"isNoCmpTestMode",value:function(){var e;return void 0===this._noCmpTestValue&&(this._noCmpTestValue="noCmp"===this.accountSettings.fuse_flavour&&100*Math.random()<(null!==(e=this.fuseSettings.noCmpTestWeight)&&void 0!==e?e:1)),this._noCmpTestValue}},{key:"getCmpMode",value:function(){return this.isYandexEnabled()||!this.fuseSettings.cmp?"disabled":this.fuseSettings.strict_cmp?"strict":"enabled"}},{key:"getCmpSkipStub",value:function(){return Boolean(this.fuseSettings.cmpSkipStub||"fundingchoices"===this.getCmpProvider().partner)}},{key:"getDisableGppStub",value:function(){return Boolean(this.fuseSettings.disableGppStub)}},{key:"getGdprTimeoutMillis",value:function(){var e;return null!==(e=et("fuseTagGdprTimeoutMs"))&&void 0!==e?e:2e4}},{key:"getUspTimeoutMillis",value:function(){return 100}},{key:"getTagStartCutoffMs",value:function(){var e;return null!==(e=et("fuseTagStartCutoffMs"))&&void 0!==e?e:this.fuseSettings.tagStartCutoffMs}},{key:"getPrebidDownloadCutoffMs",value:function(){var e;return null!==(e=et("fusePrebidDownloadCutoffMs"))&&void 0!==e?e:this.fuseSettings.prebidDownloadCutoffMs}},{key:"getPrebidTagStartCutoffMs",value:function(){var e;return null!==(e=et("fusePrebidTagStartCutoffMs"))&&void 0!==e?e:this.fuseSettings.prebidTagStartCutoffMs}},{key:"getUamTagStartCutoffMs",value:function(){var e;return null!==(e=et("fuseUamTagStartCutoffMs"))&&void 0!==e?e:this.fuseSettings.uamTagStartCutoffMs}},{key:"getAuctionMaxSlots",value:function(){var e,t,i=null!==(t=null!==(e=et("fuseAuctionMaxSlots"))&&void 0!==e?e:this.fuseSettings.auctionMaxSlots)&&void 0!==t?t:99;return this.isAuctionSlotLimitEnabled()?Math.min(i,10):i}},{key:"isIdentityEnabled",value:function(){var e,t;return null!==(t=null===(e=this.fuseSettings.identity)||void 0===e?void 0:e.enabled)&&void 0!==t&&t}},{key:"getIdentitySettings",value:function(){return this.fuseSettings.identity}},{key:"getAfsSettings",value:function(){return this.fuseSettings.afs||{enabled:!1}}},{key:"isComboZoneEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useComboZones)}},{key:"isComboZoneYeRunning",value:function(){return this.yieldExperiments.useComboZones.isYieldExperiment}},{key:"isId5Enabled",value:function(){var e;return(null===(e=this.fuseSettings.id5)||void 0===e?void 0:e.enabled)||this.getYieldExperimentSettingValue(this.fuseSettings.useId5)}},{key:"isGptPreAuctionEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useGptPreAuctionModule)}},{key:"isIn2wInjection",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.in2wInjection)}},{key:"isIn2wSafeframe",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.in2wSafeframe)}},{key:"isBidCacheEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useBidCache)}},{key:"isPairIdEnabled",value:function(){return"v5"===this.getTagRevision()&&this.getYieldExperimentSettingValue(this.fuseSettings.usePairId)}},{key:"isAbandonLazyAuctionEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useAbandonLazyAuction)}},{key:"isPrebidContextualSignalsEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.usePrebidContextualSignals)}},{key:"isSharedIdEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useSharedId)}},{key:"isFuseIndustryEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useIndustry)}},{key:"isCriteoIdEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useCriteoId)}},{key:"isRefreshPrebidTimeoutBuffering",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useRefreshPrebidTimeoutBuffering)}},{key:"isIncreaseInitialTimeout",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useIncreaseInitialTimeout)}},{key:"isAuctionSlotLimitEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useAuctionSlotLimit)}},{key:"isUseMaxViewportsEnabled",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useMaxViewports)}},{key:"isUseRandomBidderEliminationEnabled",value:function(){return this.yieldExperiments.useRandomBidderElimination.isEligible&&(this.getYieldExperimentSettingValue(this.fuseSettings.useRandomBidderElimination)||this.yieldExperiments.useRandomBidderElimination.experimentValue)}},{key:"getRefreshStrategy",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.useViewportRefresh)?"ViewportRefreshStrategy":"ScheduledRefreshStrategy"}},{key:"isAutoRegistrationEnabled",value:function(){return Boolean(this.fuseSettings.enableAutoRegistration)}},{key:"getId5PartnerId",value:function(){var e,t,i=(null===(e=this.fuseSettings.id5)||void 0===e?void 0:e.enabled)?null===(t=this.fuseSettings.id5)||void 0===t?void 0:t.partnerId:void 0;return this.yieldExperiments.useId5.isYieldExperiment&&this.yieldExperiments.useId5.experimentValue?1189:i}},{key:"getVideoSettings",value:function(){var e;return null!==(e=this.fuseSettings.videoSettings)&&void 0!==e?e:{enabled:!1}}},{key:"isConfiantEnabled",value:function(){return!this.isYandexEnabled()&&this.fuseSettings.confiant}},{key:"isPubstackEnabled",value:function(){return!!this.fuseSettings.pubstackId}},{key:"isGeoEdgeEnabled",value:function(){return Boolean(this.fuseSettings.useGeoEdge)}},{key:"getGeoEdgeAdvertiserIds",value:function(){return this.fuseSettings.geoEdgeAdvertIds||[]}},{key:"getGeoEdgePubIds",value:function(){return this.fuseSettings.geoEdgePubIds||[]}},{key:"getGeoEdgeKey",value:function(){return this.fuseSettings.geoEdgeKey}},{key:"getPubstackId",value:function(){return this.fuseSettings.pubstackId}},{key:"isBlockthroughEnabled",value:function(){return!this.isYandexEnabled()&&this.fuseSettings.blockthrough}},{key:"isWidgetRendererEnabled",value:function(){return!this.v2Compatibility.disableWidgetsRenderer&&!this.fuseSettings.disableWidgetsRenderer}},{key:"setDisableWidgetRenderer",value:function(){this.v2Compatibility.disableWidgetsRenderer=!0}},{key:"isStrictCmp",value:function(){return Boolean(this.fuseSettings.strict_cmp)}},{key:"isRequestGdprPersonalisation",value:function(){return!this.fuseSettings.disableGdprPersonalisation}},{key:"isIframeCmp",value:function(){return"iframe"===this.fuseSettings.cmp}},{key:"setForceDisablePrebid",value:function(){this.logger.log("[CONFIG]: Forcefully disabling prebid"),this.forceDisablePrebid=!0}},{key:"isMiniScrollersEnabled",value:function(){return Boolean(this.fuseSettings.enableMiniScrollers)}},{key:"scrollToStickDisableDepth",value:function(){return this.fuseSettings.scrollToStickDisableDepth}},{key:"isSpaOldBlockingPageInit",value:function(){return Boolean(this.fuseSettings.spaOldBlockingPageInit)}},{key:"getTopStickyHeaderSelector",value:function(){var e,t;return(null===(t=null===(e=this.getFuseSlots().filter((function(e){var t,i;return(null===(t=e.attributes)||void 0===t?void 0:t.miniscroller)&&(null===(i=e.miniscrollerAttributes)||void 0===i?void 0:i.topStickyHeaderSelector)}))[0])||void 0===e?void 0:e.miniscrollerAttributes)||void 0===t?void 0:t.topStickyHeaderSelector)||it("fuseTopStickyHeaderSelector")||this.fuseSettings.topStickyHeaderSelector}},{key:"getSlotRefWithoutMcm",value:function(e){var t=/^(\/\d*),(\d*)(\/.*)$/i;if(!1===t.test(e))return this.logger.debug("[SETTINGS]: regExGamAdUnitRef.test(slotRef): ".concat(JSON.stringify(t.test(e)),", slotRef: ").concat(e)),e;this.logger.debug("[SETTINGS]: regExGamAdUnitRef.test(slotRef): ".concat(JSON.stringify(t.test(e)),", slotRef: ").concat(e));var i=t.exec(e);return this.logger.debug("[SETTINGS]: slotRef: ".concat(e,", matches: ").concat(JSON.stringify(i))),"".concat(i[1]).concat(i[3])}},{key:"cleanSlotBasedOnMcmMode",value:function(e){var t=this.getSlotRefWithoutMcm(e.slot);return this.logger.debug("[SETTINGS]: before: with MCM: ".concat(e.slot,", after: without MCM: ").concat(t)),Object.assign(Object.assign({},e),{slot:t})}},{key:"cleanSlotSizeMapping",value:function(e){var t,i,n,o,r,s={};return(null===(t=e.sizeMapping)||void 0===t?void 0:t.xl)&&(s.xl=e.sizeMapping.xl),(null===(i=e.sizeMapping)||void 0===i?void 0:i.l)&&(s.l=e.sizeMapping.l),s.m=null===(n=e.sizeMapping)||void 0===n?void 0:n.m,s.s=null===(o=e.sizeMapping)||void 0===o?void 0:o.s,s.xs=null===(r=e.sizeMapping)||void 0===r?void 0:r.xs,Object.assign(Object.assign({},e),{sizeMapping:s})}},{key:"initFuseSlots",value:function(){var e=this;this.accountSettings.fuse_slots=this.accountSettings.fuse_slots.map((function(t){var i=e.cleanFuseSlot(Boolean(tt("fuseMcmOff")),t),n="lazy"===i.activateConditionConfig.type?e.getCurrentBreakpoint():void 0;if(i=It(i,n),i=wt(i,e.fuseSettings.tagCategories),i=e.applyOverrides(i),e.isUseRandomBidderEliminationEnabled()){e.logger.debug("[SETTINGS]: Eliminating bidders from ".concat(i.id));var o=e.getEliminatedBidders();i.bids=i.bids.filter((function(e){return!o.includes(e.bidder)}))}return e.cleanSlotSizeMapping(i)}))}},{key:"cleanFuseSlot",value:function(e,t){return e?(this.logger.debug("[SETTINGS]: will".concat(e?"":" NOT"," remove MCM child reference from the slot ref - ").concat(t.slot)),this.cleanSlotBasedOnMcmMode(t)):t}},{key:"getFuseSlots",value:function(){return this.accountSettings.fuse_slots}},{key:"parseAttributesToComboZoneParams",value:function(e){return bt(e.layout)}},{key:"applyOverrides",value:function(e){var t,i,n,o,r,s,a,u,l,c,d,g,h,f,p,v,b,m,S,y,k,I,w,E,C,T,x,_,A,R,P,O,D,z,L;return Object.assign(Object.assign({},e),{attributes:Object.assign(Object.assign({},e.attributes),{interscroller:void 0!==(null===(i=null===(t=this.overrideParams)||void 0===t?void 0:t.interscrollersParams)||void 0===i?void 0:i[e.id])||(null===(n=e.attributes)||void 0===n?void 0:n.interscroller),sticky:void 0!==(null===(r=null===(o=this.overrideParams)||void 0===o?void 0:o.stickiesParams)||void 0===r?void 0:r[e.id])||(null===(s=e.attributes)||void 0===s?void 0:s.sticky),dynamic:void 0!==(null===(u=null===(a=this.overrideParams)||void 0===a?void 0:a.dynamicParams)||void 0===u?void 0:u[e.id])||(null===(l=e.attributes)||void 0===l?void 0:l.dynamic),scrollToStick:void 0!==(null===(d=null===(c=this.overrideParams)||void 0===c?void 0:c.scrollToStickParams)||void 0===d?void 0:d[e.id])||(null===(g=e.attributes)||void 0===g?void 0:g.scrollToStick),miniscroller:void 0!==(null===(f=null===(h=this.overrideParams)||void 0===h?void 0:h.miniscrollersParams)||void 0===f?void 0:f[e.id])||(null===(p=e.attributes)||void 0===p?void 0:p.miniscroller),forceComboZone:void 0!==(null===(m=null===(b=null===(v=this.overrideParams)||void 0===v?void 0:v.comboZoneParams)||void 0===b?void 0:b[e.id])||void 0===m?void 0:m.layout)||(null===(S=e.attributes)||void 0===S?void 0:S.forceComboZone),comboZoneEnabled:void 0!==(null===(I=null===(k=null===(y=this.overrideParams)||void 0===y?void 0:y.comboZoneParams)||void 0===k?void 0:k[e.id])||void 0===I?void 0:I.comboZoneEnabled)||e.attributes.comboZoneEnabled}),interscrollerAttributes:Object.assign(Object.assign({},e.interscrollerAttributes),null===(E=null===(w=this.overrideParams)||void 0===w?void 0:w.interscrollersParams)||void 0===E?void 0:E[e.id]),stickyAttributes:Object.assign(Object.assign({},e.stickyAttributes),null===(T=null===(C=this.overrideParams)||void 0===C?void 0:C.stickiesParams)||void 0===T?void 0:T[e.id]),dynamicAttributes:Object.assign(Object.assign({},e.dynamicAttributes),null===(_=null===(x=this.overrideParams)||void 0===x?void 0:x.dynamicParams)||void 0===_?void 0:_[e.id]),miniscrollerAttributes:Object.assign(Object.assign({},e.miniscrollerAttributes),null===(R=null===(A=this.overrideParams)||void 0===A?void 0:A.miniscrollersParams)||void 0===R?void 0:R[e.id]),comboZoneAttributes:Object.assign(Object.assign({},e.comboZoneAttributes),(null===(D=null===(O=null===(P=this.overrideParams)||void 0===P?void 0:P.comboZoneParams)||void 0===O?void 0:O[e.id])||void 0===D?void 0:D.layout)?this.parseAttributesToComboZoneParams(null===(L=null===(z=this.overrideParams)||void 0===z?void 0:z.comboZoneParams)||void 0===L?void 0:L[e.id]):{})})}},{key:"generateZoneTemplate",value:function(e,t){var i=this.getZoneTemplate(e);if(i){if(!this.zoneCustomiser())return i;var n=function(e,t,i){if(i)try{return void e.log("[ZONE][".concat(t,"][fuseZoneCustomiser] Start"))}catch(i){e.error("[ZONE][".concat(t,"][fuseZoneCustomiser] Encountered error during evaluation"),i)}else e.error("[ZONE][".concat(t,"][fuseZoneCustomiser] api is not defined, skip customisation"))}(this.logger,e,t);if(n){var o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),{id:n.id,slot:n.gamSlotPath}),n.bids?{bids:n.bids}:{}),n.targeting?{targeting:n.targeting}:{}),{originalZoneTemplateId:i.id}),r=this.accountSettings.fuse_slots.find((function(e){return e.id===o.id}));return r?r.slot!==o.slot?(this.logger.error("[SETTINGS]: ZoneTemplateOverrides for id ".concat(o.id," does not match slot ").concat(o.slot)),r):o:(this.accountSettings.fuse_slots.push(o),o)}return i}}},{key:"getZoneTemplate",value:function(e){return this.getFuseSlots().filter((function(t){return e==t.id||e==t.gamAdUnitId}))[0]}},{key:"isScanDOMOnPageLoad",value:function(){var e=this.fuseSettings.disableAutoLoadSlots;return m(e)||!e}},{key:"isHeaderBiddingSlot",value:function(e){return!e.attributes.interstitial&&e.attributes.headerbidding&&e.bids.length>0}},{key:"isSlotWidget",value:function(e){var t,i,n;return(null===(t=e.attributes)||void 0===t?void 0:t.interscroller)||(null===(i=e.attributes)||void 0===i?void 0:i.sticky)||(null===(n=e.attributes)||void 0===n?void 0:n.dynamic)||null}},{key:"maxSlotHeightForBreakpoint",value:function(e,t){var i;return null===(i=e.sizeMapping[t])||void 0===i?void 0:i.reduce((function(e,t){return b(t[1])&&t[1]>e?Number(t[1]):e}),0)}},{key:"getPrebidOptions",value:function(e){var t,i,n;if(this.isPrebidEnabled()&&this.fuseSettings.prebid.breakpoint_options){var o=this.fuseSettings.prebid.breakpoint_options[e];if(o)return{enabled:o.enabled,sendAllBids:!0===this.fuseSettings.prebid.sendAllBids,timeout:null!==(i=null!==(t=o.timeout)&&void 0!==t?t:this.fuseSettings.prebid.defaultTimeout)&&void 0!==i?i:1e3}}return{enabled:this.isPrebidEnabled(),sendAllBids:!0===this.fuseSettings.prebid.sendAllBids,timeout:null!==(n=this.fuseSettings.prebid.defaultTimeout)&&void 0!==n?n:1e3}}},{key:"isPrebidEnabledAtBP",value:function(e){return this.isPrebidEnabled()&&this.getPrebidOptions(e).enabled}},{key:"isUamEnabledAtBP",value:function(e){return this.isUamEnabled()&&this.getPrebidOptions(e).enabled}},{key:"getHbTimeout",value:function(e,t){var i=this.getPrebidOptions(e).timeout;return t?this.isRefreshPrebidTimeoutBuffering()?4e3:i:this.isIncreaseInitialTimeout()?1.5*i:i}},{key:"getPrebidMediaTypes",value:function(){return this.fuseSettings.prebidMediaTypes||["banner"]}},{key:"isPrebidBannerEnabled",value:function(){return this.getPrebidMediaTypes().includes("banner")}},{key:"isPrebidVideoEnabled",value:function(){return this.getPrebidMediaTypes().includes("video")}},{key:"isPrebidNativeEnabled",value:function(){return this.getPrebidMediaTypes().includes("native")}},{key:"isSlotEnabledForBreakpoint",value:function(e,t){var i,n;return(null!==(n=null===(i=e.sizeMapping)||void 0===i?void 0:i[t])&&void 0!==n?n:[]).length>0}},{key:"getPublicationId",value:function(){return this.accountSettings.publication_metadata.publication_id}},{key:"getFlavour",value:function(){return this.accountSettings.fuse_flavour||"default"}},{key:"getFuseCDN",value:function(){return this.accountSettings.fuse_cdn}},{key:"getFuseCDNPlatform",value:function(){return this.accountSettings.fuse_cdn_platform}},{key:"getPrebidHash",value:function(){return this.accountSettings.fuse_prebid_hash}},{key:"getBlockedUrls",value:function(){return this.accountSettings.fuse_blocked_url||[]}},{key:"getFuseIndustry",value:function(){return this.accountSettings.fuse_industry}},{key:"getFuseSettings",value:function(){return this.fuseSettings}},{key:"getEdgeHtmlMaxAdsRefreshLimit",value:function(){return this.fuseSettings.edgeHtmlMaxAdsRefreshLimit||60}},{key:"getDefaultRefreshInterval",value:function(){return this.fuseSettings.refresh}},{key:"getRefreshTimeout",value:function(e){var t=e.attributes.refresh,i=void 0;if(b(t)&&t>0)i=t;else if(0===t)i=0;else{var n=this.getDefaultRefreshInterval();n&&n>0&&(i=n)}return i&&this.isRefreshPrebidTimeoutBuffering()&&(i-=4),i}},{key:"getAccountSettings",value:function(){return this.accountSettings}},{key:"getV2CompatOverrides",value:function(){return this.v2Compatibility}},{key:"isTestCreatives",value:function(){return tt("fuseTestCreatives")||!1}},{key:"getCmpDeterminedSampleRate",value:function(){var e;return null!==(e=this.fuseSettings.cmpDeterminedSampleRate)&&void 0!==e?e:0}},{key:"getPrebidTelemetrySampleRate",value:function(){var e;return null!==(e=this.fuseSettings.prebidTelemetrySampleRate)&&void 0!==e?e:1}},{key:"getSlotRequestTelemetrySampleRate",value:function(){var e;return null!==(e=this.fuseSettings.slotRequestTelemetrySampleRate)&&void 0!==e?e:1}},{key:"getPrebidAdRenderSucceededTelemetrySampleRate",value:function(){var e;return null!==(e=this.fuseSettings.prebidAdRenderSucceededTelemetrySampleRate)&&void 0!==e?e:1}},{key:"isForceAuctionBidSizes",value:function(){return this.getYieldExperimentSettingValue(this.fuseSettings.forceAuctionBidSizes)}},{key:"getSlotTestUrls",value:function(){return this.fuseSettings.fuse_test_urls||[]}},{key:"getYandexBlockId",value:function(){return it("fuseYandexBlockId")||this.fuseSettings.yandexBlockId}},{key:"isYandexEnabled",value:function(){return this.fuseSettings.yandex||tt("fuseYandex")||""!==it("fuseYandexBlockId")}},{key:"isPubxaiEnabled",value:function(){return this.fuseSettings.usePubxai||!1}},{key:"getIn2wRatio",value:function(){return this.yieldExperiments.in2wInjection.isYieldExperiment&&this.yieldExperiments.in2wInjection.experimentValue?.9:this.fuseSettings.in2wRatio}},{key:"getIn2wAdvertiserId",value:function(){return this.fuseSettings.in2wAdvertiserId}},{key:"getIn2wAdvertiserTimeZone",value:function(){return this.fuseSettings.in2wAdvertiserTimeZone}},{key:"getUseTcfV2",value:function(){return this.fuseSettings.useTcfv2||!1}},{key:"getTenantCode",value:function(){return this.accountSettings.fuse_tenant}},{key:"getPrebidIasPubId",value:function(){return this.fuseSettings.prebidIasPubId}},{key:"zoneCustomiser",value:function(){return this.fuseSettings.zoneCustomiser}},{key:"determineAccount",value:function(e,t,i){if(t)return t;if(i){var n=i[e];if(n)return n;this.logger.error("[SETTINGS]: Unable to determine account, no account code defined and/or unable to determine account from given domain map")}else this.logger.error("[SETTINGS]: Unable to determine account, neither account code nor domain map were defined.")}},{key:"getAccountCode",value:function(){return this.accountCode}},{key:"isForceSafeFrames",value:function(){return Boolean(this.forceSafeFrames)}},{key:"setForceSafeFrames",value:function(e){this.forceSafeFrames=Boolean(null==e||e)}},{key:"getCurrentBreakpoint",value:function(e){var t,i=this.breakpoints,n=null!=e?e:this.viewportInfo.getViewportStatus().width;return Object.keys(i).forEach((function(e){var o=i[e];n>=o&&(!t||o>t.size)&&(t={size:o,name:e})})),t}},{key:"getAvailableBidders",value:function(){return this.availableBidders||(this.availableBidders=Array.from(new Set(this.accountSettings.fuse_slots.reduce((function(e,t){return[].concat(d(e),d(t.bids.map((function(e){return e.bidder}))))}),[]))),this.logger.debug("[SETTINGS]: Available bidders: ".concat(this.availableBidders))),this.availableBidders}},{key:"getEliminatedBidders",value:function(){if(!this.eliminatedBidders){for(var e=Math.floor(5*Math.random())+1,t=this.getAvailableBidders().slice(),i=t.length-1;i>0;i--){var n=Math.floor(Math.random()*(i+1)),o=[t[n],t[i]];t[i]=o[0],t[n]=o[1]}this.eliminatedBidders=t.slice(0,e),this.logger.debug("[SETTINGS]: Selected bidders to be eliminated: ".concat(this.eliminatedBidders))}return this.eliminatedBidders}}])}(),yt=function(){return o((function e(){i(this,e)}),[{key:"getSettings",value:function(){if(!this.settingsAll){var e=E.getWindowLocation();this.settingsAll=new St(E.getLogger(),at.getAccountSettings(),at.getBreakpoints(),gt.getViewportInfo(),E.getBrowserWindowObject().location.hostname,{comboZoneParams:ot("combozone",e)})}return this.settingsAll}}])}(),kt=new yt,It=function(e,t){var i=e.activateConditionConfig,n={activateCondition:void 0,excludeFromAuctionBlock:"none"!==i.type};switch(i.type){case"none":break;case"lazy":var o=null==t?void 0:t.name,r=i.scrollDistance[o];if(m(r)||!1===r)break;n=Object.assign(Object.assign({},n),{activateCondition:{type:"condition",name:qe,params:i.scrollDistance}});break;case"manual":n=Object.assign(Object.assign({},n),{activateCondition:{type:"condition",name:Ke}});break;case"custom":n=Object.assign(Object.assign({},n),{activateCondition:i.config});break;default:I(i)}return Object.assign(Object.assign({},e),n)},wt=function(e,t){var i;if(!t||!Object.keys(t).length)return e;if(!(null===(i=e.zoneCategories)||void 0===i?void 0:i.length))return e;var n={type:"or",subConditions:e.zoneCategories.map((function(e){return t[e]}))};return e.activateCondition?Object.assign(Object.assign({},e),{activateCondition:{type:"and",subConditions:[e.activateCondition,n]}}):Object.assign(Object.assign({},e),{activateCondition:n})},Et=function(e,t,i,n){return function(o){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.fetch?Ct(e,t,i,n,o,r):Tt(o,r)}},Ct=function(e,t,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return e.fetch(o,{method:r.method||"GET",credentials:"omit",mode:r.mode||"cors",keepalive:!0,headers:r.headers||{},body:r.body}).then((function(e){if(!e.ok&&"no-cors"!==r.mode)throw new Error("Network response was not ok");return e})).catch((function(e){var o=String(e).toLowerCase();if(o.includes("TypeError: NetworkError when attempting to fetch resource".toLowerCase()))t.warn("Unable to fire ".concat(n," request, possibly unable to outlive environment."));else if(o.includes("TypeError: Load failed".toLowerCase())&&i===_.Safari)t.warn("Unable to fire ".concat(n," request, unknown network error."));else{if(!o.includes("TypeError: Failed to fetch".toLowerCase()))throw e;t.warn("Unable to fire ".concat(n," request, possibly be blocked by AdBlock."))}}))},Tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(i,n){var o=new XMLHttpRequest;o.onload=function(){o.status>=200&&o.status<300?i(new Response(o.responseText,{status:o.status,statusText:o.statusText})):n(new Error("Request failed with status "+o.status))},o.onerror=function(){return n(new Error("Network error"))},o.open(t.method||"GET",e,!0),y(t.headers)&&Object.keys(t.headers).forEach((function(e){o.setRequestHeader(e,t.headers[e])})),o.send(t.body||null)}))};function xt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gzip",i=JSON.stringify(e),n=(new TextEncoder).encode(i),o=new ReadableStream({start:function(e){e.enqueue(n),e.close()}}).pipeThrough(new CompressionStream(t));return new Response(o).arrayBuffer().then((function(e){return btoa(String.fromCharCode.apply(String,d(new Uint8Array(e))))}))}var _t,At=function(){return o((function e(){i(this,e),this.slotRefreshCounts={},this.templateUsageCounts={}}),[{key:"getSlotRefreshCount",value:function(e){return this.slotRefreshCounts[e]||0}},{key:"getTemplateUsageCount",value:function(e){return this.templateUsageCounts[e]||0}},{key:"incrementSlotRefreshCount",value:function(e){this.slotRefreshCounts[e]=this.getSlotRefreshCount(e)+1}},{key:"incrementTemplateUsageCount",value:function(e){this.templateUsageCounts[e]=this.getTemplateUsageCount(e)+1}},{key:"resetCounts",value:function(){this.slotRefreshCounts={},this.templateUsageCounts={}}}])}(),Rt=function(){return o((function e(t){var n=this;i(this,e),this._comboZoneState={},t.onPageReset.subscribe((function(){n.clearAllComboZoneState()})),t.onZoneDeleted.subscribe((function(e){n.clearComboZoneState(e.slotDivId)}))}),[{key:"comboZoneState",get:function(){return 0===Object.keys(this._comboZoneState).length?void 0:this._comboZoneState}},{key:"setComboZoneState",value:function(e,t){this._comboZoneState[e]=t}},{key:"clearComboZoneState",value:function(e){delete this._comboZoneState[e]}},{key:"clearAllComboZoneState",value:function(){this._comboZoneState={}}}])}(),Pt=new(function(){return o((function e(){i(this,e)}),[{key:"getDeviceInfo",value:function(){return this.deviceInfo||(this.deviceInfo=new B(E.getBrowserWindowObject())),this.deviceInfo}},{key:"getTelemetry",value:function(){var e=Et(E.getBrowserWindowObject(),E.getLogger(),_.Chrome,"telemetry");return this.telemetry||(this.telemetry=new Fe(this.getComponentStatusStore(),this.getDeviceInfo(),E.getLogger(),E.getBrowserWindowObject(),E.getSessionId(),this.getGptCountManager(),this.getReporter(),this.getComboZoneState(),e,kt.getSettings(),{onSlotRequested:He.onSlotRequested,onPageInit:He.onPageInit,onComponentInitEvent:He.onComponentInitEvent},xt)),this.telemetry}},{key:"getReporter",value:function(){if(!this.reporter){var e=E.getFuseDob();this.reporter=new M(e,{onSlotLoaded:He.onSlotLoaded,onSlotResponse:He.onSlotResponse,onImpressionViewable:He.onImpressionViewable})}return this.reporter}},{key:"getComponentStatusStore",value:function(){return this.pluginStateStore||(this.pluginStateStore=new W(He.onComponentInitEvent,E.getLogger(),this.getReporter())),this.pluginStateStore}},{key:"getGptCountManager",value:function(){return this.gptCountManager||(this.gptCountManager=new At),this.gptCountManager}},{key:"getComboZoneState",value:function(){return this.comboZoneState||(this.comboZoneState=new Rt({onZoneDeleted:He.onZoneDeleted,onPageReset:He.onPageReset})),this.comboZoneState}}])}()),Ot=function(e,t,i,n){e.debug("".concat(n,"[EVENT][").concat(i.slot.getSlotElementId(),"]: ").concat(t," event details: ").concat(JSON.stringify(i)))},Dt=[5068036699,5101751880,5189144814,5144578315,5221077018,5104488413],zt=function(e){var t=e.slot.getResponseInformation();return Boolean((null==t?void 0:t.advertiserId)&&Dt.includes(t.advertiserId))},Lt={name:"Google Publisher Tag",url:"//securepubads.g.doubleclick.net/tag/js/",file:"gpt.js"},Nt=!1,Bt=!1,Mt=E.getLogger(),Ft=E.getBrowserWindowObject(),jt=E.getWindowLocation(),Ut=Pt.getReporter(),Gt=Pt.getComponentStatusStore(),Wt=kt.getSettings(),Vt=Pt.getGptCountManager();function Ht(e){return"function"==typeof e.getVersion?"v".concat(e.getVersion()):"unknown version"}var Zt=function(){return Ft.googletag?Ft.googletag.cmd||(Mt.info("[GPT]: Initialised window.googletag.cmd as it was missing"),Ft.googletag.cmd=[]):Ft.googletag={cmd:[]},_t=Ft.googletag,Ft.googletag},qt=function(e){return Zt().cmd.push(e)};function Yt(e,t){qt((function(){var i=[];t.forEach((function(t){var n=function(e,t){if(!_t)return Mt.error("Called getGPTSlot(".concat(e,") but googletag not defined")),[];if(!e)return Mt.error("Called getGPTSlot() without a fuseSlotCode"),[];var i=_t.pubads().getSlots(),n=i.filter((function(t){return e.indexOf(t.getSlotElementId())>=0}));if(n.length!==e.length){var o=i.map((function(e){return e.getSlotElementId()})),r=e.filter((function(e){return-1===o.indexOf(e)}));Mt.warn("[AUCTION][".concat(t,"]: Could not find a GPT slot for all fuse slots.\n      Missing Slots=").concat(JSON.stringify(r),",\n      All GPT Slots: ").concat(JSON.stringify(o)))}return n}([t.slotDivId],e)[0];n?i.push([t,n]):Mt.warn("[AUCTION][".concat(e,"]: Could not find GPT Slot corresponding to ").concat(t.slotDivId))}));var n,o=i.map((function(e){var t=c(e,2);return t[0],t[1]}));o&&0!==o.length?!0===R(Ft)?(Mt.debug("[GC] will trigger GC for iFrames in Edge browser"),(n=Ft.document.querySelectorAll("div[data-fuse] iframe"),new Promise((function(e){setTimeout((function(){try{e()}catch(e){}}),5),n.forEach((function(e){e.addEventListener("load",(function(){try{for(;this.contentWindow.lastChild;)this.contentWindow.removeChild(this.contentWindow.lastChild);Mt.debug("[GC]: cleaned iFrame contentWindow")}catch(e){Mt.error("[GC]: error in cleaning iFrame contentWindow => ".concat(e))}}),{once:!0})})),n.forEach((function(e){e.setAttribute("src","about:blank")})),e()}))).then((function(){try{CollectGarbage()}catch(e){Mt.error("[GC]: error in CollectGarbage => ".concat(e))}r()})).catch((function(e){Mt.error("[GC]: error in purgeIframes => ".concat(e))}))):r():Mt.info("[AUCTION][".concat(e,"]: Cancelled adserver request because no matching GPT slots found"));function r(){!function(e){e.forEach((function(e){var t=e[1],i=t.getSlotElementId(),n=e[0].zoneTemplateId,o=Vt.getSlotRefreshCount(i),r=Vt.getTemplateUsageCount(n);t.setTargeting("is_refresh",(o>0).toString()),t.setTargeting("slot_prev_count",j(o)),t.setTargeting("adunit_prev_count",j(r))}))}(i);var t=JSON.stringify(o.map((function(e){return e.getSlotElementId()})));Ut.addAdEvent("gpt_pubads_refresh_".concat(t),{requestId:e}),Nt||(Ut.reportFirstGptRequest(),Ut.setStateStatus("first_gpt_request"),ii(V(Gt.state.cmp))),Kt(),Nt=!0,Mt.debug("[AUCTION][".concat(e,"]: Calling googletag.pubads().refresh(").concat(t,")")),_t.pubads().refresh(o,{changeCorrelator:Bt}),Bt=!1,function(e){e.forEach((function(e){var t=e[1].getSlotElementId(),i=e[0].zoneTemplateId;Vt.incrementTemplateUsageCount(i),Vt.incrementSlotRefreshCount(t)}))}(i)}}))}function Jt(e,t){var i=e.zoneTemplate.slot,n=_t.defineSlot(i,e.sizes,e.slotDivId);return n?(Ut.addAdEvent("register_gpt_slot_".concat(e.slotDivId),{gpid:e.gpid}),n.addService(_t.pubads()),t.forEach((function(e){n.setTargeting(e.key,e.value)}))):Mt.warn("[GPT]: googletag.defineSlot(".concat(i,", ").concat(JSON.stringify(e.sizes),", ").concat(e.slotDivId,") returned null")),n}var Qt=function(e,t){Mt.debug("[GPT]: Setting page targeting for [key: ".concat(e,", value: ").concat(t,"]")),_t.pubads().setTargeting(e,t)},Kt=function(){var e,t,i;Mt.debug("[GPT]: Applying page targeting"),Qt("fuse_site",(e=jt.host).substring(e.length-40,e.length)),Qt("fuse_path",(t=jt.pathname).substring(t.length-40,t.length)),Qt("fuse_query",(i=jt.search).substring(i.length-40,i.length)),Qt("fuse_category",function(){for(var e=[],t=jt.pathname.split("/"),i=0;i<t.length;i+=1)t[i].length&&-1===t[i].indexOf(".")&&e.push(t[i]);return e}());var n=Wt.getFuseIndustry();n&&Qt(Wt.isFuseIndustryEnabled()?"fuse_industry_2":"fuse_industry",n),Qt("testmode","".concat(Wt.isTestCreatives()));var o=Wt.getInskinWidth(),r="".concat(y(o)&&Ft.screen.width>=o);Qt("inskin_yes",r),Qt("fuse_uuid",Wt.getFuseUUID()),Qt("fuse_publication_id",Wt.getPublicationId().toString()),Qt("fuse_flavour",Wt.getFlavour()),Qt("fuse_cdn",Wt.getFuseCDNPlatform());var s=function(e,t){Qt(e,Nt?"refresh":t)},a=function(e,t){t&&s(e,F(t))};s("GPT_READY_MS",Z(Gt.state.gpt)),s("PREBID_READY_MS",Z(Gt.state.prebid)),s("UAM_READY_MS",Z(Gt.state.uam)),s("CMP_DETERMINED_MS",Z(Gt.state.cmp)),s("CMP_GDPR_CACHED",String(Ut.cmpGdprCached)),a("FUSE_LOADED_MS",Ut.tagLoadedMs),Ut.firstGptRequestMs&&a("GPT_AUCTION_START_MS",Ut.firstGptRequestMs),Ut.cmpLoadFinishMs&&a("CMP_LOAD_FINISH_MS",Ut.cmpLoadFinishMs),Ut.cmpGdprElapsedMs&&a("CMP_GDPR_ELAPSED_MS",Ut.cmpGdprElapsedMs),Ut.firstZoneMs&&a("FIRST_ZONE_MS",Ut.firstZoneMs),Ut.hbAuctionStartMs&&a("HB_AUCTION_START_MS",Ut.hbAuctionStartMs);var u=H(Gt.state.cmp);Qt("CMP_JURISDICTION",u),Qt("CMP_ALLOW_PERSONAL","".concat(V(Gt.state.cmp)));var l=function(e){if("ready"==e._tag&&e.output.noCmpTestResult)return"gdpr"===e.output.noCmpTestResult||"ccpa"===e.output.noCmpTestResult?e.output.noCmpTestResult:"false"}(Gt.state.cmp);l&&Qt("nocmp_mismatch",l);var c=Wt.getYieldExperimentsTargeting();Object.keys(c).forEach((function(e){Qt(e,c[e])}));var d=Wt.getAdditionalYieldExperimentsTargeting();if(Object.keys(d).forEach((function(e){Qt(e,d[e])})),Pt.getDeviceInfo().getBrowser()===_.Chrome){var g=Ft.navigator.cookieDeprecationLabel;g?g.getValue().then((function(e){Qt("chrome_label",e)})).catch((function(e){Mt.error("[GPT]: Error getting chrome label: ".concat(e))})):Qt("chrome_label","standard")}},Xt=function(){qt((function(){Kt()}))},$t=function(e){qt((function(){Wt.setForceSafeFrames(e),_t.pubads().setForceSafeFrame(Wt.isForceSafeFrames())}))},ei=function(){var e=function(e,t,i){return function(n,o){return function(r){var s=t(r);if(Ot(e,n,r,s?"[".concat(i,"]"):""),!t(r))return o(r)}}}(Mt,zt,"IN2W");_t.pubads().disableInitialLoad(),_t.pubads().collapseEmptyDivs(!0),_t.pubads().setCentering(!0),_t.pubads().enableSingleRequest(),Wt.isForceSafeFrames()&&(Mt.debug("[GPT]: Setting forceSafeFrames to true"),$t(!0)),_t.pubads().addEventListener("slotRequested",e("requested",(function(e){Mt.debug("[GPT]: emitting slotRequested event: ".concat(JSON.stringify(e))),He.onSlotRequested.emit(e)}))),_t.pubads().addEventListener("slotResponseReceived",e("response",(function(e){Mt.debug("[GPT]: emitting slotResponseReceived event: ".concat(JSON.stringify(e))),He.onSlotResponse.emit(e)}))),_t.pubads().addEventListener("slotOnload",e("load",(function(e){Mt.debug("[GPT]: emitting slotOnload event: ".concat(JSON.stringify(e))),He.onSlotLoaded.emit(e)}))),_t.pubads().addEventListener("slotRenderEnded",e("render",(function(e){Mt.debug("[GPT]: emitting slotRenderEnded event: ".concat(JSON.stringify(e))),He.onSlotRender.emit(e)}))),_t.pubads().addEventListener("impressionViewable",e("viewable",(function(e){Mt.debug("[GPT]: emitting impressionViewable event: ".concat(JSON.stringify(e))),He.onImpressionViewable.emit(e)}))),Kt()};function ti(e){qt((function(){Mt.debug("[GPT]: Queued events beginning to execute"),Ut.setStateStatus("gpt_queue_start"),C(!Wt.isCmpRequired(),(function(){return ii(!0)})),ei(),_t.enableServices(),e(_t)})),T(et("fuseDelayGptInit"),"simulate gpt init delay",Mt,(function(){Ut.setStateStatus("gpt_load_start"),function(e){var t,i=Zt();(null===(t=Ft.googletag)||void 0===t?void 0:t._loadStarted_)?Mt.debug("[INIT]: GPT ".concat(Ht(i)," is already on the page, skip loading another copy")):D(Lt,(function(){var t;Mt.debug("[INIT]: GPT ".concat((null===(t=Ft.googletag)||void 0===t?void 0:t._loadStarted_)?"".concat(Ht(i)," is loaded"):"not loaded")),e()}))}((function(){Ut.setStateStatus("gpt_load_finish")}))}))}var ii=function(e){var t={nonPersonalizedAds:!e};Mt.info("[GPT]: googletag.pubads().setPrivacySettings(".concat(JSON.stringify(t),")")),Ft.googletag.pubads().setPrivacySettings(t)},ni=function(e){_t.destroySlots(e)},oi=E.getLogger(),ri=Pt.getReporter(),si=kt.getSettings(),ai={name:"Blockthrough",url:"//btloader.com/",file:"tag?o=5708166709903360&upapi=true"};var ui={enableIfApplicable:function(e){si.isBlockthroughEnabled()?gt.getViewportInfo().isNotXsBreakpoint()?(ri.setStateStatus("blockthrough_load_start"),D(ai,(function(){oi.log("[BLOCKTHROUGH]: Tag loaded"),ri.setStateStatus("blockthrough_load_finish"),e&&e()}))):oi.debug("[INIT]: Skip loading blockthrough because page on XS breakpoint"):oi.debug("[INIT]: Skip loading blockthrough because it is not enabled")}},li=E.getLogger(),ci=Pt.getReporter(),di=E.getBrowserWindowObject();var gi={enable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ZVeqITFg3t0RVj7Gh41kEbdx9DA",t=arguments.length>1?arguments[1]:void 0;ci.setStateStatus("confiant_load_start");var i=di.confiant||{};i[e]=i[e]||{clientSettings:{}};var n=i[e].clientSettings||(i[e].clientSettings={});n.callback=function(e,t,i,n,o,r){li.log("[CONFIANT]: Has blocked the ad: ",e,t,i,n,o,JSON.stringify(r))},n.prebidExcludeBidders=[],n.prebidNameSpace="fusePbjs",n.on_prebid_error=function(e){li.log("[CONFIANT]: failed to scan an ad",e)},n.onRendered=function(e){li.log("[CONFIANT]: Rendered the ad",e)},di.confiant=i,D(function(e){return{name:"Confiant",url:"//cdn.confiant-integrations.net/".concat(e,"/gpt_and_prebid/"),file:"config.js"}}(e),(function(){li.log("[CONFIANT]: Script loaded"),ci.setStateStatus("confiant_load_finish"),t&&t()}))}},hi=E.getLogger(),fi=Pt.getReporter();var pi,vi={enable:function(e,t){fi.setStateStatus("pubstack_load_start"),D(function(e){return{name:"Pubstack",url:"//boot.pbstck.com/v1/tag/",file:e}}(e),(function(){hi.log("[PUBSTACK]: Script loaded"),fi.setStateStatus("pubstack_load_finish"),t&&t()}))}},bi=E.getLogger(),mi=Pt.getReporter(),Si=function(){return o((function e(t){i(this,e),this.partnerId=t}),[{key:"configPrebid",value:function(e){var t=e.userSync;return Object.assign(Object.assign({},e),{userSync:Object.assign(Object.assign({},t),{userIds:[].concat(d(t.userIds||[]),[{name:"id5Id",params:{partner:this.partnerId,externalModuleUrl:"https://cdn.id5-sync.com/api/1.0/id5PrebidModule.js"},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:7200}}])})})}}])}();var yi,ki={UserId5:Si,enable:function(){var e=kt.getSettings(),t=e.getId5PartnerId();!pi&&e.isId5Enabled()&&t&&(pi=new Si(t))},getId5Module:function(){return pi}},Ii=function(){return o((function e(t,n){i(this,e),this.browserWindow=t,this.settings=n}),[{key:"setup",value:function(){var e,t=document.createElement("script");t.async=!0,t.defer=!0,t.src="https://launchpad-wrapper.privacymanager.io/".concat(this.settings.userIdentityGlobal||"47eddec1-62a9-4081-b655-0c9fa5eb8a0d","/launchpad-liveramp.js");var i=this.browserWindow.document.getElementsByTagName("script")[0];null===(e=null==i?void 0:i.parentNode)||void 0===e||e.insertBefore(t,i)}},{key:"configPrebid",value:function(e){var t=e.userSync;return Object.assign(Object.assign({},e),{userSync:Object.assign(Object.assign({},t),{userIds:[].concat(d(t.userIds||[]),[{name:"identityLink",params:{pid:this.settings.placementId},storage:{type:"cookie",name:"idl_env",expires:7,refreshInSeconds:1800,notUse3P:!1}}]),syncDelay:3e3})})}}])}();var wi={UserIdentity:Ii,enable:function(e){if(!yi){var t=kt.getSettings();(yi=new Ii(e,t.getFuseSettings().identity)).setup()}},getIdentityModule:function(){return yi}},Ei=function(){return o((function e(t,n,o,r,s){i(this,e),this.logger=t,this.context=n,this.rootCondition=o,this.api=r,this.onSatisfiedCB=s,this.firedCallback=!1}),[{key:"enableTriggers",value:function(){this.rootCondition.enableTriggers(this.api)}},{key:"destroy",value:function(){this.rootCondition.destroyTriggers()}},{key:"checkCondition",value:function(){return this.rootCondition.checkCondition()}},{key:"checkAndFire",value:function(){this.firedCallback||this.rootCondition.checkCondition()&&(this.logger.info("[ACTIVATOR][".concat(this.context,"]: Conditions are satisfied. Destroying triggers and invoking callback")),this.rootCondition.destroyTriggers(),this.firedCallback=!0,this.onSatisfiedCB(this.context))}}])}(),Ci=function(){return o((function e(){i(this,e),this.name="AlwaysTrue"}),[{key:"check",value:function(){return!0}},{key:"buildTriggers",value:function(e){return[]}}])}(),Ti=function(){return o((function e(){i(this,e),this.name="AlwaysFalse"}),[{key:"check",value:function(){return!1}},{key:"buildTriggers",value:function(e){return[]}}])}(),xi=function(){return o((function e(t){i(this,e),this.conditions=t,this.name="AndCondition"}),[{key:"buildTriggers",value:function(e){return[]}},{key:"check",value:function(){return this.conditions.reduce((function(e,t){return e&&t.checkCondition()}),!0)}}])}(),_i=function(){return o((function e(t){i(this,e),this.conditions=t,this.name="OrCondition"}),[{key:"buildTriggers",value:function(e){return[]}},{key:"check",value:function(){return this.conditions.reduce((function(e,t){return e||t.checkCondition()}),!1)}}])}(),Ai=function(e){function n(e){return i(this,n),t(this,n,[e,e.api.events.onWindowResized,function(e){return!e.crossedBp}])}return a(n,e),o(n)}(Je);function Ri(e){return function(e){return e instanceof Error}(e)?e:new Error(String(e))}var Pi=function(){function e(t,n,o,r,s){i(this,e),this.id=t,this.condition=n,this.api=o,this.activatorCallback=r,this.logger=s,this.triggers=null,this.satisfied=!1}return o(e,[{key:"checkCondition",value:function(){return this.checkConditionAndNotify(!1)}},{key:"checkConditionAndNotify",value:function(e){if(!this.satisfied){try{this.satisfied=this.condition.check(this.id,this.api)}catch(e){var t=Ri(e);return this.logger.warn("[CONDITION][".concat(this.condition.name,"][").concat(this.id,"]: Caught exception while checking condition"),t.message,t.stack),!1}this.satisfied&&e&&this.activatorCallback()}return this.satisfied}},{key:"destroyTriggers",value:function(){return e.visitConditions(this,(function(e){e.triggers&&e.triggers.forEach((function(e){e.destroy()}))}))}},{key:"enableTriggers",value:function(t){var i=this;return e.visitConditions(this,(function(e){var n=e.condition,o={id:i.id,api:t,logger:i.logger,onTriggeredCB:function(){return e.checkConditionAndNotify(!0)}};e.triggers=[].concat(d(n.buildTriggers(o)),[new Ai(o)])}))}}],[{key:"visitConditions",value:function(t,i){var n=t.condition;if(n instanceof xi||n instanceof _i)n.conditions.forEach((function(t){return e.visitConditions(t,i)}));else try{i(t)}catch(e){var o=Ri(e);t.logger.warn("[CONDITION][".concat(n.name,"][").concat(t.id,"]: Caught exception while visiting condition:"),o.message,o.stack)}}}])}(),Oi=function(){return o((function e(t){i(this,e),this.logger=t,this.internalConditions={AlwaysTrue:function(){return new Ci},AlwaysFalse:function(){return new Ti}},this.conditions={}}),[{key:"buildActivator",value:function(e,t,i,n){var o,r=this.buildCondition(t,e,i,(function(){return o.checkAndFire()}));return o=new Ei(this.logger,t,r,i,n)}},{key:"registerCondition",value:function(e,t){if(this.conditions[e])throw Error("Condition with ".concat(e," already registered"));this.conditions[e]=t}},{key:"buildCondition",value:function(e,t,i,n){var o=t.type;switch(o){case"and":return this.buildBooleanCondition(e,t,i,n,(function(e){return new xi(e)}));case"or":return this.buildBooleanCondition(e,t,i,n,(function(e){return new _i(e)}));case"condition":case"custom-condition":return this.buildTriggerCondition(e,t,i,n);default:I(o)}}},{key:"buildTriggerCondition",value:function(e,t,i,n){var o;if(this.internalConditions[t.name])return new Pi(e,this.internalConditions[t.name](),i,n,this.logger);var r=this.conditions[t.name];if(!r)return this.logger.error("[CONDITION-FACTORY]: Could not find condition ".concat(t.name,", it will be deemed false")),this.buildAlwaysFalseCondition(e,i,n);var s=new r(null!==(o=t.params)&&void 0!==o?o:{},this.logger);return new Pi(e,s,i,n,this.logger)}},{key:"buildAlwaysFalseCondition",value:function(e,t,i){return new Pi(e,new Ti,t,i,this.logger)}},{key:"buildBooleanCondition",value:function(e,t,i,n,o){var r=this,s=t.subConditions;if(!s||0===s.length)return this.logger.error("[CONDITION-FACTORY]: Boolean condition with no sub-conditions"),this.buildAlwaysFalseCondition(e,i,n);var a=o(s.map((function(t){return r.buildCondition(e,t,i,n)})));return new Pi(e,a,i,n,this.logger)}}])}(),Di="AbsoluteScrollDistance",zi=function(){return o((function e(t){i(this,e),this.params=t,this.name=Di}),[{key:"buildTriggers",value:function(e){return[new Ze(e)]}},{key:"check",value:function(e,t){var i;return t.getWindow().scrollY>=((null===(i=this.params)||void 0===i?void 0:i.pixelsDistance)||0)}}])}(),Li="BreakpointMatch",Ni=function(){function e(t){i(this,e),this.params=t,this.name=Li}return o(e,[{key:"buildTriggers",value:function(e){return[]}},{key:"check",value:function(t,i){var n=i.viewportInfo.getCurrentBreakpoint().name,o=!("gte"in this.params)||e.compareBp(this.params.gte,n,"gte"),r=!("lte"in this.params)||e.compareBp(this.params.lte,n,"lte");return o&&r}}],[{key:"compareBp",value:function(e,t,i){var n=this.BpOrder[e],o=this.BpOrder[t];return"gte"===i?o>=n:o<=n}}])}();Ni.BpOrder={xs:1,s:2,m:3,l:4,xl:5};var Bi=function(){return o((function e(t){i(this,e),this.window=t.api.viewportInfo.browserWindow,this.triggeredCB=t.onTriggeredCB,document.addEventListener("readystatechange",this.triggeredCB)}),[{key:"destroy",value:function(){this.window.removeEventListener("readystatechange",this.triggeredCB)}}])}(),Mi="DocumentStatus",Fi=function(){return o((function e(t){i(this,e),this.params=t,this.name=Mi}),[{key:"buildTriggers",value:function(e){return[new Bi(e)]}},{key:"check",value:function(e,t){return-1!==this.params.state.indexOf(document.readyState)}}])}(),ji=function(){return o((function e(t,n){i(this,e),this.ctx=t,this.intervalMs=n,this.intervalId=setInterval(this.ctx.onTriggeredCB,this.intervalMs)}),[{key:"destroy",value:function(){clearInterval(this.intervalId)}}])}(),Ui=function(e,t,i){if(!i)return t.warn("[WIDGETS] safeQuerySelector selector should be defined"),null;try{return e.querySelector(i)}catch(e){t.error("[WIDGETS] safeQuerySelector error: ".concat(i))}return null},Gi="DomElementExists",Wi=function(){return o((function e(t,n){i(this,e),this.params=t,this.logger=n,this.name=Gi}),[{key:"buildTriggers",value:function(e){return[new ji(e,250)]}},{key:"check",value:function(e,t){return null!==Ui(document,this.logger,this.params.selector)}}])}(),Vi="PageCount",Hi=function(){function e(t){i(this,e),this.params=t,this.name=Vi,this.hasChecked=!1,this.isOver=!1}return o(e,[{key:"buildTriggers",value:function(e){return[]}},{key:"check",value:function(t,i){var n;if(!this.hasChecked){e.incrementPageCount(t,i.getWindow()),this.hasChecked=!0;var o=e.getPageCount(t,i.getWindow());this.isOver=o>=((null===(n=this.params)||void 0===n?void 0:n.pageCount)||1),this.isOver&&e.resetPageCount(t,i.getWindow())}return this.isOver}}],[{key:"getCountKey",value:function(e){return"fuse-page-views-".concat(e)}},{key:"getPageCount",value:function(t,i){return Number(i.sessionStorage.getItem(e.getCountKey(t))||0)}},{key:"incrementPageCount",value:function(t,i){i.sessionStorage.setItem(e.getCountKey(t),"".concat(this.getPageCount(t,i)+1))}},{key:"resetPageCount",value:function(t,i){i.sessionStorage.setItem(e.getCountKey(t),"0")}}])}(),Zi="UrlRegex",qi=function(){return o((function e(t){i(this,e),this.params=t,this.name=Zi}),[{key:"buildTriggers",value:function(e){return[]}},{key:"check",value:function(e,t){var i=t.getWindow().location.toString().match(this.params.regex);return y(i)&&i.length>0}}])}(),Yi="WindowHeightDistance",Ji=function(){return o((function e(t){i(this,e),this.params=t,this.name=Yi}),[{key:"buildTriggers",value:function(e){return[new Ze(e)]}},{key:"check",value:function(e,t){var i,n=t.getWindow();return n.scrollY>=n.innerHeight*((null===(i=this.params)||void 0===i?void 0:i.windowHeightDistance)||0)}}])}(),Qi="WindowValue",Ki=function(){return o((function e(t){i(this,e),this.params=t,this.name=Qi}),[{key:"buildTriggers",value:function(){return[]}},{key:"check",value:function(e,t){return t.viewportInfo.browserWindow[this.params.name]===this.params.value}}])}(),Xi="LocalStorageValue",$i=function(){return o((function e(t){i(this,e),this.params=t,this.name=Xi}),[{key:"buildTriggers",value:function(){return[]}},{key:"check",value:function(e,t){return t.viewportInfo.browserWindow.localStorage.getItem(this.params.name)===this.params.value}}])}(),en="MetaTagProperty",tn=function(){return o((function e(t){i(this,e),this.params=t,this.name=en,this.metaTagKey=t.metaTagKey,this.metaTagValues=t.metaTagValues}),[{key:"buildTriggers",value:function(){return[]}},{key:"check",value:function(e,t){var i=t.viewportInfo.browserWindow.document.querySelector('meta[name="'.concat(this.metaTagKey,'"]'));return!m(i)&&this.metaTagValues.includes(i.getAttribute("content"))}}])}(),nn=function(){return o((function e(t){i(this,e),this.logger=t,this.slotConditionFactory=null,this.insertConditionFactory=null}),[{key:"getSlotConditionFactory",value:function(){var e;return this.slotConditionFactory||(this.slotConditionFactory=new Oi(this.logger),(e=this.slotConditionFactory).registerCondition(Di,zi),e.registerCondition(Li,Ni),e.registerCondition(Gi,Wi),e.registerCondition(qe,Ye),e.registerCondition(Ke,Xe),e.registerCondition(Vi,Hi),e.registerCondition(Zi,qi),e.registerCondition(Yi,Ji),e.registerCondition(Qi,Ki),e.registerCondition(Xi,$i),e.registerCondition(en,tn)),this.slotConditionFactory}},{key:"getInsertConditionFactory",value:function(){var e;return this.insertConditionFactory||(this.insertConditionFactory=new Oi(this.logger),(e=this.insertConditionFactory).registerCondition(Mi,Fi),e.registerCondition(Di,zi),e.registerCondition(Li,Ni),e.registerCondition(Yi,Ji),e.registerCondition(Zi,qi),e.registerCondition(Gi,Wi),e.registerCondition(Vi,Hi),e.registerCondition(Qi,Ki),e.registerCondition(Xi,$i),e.registerCondition(en,tn)),this.insertConditionFactory}}])}();var on=new nn(E.getLogger()),rn=function(){function e(t,n){var o=this;i(this,e),this.logger=t,this.gptDestroySlots=n,this.templateTargetings={},this.slots={},this.destroySlotsFunc=function(e){var t=e.map((function(e){return e.getSlotElementId()}));o.logger.debug("[GPT-REGISTRY]: Calling googletag.destroySlots(".concat(JSON.stringify(t),")")),o.gptDestroySlots(e)}}return o(e,[{key:"add",value:function(t,i){var n=this,o=e.getLCTemplateId(t);Array.isArray(this.slots[o])||(this.slots[o]=[]),this.logger.debug("[GPT-REGISTRY]: Added ".concat(o)),this.slots[o].push(i);var r=this.templateTargetings[o];r?(Object.keys(r).forEach((function(e){i.setTargeting(e,r[e]),n.logger.debug("[GPT-REGISTRY]: Set targeting. zoneTemplateId: ".concat(o,", gpt slot id: ").concat(i.getSlotElementId(),", key: ").concat(e,", value: ").concat(r[e]))})),this.logger.debug("[GPT-REGISTRY]: Applied targeting for ".concat(o," on newly added gpt slot - id: ").concat(i.getSlotElementId()))):this.logger.debug("[GPT-REGISTRY]: No template targeting set for zoneTemplateId: ".concat(o))}},{key:"purgeAll",value:function(){var e=this;Object.keys(this.slots).forEach((function(t){return e.purge(t)}))}},{key:"purge",value:function(t){var i=e.getLCTemplateId(t);this.logger.debug("[GPT REGISTRY]: Purging ".concat(i));var n=this.slots[i];n&&(this.destroySlotsFunc(n),delete this.slots[i],delete this.templateTargetings[i])}},{key:"purgeByElement",value:function(t,i){var n=this.getSlots(t)||[],o=n.find((function(e){return e.getSlotElementId()===i}));o?(this.destroySlotsFunc([o]),this.slots[e.getLCTemplateId(t)]=n.filter((function(e){return e.getSlotElementId()!==i}))):this.logger.debug("[GPT-REGISTRY]: Could could not destroy slot ".concat(i," because it has not been registered with GPT"))}},{key:"getSlotsLength",value:function(){return Object.keys(this.slots).length}},{key:"getSlots",value:function(t){return t&&"string"==typeof t&&Array.isArray(this.slots[e.getLCTemplateId(t)])?this.slots[e.getLCTemplateId(t)]:[]}},{key:"addTemplateTargetings",value:function(t,i,n){var o=e.getLCTemplateId(t);this.templateTargetings[o]||(this.templateTargetings[o]={}),this.templateTargetings[o][i]=n}},{key:"getTemplateTargetings",value:function(t){var i=e.getLCTemplateId(t);return this.templateTargetings[i]||null}},{key:"setSlotTargetingById",value:function(e,t,i){var n=this;this.addTemplateTargetings(e,t,i),this.logger.debug("[GPT-REGISTRY]: Template targeting set. zoneTemplateId: ".concat(e,", key: ").concat(t,", value: ").concat(JSON.stringify(i))),this.getSlots(e).forEach((function(o){try{o.setTargeting(t,i),n.logger.debug("[GPT-REGISTRY]: Applied template targetings. slot id: ".concat(o.getSlotElementId(),", key: ").concat(t,", value: ").concat(JSON.stringify(i)))}catch(t){t instanceof Error?n.logger.error("[GPT-REGISTRY]: Error occurred while individually setTargeting for slot ".concat(e,"."),t.message,t.stack):n.logger.error("[GPT-REGISTRY]: Error of unexpected type occurred while individually setTargeting for slot ".concat(e,"."))}}))}}],[{key:"getLCTemplateId",value:function(e){return e.toLowerCase()}}])}(),sn=new(function(){return o((function e(){i(this,e)}),[{key:"getGptSlotRegistry",value:function(){return this.gptSlotRegistry||(this.gptSlotRegistry=new rn(E.getLogger(),ni)),this.gptSlotRegistry}}])}()),an=function(){return o((function e(t,n,o,r){var s=this;i(this,e),this.logger=t,this.reporter=n,this.events=o,this.componentState=r,this.state={tag_initialised:!1,on_low_dwell_page:!1},this.bidLibrariesCutoffMs=1e3,this.bidLibrariesCutoff=!1,o.onComponentInitEvent.subscribe((function(e){"gpt"!==e.component||"ready"!==e.state._tag||s.bidLibrariesCutoff||setTimeout((function(){s.isAnyBidLibraryReady()||(s.bidLibrariesCutoff=!0,s.logger.info("[FUSE][INIT] Bid libraries cutoff by timeout ".concat(s.bidLibrariesCutoffMs,"ms")),s.checkAndTrigger())}),s.bidLibrariesCutoffMs),s.checkAndTrigger()}))}),[{key:"getInitStatus",value:function(){var e=this.getComponentState("cmp"),t=this.getComponentState("docReadyScan");return{cmpOk:"ready"===e||"disabled"===e,docReady:"ready"==t||"disabled"===t,anyBidLibraryReady:this.isAnyBidLibraryReady()}}},{key:"isReadyForInit",value:function(){var e=this.getInitStatus();return 0===Object.values(e).filter((function(e){return!e})).length}},{key:"checkAndTrigger",value:function(){m(this.firedInitReady)&&this.isReadyForInit()&&(this.reporter.setStateStatus("initmanager_fired_auction_ready"),this.firedInitReady=this.reporter.getElapsedTime(),this.events.onInitManagerReady.emit({eventType:"onInitManagerReady"}))}},{key:"getComponentState",value:function(e){return this.componentState.state[e]._tag}},{key:"isComponentReady",value:function(e){return"ready"===this.getComponentState(e)}},{key:"isAnyBidLibraryReady",value:function(){if("disabled"!==this.getComponentState("yandex"))return this.isComponentReady("yandex");var e=this.getComponentState("prebid"),t=this.getComponentState("uam"),i=["ready","disabled"];return this.bidLibrariesCutoff||i.includes(e)&&i.includes(t)}},{key:"setTagInitialised",value:function(){this.state.tag_initialised=!0}},{key:"isTagInitialised",value:function(){return this.state.tag_initialised}},{key:"setIsLowDwellPage",value:function(e){this.state.on_low_dwell_page=e}},{key:"isLowDwellPage",value:function(){return this.state.on_low_dwell_page}}])}(),un=new(function(){return o((function e(){i(this,e)}),[{key:"getInitManager",value:function(){return this.initManager||(this.initManager=new an(E.getLogger(),Pt.getReporter(),He,Pt.getComponentStatusStore())),this.initManager}}])}()),ln=function(){return o((function e(t,n,o,r){i(this,e),this.maybePBG=t,this.logger=n,this.settings=o,this.safeFramesCompatibilityChecker=r}),[{key:"registerPrebidUnit",value:function(e){this.settings.isForceAuctionBidSizes()?this.registerPrebidUnitWithForcedBidSizes(e):this.registerPrebidUnitWithSlotBidSizes(e)}},{key:"registerPrebidUnitWithSlotBidSizes",value:function(e){var t=this.getPrebidUnitConfig(e,this.prepareMediaBids(e),e.sizesHb);this.logger.debug("[PREBID][".concat(e.slotDivId,"]: Registered with mediaTypes: ").concat(JSON.stringify(t.mediaTypes))),this.maybePBG.addAdUnits(t)}},{key:"registerPrebidUnitWithForcedBidSizes",value:function(e){var t=this;this.logger.debug("[PREBID][".concat(e.slotDivId,"]: Registering with forced bid sizes")),this.prepareMediaBids(e).forEach((function(i){var n,o=(null===(n=i.bidSizes)||void 0===n?void 0:n.length)?i.bidSizes.map((function(e){return J(e)})).filter((function(t){return 2===t.length&&t[0]&&t[1]&&e.sizesHb.some((function(e){return e[0]===t[0]&&e[1]===t[1]}))})):e.sizesHb,r=t.getPrebidUnitConfig(e,[i],o);t.logger.debug("[PREBID][".concat(e.slotDivId,"]: Registered ").concat(i.bidder," with mediaTypes: ").concat(JSON.stringify(r.mediaTypes))),t.maybePBG.addAdUnits(r)}))}},{key:"getPrebidUnitConfig",value:function(e,t,i){var n,o;return{code:e.slotDivId,mediaTypes:Object.assign(Object.assign(Object.assign({},this.settings.isPrebidBannerEnabled()&&this.getBannerTypeConfig(i)),this.settings.isPrebidNativeEnabled()&&(null===(n=e.mediaTypes)||void 0===n?void 0:n.includes("native"))&&this.getNativeTypeConfig(e)),this.settings.isPrebidVideoEnabled()&&(null===(o=e.mediaTypes)||void 0===o?void 0:o.includes("video"))&&this.getVideoTypeConfig(e)),bids:t}}},{key:"getBannerTypeConfig",value:function(e){return{banner:{sizes:e}}}},{key:"getNativeTypeConfig",value:function(e){return{native:{sendTargetingKeys:!1}}}},{key:"getVideoTypeConfig",value:function(e){return{video:Object.assign(Object.assign({},{context:"outstream",playerSize:[640,480],mimes:["video/mp4"],protocols:[2,3,4],playbackmethod:[2],maxduration:30,minduration:6,skip:1,linearity:2,api:[2]}),e.videoAttributes)}}},{key:"prepareMediaBids",value:function(e){var t,i=this,n=this.settings.isForceSafeFrames();n&&this.logger.debug("[PREBID][".concat(e.slotDivId,"]: Safe Frames compatibility filter is enabled"));var o=e.sizesHb.map((function(e){return Y(e)})),r=e.zoneTemplate.bids.filter((function(e){var t=e.bidSizes;return!(t&&t.length>0)||function(e,t){for(var i=[],n=new Set(t),o=0,r=e.length;o<r;++o)n.has(e[o])&&i.push(e[o]);return i}(o,t).length>0})).filter((function(t){var o;if(!n)return!0;var r=i.settings.isForceAuctionBidSizes()&&(null===(o=t.bidSizes)||void 0===o?void 0:o.length)?t.bidSizes.map((function(e){return J(e)})):e.sizesHb,s=i.safeFramesCompatibilityChecker.isCompatible(t,r,e.breakpoint);return s||i.logger.debug("[PREBID][".concat(e.slotDivId,"]: Bidder ").concat(t.bidder," is not compatible with Safe Frames, excluding from the slot")),s}));if(this.settings.isPrebidVideoEnabled()&&(null===(t=e.mediaTypes)||void 0===t?void 0:t.includes("video"))){var s={w:640,h:480,context:"outstream",language:"en",mimes:["video/mp4"]};return r.map((function(e){return Object.assign(Object.assign({},e),{params:Object.assign(Object.assign(Object.assign({},s),e.params),"pubmatic"===e.bidder&&{outstreamAU:"renderer_test_pubmatic"})})}))}return r}}])}(),cn=function(){return o((function e(){i(this,e),this.compatibleBidders=["ix","pubmatic","rubicon","connectad","33across","amx","stroeerCore","nobid","oms","seedtag","optidigital","vidazoo"]}),[{key:"isCompatible",value:function(e,t,i){return"triplelift"===e.bidder?this.isTripleliftCompatible(e,t,i):!!this.compatibleBidders.includes(e.bidder)}},{key:"isTripleliftCompatible",value:function(e,t,i){return!e.params.inventoryCode||!/^.+_\d+x\d+$/.test(e.params.inventoryCode)||(!(!this.isMobileBreakpoint(i)||!this.containsSizes(t,[[300,250]]))||this.containsSizes(t,[[970,250],[300,600]]))}},{key:"containsSizes",value:function(e,t){var i=e.filter((function(e){return!t.some((function(t){var i=c(t,2),n=i[0],o=i[1];return n===e[0]&&o===e[1]}))}));return 0===i.length}},{key:"isMobileBreakpoint",value:function(e){return"xs"===e||"s"===e}}])}(),dn=function(){return o((function e(){i(this,e)}),[{key:"getPrebidGlobal",value:function(){var e=E.getBrowserWindowObject();return e.fusePbjs||(e.fusePbjs={que:[]}),e.fusePbjs}},{key:"getPrebidSafeFramesCompatibilityChecker",value:function(){return this.prebidSafeFramesCompatibilityChecker||(this.prebidSafeFramesCompatibilityChecker=new cn),this.prebidSafeFramesCompatibilityChecker}},{key:"getPrebidSlotRegistrator",value:function(){return this.prebidSlotRegistrator||(this.prebidSlotRegistrator=new ln(this.getPrebidGlobal(),E.getLogger(),kt.getSettings(),this.getPrebidSafeFramesCompatibilityChecker())),this.prebidSlotRegistrator}}])}(),gn=new dn,hn=function(){return o((function e(){i(this,e)}),[{key:"code",value:function(){return"1---"}}])}(),fn=function(){return o((function e(t,n,o,r,s,a,u){i(this,e),this.pubId=t,this.adServer=n,this.logger=o,this.browserWindow=r,this.reporter=s,this.gptPushFn=a,this.sco=u}),[{key:"loadAmazonUam",value:function(e,t,i,n,o,r){if(!t[e]){t[e]={init:function(){u("i",arguments)},fetchBids:function(){u("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};var s=i.createElement(n);s.async=!0,s.src=o,"function"==typeof r&&(s.readyState?s.onreadystatechange=function(){"loaded"!==s.readyState&&"complete"!==s.readyState||(s.onreadystatechange=null,r())}:s.onload=function(){r()});var a=i.getElementsByTagName(n)[0];a.parentNode.insertBefore(s,a)}function u(i,n){t[e]._Q.push([i,n])}}},{key:"load",value:function(e,t){var i=this;if(this.logger.debug("[UAM]: Loading script"),this.reporter.setStateStatus("uam_script_load_start"),this.loadAmazonUam("apstag",this.browserWindow,this.browserWindow.document,"script","//c.amazon-adsystem.com/aax2/apstag.js",(function(){i.reporter.setStateStatus("uam_script_load_finish"),i.init(e,t)})),!this.browserWindow.apstag)return this.logger.error("[INIT]: UAM script load failed.")}},{key:"init",value:function(e,t){var i=this;this.reporter.setStateStatus("uam_initialise_start"),this.browserWindow.apstag.init(this.getUamConfig(e),(function(){i.logger.info("[UAM]: Initialisation finished"),i.reporter.setStateStatus("uam_initialise_finish"),t()}))}},{key:"getUamConfig",value:function(e){var t={};return e||(t.gdpr={cmpTimeout:0}),!m(this.sco)&&Object.getOwnPropertyNames(this.sco).length&&(t.schain={ver:"1.0",complete:1,nodes:[{asi:this.sco.asi,sid:this.sco.sellerId,hp:1}]}),Object.assign({pubID:this.pubId,adServer:this.adServer},t)}},{key:"makeBids",value:function(e,t){var i=this,n=e.hbPlan.uamPlan.slots.map((function(e){return{slotID:e.slotDivId,slotName:e.path,sizes:e.sizesHb}}));this.logger.debug("[AUCTION][".concat(e.auctionId,"]: Sending UAM request with slot details: ").concat(JSON.stringify(n))),this.browserWindow.apstag.fetchBids({slots:n},(function(e){i.gptPushFn((function(){i.browserWindow.apstag.setDisplayBids(),t(e)}))}))}}])}();var pn,vn,bn=function(){return o((function e(){i(this,e)}),[{key:"getCcpaPrivacyStringCoder",value:function(){return new hn}},{key:"getUamAdServer",value:function(){return"googletag"}},{key:"getUam",value:function(){if(!this.uam){var e=kt.getSettings();this.uam=new fn(e.getUamSettings().pubID,mn.getUamAdServer(),E.getLogger(),E.getBrowserWindowObject(),Pt.getReporter(),qt,e.getSco())}return this.uam}}])}(),mn=new bn;function Sn(e){var t,i=yn(e),n=function(e){var t,i,n,o;return null!==(o=null===(n=null===(i=null===(t=null==e?void 0:e.hbPlan)||void 0===t?void 0:t.uamPlan)||void 0===i?void 0:i.slots)||void 0===n?void 0:n.map((function(e){return e.slotDivId})))&&void 0!==o?o:[]}(e);return t=n,d(new Set([].concat(d(i),d(t))))}function yn(e){var t,i,n,o;return null!==(o=null===(n=null===(i=null===(t=null==e?void 0:e.hbPlan)||void 0===t?void 0:t.prebidPlan)||void 0===i?void 0:i.slots)||void 0===n?void 0:n.map((function(e){return e.slotDivId})))&&void 0!==o?o:[]}!function(e){e.GPT_REQUEST="GPT_REQUEST",e.GPT_RESPONSE="GPT_RESPONSE",e.GPT_RENDERED="GPT_RENDERED",e.GPT_LOADED="GPT_LOADED",e.CANCELLED="CANCELLED",e.SUPERSEDED="SUPERSEDED"}(pn||(pn={})),function(e){e[e.PREBID_REQUEST=0]="PREBID_REQUEST",e[e.PREBID_RESPONSE=1]="PREBID_RESPONSE",e[e.PREBID_SKIPPED=2]="PREBID_SKIPPED",e[e.UAM_REQUEST=3]="UAM_REQUEST",e[e.UAM_RESPONSE=4]="UAM_RESPONSE",e[e.UAM_SKIPPED=5]="UAM_SKIPPED",e[e.GPT_REQUEST=6]="GPT_REQUEST",e[e.CANCELLED=7]="CANCELLED"}(vn||(vn={}));var kn=function(){return o((function e(t,n){i(this,e),this.logger=t,this.reporter=n,this.auctions={},this.activeGptCalls={}}),[{key:"createNewAuction",value:function(e,t,i){var n,o,s,a;this.auctions[e.auctionId]={started:this.reporter.getElapsedTime(),creativeDivIds:(s=e,a="slotDivId",s.slots.map((function(e){return e[a]}))),hbDivIds:Sn(e),uamIncluded:y(null===(n=e.hbPlan)||void 0===n?void 0:n.uamPlan),uamResponded:!1,uamSkipped:!1,prebidIncluded:y(null===(o=e.hbPlan)||void 0===o?void 0:o.prebidPlan),prebidResponded:!1,prebidSkipped:!1,uamCancelled:!1,prebidCancelled:!1,gptRequestSent:!1,auctionPhaseCallback:t,slotStatus:e.slots.reduce((function(e,t){return Object.assign(Object.assign({},e),r({},t.slotDivId,{slotPhaseCallback:function(e){return i(t,e)}}))}),{})}}},{key:"getAuctionStatus",value:function(e){return this.auctions[e]}},{key:"getActiveGptCalls",value:function(){return Object.keys(this.activeGptCalls)}},{key:"getSlotStatus",value:function(e,t){return this.auctions[e].slotStatus[t]}},{key:"getSlotStatusInferredAuction",value:function(e,t){var i=this.activeGptCalls[e];if(i)return this.auctions[i].slotStatus[e];this.logger.debug("[AUCTION-STATUS][".concat(t,"]: Could not find active GPT call for ").concat(e))}},{key:"onPrebidRequest",value:function(e){var t=this.auctions[e];t.prebidRequestTime=this.reporter.getElapsedTime(),t.auctionPhaseCallback(vn.PREBID_REQUEST)}},{key:"onPrebidResponse",value:function(e){var t=this.auctions[e];t.prebidResponseTime=this.reporter.getElapsedTime(),t.prebidResponded=!0,t.auctionPhaseCallback(vn.PREBID_RESPONSE)}},{key:"onPrebidSkipped",value:function(e){var t=this.auctions[e];t.prebidSkipped=!0,t.auctionPhaseCallback(vn.PREBID_SKIPPED)}},{key:"onUamRequest",value:function(e){var t=this.auctions[e];t.uamRequestTime=this.reporter.getElapsedTime(),t.auctionPhaseCallback(vn.UAM_REQUEST)}},{key:"onUamSkipped",value:function(e){var t=this.auctions[e];t.uamSkipped=!0,t.auctionPhaseCallback(vn.UAM_SKIPPED)}},{key:"onUamResponse",value:function(e){var t=this.auctions[e];t.uamResponseTime=this.reporter.getElapsedTime(),t.uamResponded=!0,t.auctionPhaseCallback(vn.UAM_RESPONSE)}},{key:"cancelAuction",value:function(e){var t=this.auctions[e];t.cancelled=this.reporter.getElapsedTime(),t.auctionPhaseCallback(vn.CANCELLED)}},{key:"removeFromGptActive",value:function(e){var t=this.activeGptCalls[e];t?(this.logger.debug("[AUCTION][".concat(t,"]: Removed ").concat(e," from GPT active list")),delete this.activeGptCalls[e]):this.logger.debug("[AUCTION]: Could not find ".concat(e," in the GPT active list"))}},{key:"onGptRequest",value:function(e,t){var i=this;t.forEach((function(t){var n=t.slotDivId,o=i.getSlotStatus(e,n);if(o){o.gptRequestTime=i.reporter.getElapsedTime(),o.slotPhaseCallback(pn.GPT_REQUEST);var r=i.activeGptCalls[n];r&&(i.logger.warn("[AUCTION][".concat(e,"]: ").concat(n," is part of an uncompleted auction: ").concat(r," and is marked superseded")),i.auctions[r].slotStatus[n].supersededTime=i.reporter.getElapsedTime(),i.auctions[r].slotStatus[n].slotPhaseCallback(pn.SUPERSEDED)),i.activeGptCalls[n]=e}})),this.auctions[e].gptRequestSent=!0,this.auctions[e].auctionPhaseCallback(vn.GPT_REQUEST)}},{key:"onGptResponse",value:function(e){var t=this.getSlotStatusInferredAuction(e,pn.GPT_RESPONSE);t&&(t.gptResponseTime=this.reporter.getElapsedTime(),t.slotPhaseCallback(pn.GPT_RESPONSE))}},{key:"onGptSlotRendered",value:function(e,t){var i=this.getSlotStatusInferredAuction(e,pn.GPT_RENDERED);i&&(i.gptOnRenderTime=this.reporter.getElapsedTime(),t||this.removeFromGptActive(e),i.slotPhaseCallback(pn.GPT_RENDERED))}},{key:"onGptSlotLoaded",value:function(e){var t=this.getSlotStatusInferredAuction(e,pn.GPT_LOADED);t&&(t.gptOnLoadTime=this.reporter.getElapsedTime(),this.removeFromGptActive(e),t.slotPhaseCallback(pn.GPT_LOADED))}},{key:"cancelSlotAuction",value:function(e,t,i){this.logger.info("[AUCTION][".concat(e,"]: Cancelled auction for ").concat(t," because ").concat(i));var n=this.getSlotStatus(e,t);n&&(n.cancelledTime=this.reporter.getElapsedTime(),this.removeFromGptActive(t),n.slotPhaseCallback(pn.CANCELLED))}},{key:"getAuctions",value:function(){return this.auctions}}])}(),In=function(){return o((function e(t,n,o,r,s,a,u,l,c,d){var g=this;i(this,e),this.fuseSlotRegistry=t,this.prebidGlobal=n,this.uam=o,this.logger=r,this.reporter=s,this.settings=a,this.events=u,this.touchObserver=l,this.callGpt=c,this.telemetry=d,this.firstPrebidRequest=!1,this.firstUamRequest=!1,this.firstPrebidResponse=!1,this.firstUamResponse=!1,this.auctionState=new kn(r,s),this.events.onSlotLoaded.subscribe((function(e){g.reportOnLoadEvent(e)})),this.events.onSlotResponse.subscribe((function(e){g.reportSlotResponseReceived(e)})),this.events.onSlotRender.subscribe((function(e){g.reportOnRenderEndedEvent(e)})),d&&(this.events.onPrebidAuctionEnd.subscribe((function(e){var t;d.recordPrebidAuctionEnd(e,null!==(t=n.version)&&void 0!==t?t:"unknown",g.fuseSlotRegistry)})),this.events.onPrebidAdRenderFailed.subscribe((function(e){d.recordPrebidAdRenderFailed(e)})),this.events.onPrebidAdRenderSucceeded.subscribe((function(e){d.recordPrebidAdRenderSucceeded(e)})))}),[{key:"sendGptRequest",value:function(e){var t=this,i=e.auctionId,n=this.fuseSlotRegistry.excludeDeleted(e.slots,(function(e){t.auctionState.cancelSlotAuction(i,e,"slot DOM element was deleted")})),o=this.settings.isAbandonLazyAuctionEnabled()?function(e,t,i,n,o){return t.filter((function(t){var r=i(t.slotDivId)&&n(t.slotDivId);return e.debug("[AUCTION]: Slot ".concat(t.slotDivId," is lazy: ").concat(i(t.slotDivId)," and above viewport: ").concat(n(t.slotDivId))),r&&(e.debug("[AUCTION]: Slot ".concat(t.slotDivId," is lazy and above viewport, excluding")),o(t.slotDivId)),!r}))}(this.logger,n,this.fuseSlotRegistry.isLazy.bind(this.fuseSlotRegistry),this.fuseSlotRegistry.isAboveViewport.bind(this.fuseSlotRegistry),(function(e){t.auctionState.cancelSlotAuction(i,e,"slot DOM element aboveViewport")})):n;if(!k(o))return this.logger.log("[AUCTION][".concat(i,"]: No slots to request, cancelling auction")),void this.auctionState.cancelAuction(i);this.auctionState.onGptRequest(i,o),this.fuseSlotRegistry.clearFuseSkins(),this.touchObserver.waitForTouchEnd((function(){t.logger.debug("Touch has ended, refreshing ads"),t.callGpt(i,o)}))}},{key:"handleHBResponse",value:function(e,t,i){var n=e.auctionId,o=this.auctionState.getAuctionStatus(n);if(o.gptRequestSent)t&&this.logger.warn("[AUCTION][".concat(n,"]: Received ").concat(t," response after adserver request already sent"));else{var r=o.prebidIncluded,s=o.uamIncluded;if(i){var a=s?o.uamResponded:"excluded",u=r?o.prebidResponded:"excluded";this.logger.warn("[AUCTION][".concat(n,"]: Timeout reached with missing responses, sending to GPT. Uam responded=").concat(a,", Prebid responded=").concat(u)),this.sendGptRequest(e)}else s&&r?(o.uamResponded||o.uamCancelled)&&(o.prebidResponded||o.prebidCancelled)?(this.logger.info("[AUCTION][".concat(n,"]: All necessary responses received, sending to GPT")),this.sendGptRequest(e)):this.logger.debug("[AUCTION][".concat(n,"]: Got response from ").concat(t,", waiting for other responses")):(this.logger.debug("[AUCTION][".concat(n,"]: ").concat(t," complete, calling GPT")),this.sendGptRequest(e))}}},{key:"setHbAuctionTimeout",value:function(e){var t=this;this.logger.debug("[AUCTION][".concat(e.auctionId,"]: Set auction failure timeout of ").concat(e.hbPlan.cancelTimeout,"ms")),setTimeout((function(){return t.handleHBResponse(e,void 0,!0)}),e.hbPlan.cancelTimeout)}},{key:"startUamAuction",value:function(e){var t=this,i=e.auctionId,n=e.hbPlan.uamPlan.slots,o=JSON.stringify(n.map((function(e){return e.slotDivId})));this.logger.info("[AUCTION][".concat(e.auctionId,"]: Sending UAM request for ").concat(o)),this.reporter.addAdEvent("uam_request_".concat(o),{auctionId:i}),this.firstUamRequest||(this.firstUamRequest=!0,this.reporter.setStateStatus("first_uam_request")),this.uam.makeBids(e,(function(n){t.logger.info("[AUCTION][".concat(i,"]: Received UAM response")),t.logger.debug("[AUCTION][".concat(i,"]: UAM response details: "),JSON.stringify(n)),t.reporter.addAdEvent("uam_response_".concat(o),{auctionId:i}),t.firstUamResponse||(t.firstUamResponse=!0,t.reporter.setStateStatus("first_uam_response")),t.auctionState.onUamResponse(i),t.handleHBResponse(e,"uam",!1)}))}},{key:"startGptOnlyAuction",value:function(e){this.logger.debug("[AUCTION][".concat(e.auctionId,"]: Starting GPT-only auction")),this.sendGptRequest(e)}},{key:"executeAuction",value:function(e,t,i){this.events.onAuctionEvent.emit(Object.assign({auctionEventType:"started"},e)),this.auctionState.createNewAuction(e,t,i),this.logger.log("[AUCTION][".concat(e.auctionId,"]: Running with plan: ").concat(function(e){return JSON.stringify({auctionId:e.auctionId,hbSettings:!!e.hbPlan&&{cancelTimeout:e.hbPlan.cancelTimeout,usePrebid:!!e.hbPlan.prebidPlan&&{timeout:e.hbPlan.prebidPlan.timeout,slots:e.hbPlan.prebidPlan.slots.map((function(e){return e.slotDivId}))},useUam:!!e.hbPlan.uamPlan&&{slots:e.hbPlan.uamPlan.slots.map((function(e){return e.slotDivId}))}},gptSlots:e.slots.map((function(e){return e.slotDivId})),gpids:e.slots.map((function(e){return e.gpid})),breakpointName:e.breakpointName})}(e))),this.settings.isYandexEnabled()?this.executeYandexAuction(e):!function(e){return void 0!==e.hbPlan}(e)?this.startGptOnlyAuction(e):this.executeHbAuction(e)}},{key:"executeYandexAuction",value:function(e){var t=this,i=e.auctionId,n=this.settings.getYandexBlockId();n?(this.logger.log("[AUCTION][".concat(i,"]: Run Yandex with blockId ").concat(n)),window.yaContextCb.push((function(){e.slots.forEach((function(e){var o=e.slotDivId,r=e.zoneTemplateId,s=Number(r.substring(7)+o.substring(o.lastIndexOf("-")+1));t.logger.log("[AUCTION][".concat(i,"][").concat(o,"]: Set pageNumber ").concat(s)),Ya.Context.AdvManager.render({renderTo:"".concat(o),blockId:n,pageNumber:s,onRender:function(){t.reporter.setStateStatus("yandex_unit_rendered")}})}))}))):this.logger.error("[AUCTION][".concat(i,"]: Cannot run Yandex cause yandexBlockId is not set"))}},{key:"executeHbAuction",value:function(e){var t=e.auctionId,i=function(e){var t;return y(null===(t=null==e?void 0:e.hbPlan)||void 0===t?void 0:t.prebidPlan)}(e);i&&this.startPrebidAuction(e);var n=function(e){var t;return y(null===(t=null==e?void 0:e.hbPlan)||void 0===t?void 0:t.uamPlan)}(e);n&&this.startUamAuction(e);var o=i&&!this.auctionState.getAuctionStatus(t).prebidCancelled,r=n&&!this.auctionState.getAuctionStatus(t).uamCancelled;o||r?(this.reporter.reportHbAuctionStart(),this.setHbAuctionTimeout(e)):this.startGptOnlyAuction(e)}},{key:"reportOnLoadEvent",value:function(e){var t=e.slot.getSlotElementId();this.auctionState.onGptSlotLoaded(t)}},{key:"reportSlotResponseReceived",value:function(e){var t=e.slot.getSlotElementId();this.auctionState.onGptResponse(t)}},{key:"reportOnRenderEndedEvent",value:function(e){var t,i=!e.isEmpty,n=e.slot.getSlotElementId();this.logger.debug("[AUCTION]: ".concat(n," render event details: ").concat(JSON.stringify(e)));var o=this.fuseSlotRegistry.getSlot(n);if(o){if(i)this.logger.info("[AUCTION]: Adserver responded with creative for ".concat(n));else{var r={fuseSlotId:o.zoneTemplate.id,fuseSlotCode:n,errorType:"MISSING_CREATIVE"};this.reporter.addSlotProblem(r),this.logger.warn("[AUCTION]: Adserver responded without creative for ".concat(n))}if(this.telemetry&&o.sizes){var s=Q(o.sizes.filter((function(e){return ht(e)}))),a=Array.isArray(e.size)?e.size:null;2===(null==a?void 0:a.length)&&(a[1]>s[0]||a[1]>s[1])&&(K(a[0],s[0])>50||K(a[1],s[1])>50)&&(this.logger.debug("[AUCTION][".concat(n,"]: Received a rogue bid ").concat(a,"  with mismatch maxArea ").concat(s," from adx: ").concat(JSON.stringify(e))),null===(t=this.telemetry)||void 0===t||t.recordRogueAdxResponse(n,e,s))}this.auctionState.onGptSlotRendered(n,i)}else this.fuseSlotRegistry.isDeletedSlot(n)?(this.logger.info("[AUCTION]: Slot Render Ended Event fired for deleted unit ".concat(n)),this.auctionState.onGptSlotRendered(n,i)):this.logger.debug("[AUCTION]: SlotRenderEnded Event fired for non fuse units: ".concat(n,". HasCreative: ").concat(i))}},{key:"getStateView",value:function(){return this.auctionState}},{key:"startPrebidAuction",value:function(e){var t=this,i=yn(e),n=e.auctionId;this.reporter.addAdEvent("prebid_request_".concat(JSON.stringify(i)),{auctionId:n}),this.logger.info("[AUCTION][".concat(n,"]: Requesting prebid for: ").concat(JSON.stringify(i))),this.firstPrebidRequest||(this.firstPrebidRequest=!0,this.reporter.setStateStatus("first_prebid_request"));var o=this.prebidGlobal;o.requestBids({auctionId:n,adUnitCodes:i,timeout:e.hbPlan.prebidPlan.timeout,bidsBackHandler:function(r,s){var a;t.auctionState.onPrebidResponse(n);var u=Object.keys(r);if(t.logger.info("[AUCTION][".concat(n,"]: Prebid auction complete. Any-bidder-timeout?=").concat(s,". Responding slots: ").concat(JSON.stringify(u))),u.length>0){if(t.logger.debug("[AUCTION][".concat(n,"]: Prebid response details: ").concat(JSON.stringify(r))),t.telemetry){var l=function(e){var i=t.fuseSlotRegistry.getSlot(e);if(null===(a=null==i?void 0:i.sizesHb)||void 0===a?void 0:a.length){var o=Q(i.sizesHb);r[e].bids.forEach((function(i){var r;(i.width>o[0]||i.height>o[1])&&(t.logger.debug("[AUCTION][".concat(n,"][").concat(e,"]: Received a rogue bid ").concat(i.width,"x").concat(i.height,"  with mismatch maxArea ").concat(o," from ").concat(i.bidder,": ").concat(JSON.stringify(i))),null===(r=t.telemetry)||void 0===r||r.recordRogueBidderResponse(e,i,o))}))}};for(var c in r)l(c)}}else t.logger.warn("[AUCTION][".concat(n,"]: No bid responses received from prebid"));t.reporter.addAdEvent("prebid_response_".concat(JSON.stringify(u)),{auctionId:n}),t.firstPrebidResponse||(t.firstPrebidResponse=!0,t.reporter.setStateStatus("first_prebid_response"));try{o.setTargetingForGPTAsync(i),t.handleHBResponse(e,"prebid",!1)}catch(e){var d=Ri(e);t.logger.error("[AUCTION][".concat(n,"]: ").concat(d.message," ").concat(d.stack))}}})}}])}();var wn=function(){return o((function e(t,n,o,r,s){i(this,e),this.logger=t,this.settings=n,this.viewportInfo=o,this.isLowDwellPage=r,this.componentStateStore=s,this.auctionCounter=0}),[{key:"plan",value:function(e,t){this.logger.debug("[PLANNER]: Planning auction with ".concat(e.map((function(e){return e.slotDivId})).join(", ")));var i="".concat(++this.auctionCounter),n=this.sortSlotsByViewport(i,e),o=t.maxViewports?function(e,t){var i=e.filter((function(e){return e.zoneDiv.getBoundingClientRect().top<t}));return k(i)?i:e}(n,this.getMaxOffset(t.maxViewports)):n,r=this.settings.getAuctionMaxSlots(),s=o.slice(0,r),a=this.getHbPlan(i,s,t);return{auctionId:i,breakpointName:this.viewportInfo.getCurrentBreakpoint().name,hbPlan:a,slots:s}}},{key:"getHbPlan",value:function(e,t,i){var n=t.filter((function(e){return e.allowHeaderBidding}));if(k(n))if(this.isLowDwellPage())this.logger.debug("[AUCTION][".concat(e,"]: Low dwell page detected, skipping headerbidding"));else{var o=this.viewportInfo.getCurrentBreakpoint().name,r=this.settings.isUamEnabledAtBP(o),s=this.getPrebidPlan(e,o,n,i.isRefresh),a=this.getUamPlan(r,e,n);if(y(s)||y(a)){var u=a?1e3:0,l=s?s.timeout+250:0;return{cancelTimeout:Math.max(u,l),prebidPlan:s,uamPlan:a}}this.logger.debug("[AUCTION][".concat(e,"]: No uam or prebid plan for this auction"))}else this.logger.debug("[AUCTION][".concat(e,"]: No headerbidding slots enabled for this auction"))}},{key:"sortSlotsByViewport",value:function(e,t){var i=t.sort((function(e,t){var i=e.zoneDiv.getBoundingClientRect(),n=t.zoneDiv.getBoundingClientRect();return i.top-n.top})),n=i.map((function(e){return e.slotDivId}));return this.logger.debug("[PLANNER][".concat(e,"]: Slot priority order: ").concat(JSON.stringify(n))),i}},{key:"getMaxOffset",value:function(e){var t=this.viewportInfo.getViewportStatus(),i=t.offset,n=t.innerHeight;return i.y+n+n*e}},{key:"getUamPlan",value:function(e,t,i){var n="ready"===this.componentStateStore.state.uam._tag;if(e)if(n)if(0!==i.length){if(!this.settings.isForceSafeFrames())return{slots:i};this.logger.info("[AUCTION][".concat(t,"]: UAM disabled due to forceSafeFrames"))}else this.logger.debug("[AUCTION][".concat(t,"]: UAM has been excluded from the auction because no headerbidding slots are enabled"));else this.logger.info("[AUCTION][".concat(t,"]: UAM has not finished loading and will be excluded from the auction"));else this.logger.debug("[AUCTION][".concat(t,"]: UAM has been excluded from the auction because it is not configured"))}},{key:"getPrebidPlan",value:function(e,t,i,n){var o="ready"===this.componentStateStore.state.prebid._tag,r=this.settings.getHbTimeout(t,!0===n);if(this.settings.isPrebidEnabledAtBP(t)){if(o)return{timeout:r,slots:i};this.logger.info("[AUCTION][".concat(e,"]: Prebid has not finished loading and will be excluded from the auction"))}else this.logger.debug("[AUCTION][".concat(e,"]: Excluded prebid from the auction because it is not configure"))}}])}();var En=function(){return o((function e(t,n,o,r,s,a,u,l,c){i(this,e),this.logger=t,this.executeAuction=n,this.planAuction=o,this.isDeletedSlot=r,this.getCurrentBreakpointName=s,this.viewportInfo=a,this.settings=u,this.setTargeting=l,this.activeSlots=c,this.queuedSlots=[],this.triggeredAuctions={},this.auctionBlockSlots=[],this.auctionBlockTimeoutHandle=null,this.auctionBlockTriggered=null,this.anyAuctionExecuted=!1}),[{key:"triggerAuction",value:function(e){this.queueSlots([e]),this.runAuction(!0)}},{key:"queueSlots",value:function(e){var t=this,i=this.getCurrentBreakpointName(),n=e.filter((function(e){return t.settings.isSlotEnabledForBreakpoint(e.zoneTemplate,i)?e.currentlyActive?e.zoneTemplate.attributes.afs?(t.logger.info("[SCHEDULER]: Skipped ".concat(e.slotDivId," because it is AFS slot")),!1):!t.isScheduled(e)||(t.logger.debug("[SCHEDULER]: Skipped ".concat(e.slotDivId," because it is already scheduled")),!1):(t.logger.info("[SCHEDULER]: Skipped ".concat(e.slotDivId," because it is hasn't activated")),!1):(t.logger.debug("[SCHEDULER]: Skipped ".concat(e.slotDivId," because no sizes mapped at the current breakpoint (").concat(i,")")),!1)}));if(n.length>0){var o=n.map((function(e){return e.slotDivId}));this.logger.info("[SCHEDULER]: Added ".concat(o," to auction queue")),n.forEach((function(e){return t.queuedSlots.push(e)}))}}},{key:"isScheduled",value:function(e){return this.queuedSlots.filter((function(t){return t.slotDivId===e.slotDivId})).length>0}},{key:"hasZoneTemplateId",value:function(e,t){return(e.zoneTemplate.originalZoneTemplateId||e.zoneTemplate.id)===t}},{key:"isTemplateScheduled",value:function(e){var t=this;return void 0!==this.queuedSlots.find((function(i){return t.hasZoneTemplateId(i,e)}))}},{key:"purgeDeletedFromQueue",value:function(){var e=this;this.queuedSlots=this.queuedSlots.filter((function(t){return!e.isDeletedSlot(t.slotDivId)||(e.logger.info("[SCHEDULER]: Removed deleted slot ".concat(t.slotDivId," from queue")),!1)}))}},{key:"runAuction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.purgeDeletedFromQueue();var t=this.queuedSlots;if(!k(t))return this.logger.log("[SCHEDULER]: Auction will not run because no slots are queued"),[];var i=this.getMissingAuctionBlockSlots();if(i.length>0){if(this.auctionBlockTimeoutHandle){var n=this.queuedSlots.map((function(e){return e.slotDivId}));return this.logger.info("[SCHEDULER] Deferred the auction for ".concat(JSON.stringify(n)," because slots missing from the auction block: ").concat(JSON.stringify(i))),this.auctionBlockTriggered=!0,[]}}else this.auctionBlockTimeoutHandle&&(this.logger.info("[SCHEDULER]: Auction block cleared, as requirements satisfied "),this.clearAuctionBlock());var o=this.planAuction(t,{maxViewports:this.getAuctionMaxViewports(),isRefresh:e});if(!this.isAnyAuctionExecuted()){var r=this.viewportInfo.getViewportStatus(),s=r.offset.y+r.innerHeight,a=this.queuedSlots.filter((function(e){return e.zoneDiv.getBoundingClientRect().top<s}));this.setTargeting("zone_count_above_vp",a.length.toString())}return this.queuedSlots=this.queuedSlots.filter((function(e){return-1===o.slots.indexOf(e)})),this.logger.log("[SCHEDULER]: Starting auction with ".concat(o.slots.length," slots, ").concat(this.queuedSlots.length," slots remaining")),this.startAuction(o),o.slots.map((function(e){return e.slotDivId}))}},{key:"forceRunAuction",value:function(e){var t=this.planAuction([e],{isRefresh:!1});this.logger.log("[SCHEDULER][".concat(t.auctionId,"]: Forcing auction for ").concat(e.slotDivId)),this.startAuction(t)}},{key:"getAuctionMaxViewports",value:function(){return this.isAnyAuctionExecuted()?void 0:this.settings.getMaxViewportsFirstAuction()}},{key:"handleOnSlotOutcome",value:function(e,t){t!==pn.GPT_LOADED||this.triggeredAuctions[e]||(this.triggeredAuctions[e]=!0,this.queuedSlots.length>0&&(this.logger.debug("[SCHEDULER][".concat(e,"]: The first slot has received a gpt-loaded event, initiating the next auction")),this.runAuction()))}},{key:"startAuction",value:function(e){var t=this;this.anyAuctionExecuted=!0,this.executeAuction(e,(function(i){i===vn.CANCELLED&&t.queuedSlots.length>0&&(t.logger.debug("[SCHEDULER][".concat(e.auctionId,"]: The auction was cancelled, initiating the next auction")),t.runAuction())}),(function(i,n){return t.handleOnSlotOutcome(e.auctionId,n)}))}},{key:"reset",value:function(){this.clearAuctionBlock(),this.queuedSlots=[]}},{key:"clearPendingAuctions",value:function(){this.queuedSlots=[]}},{key:"setAuctionBlock",value:function(e,t){var i=this;this.auctionBlockSlots=e.filter((function(e){var t=i.settings.getZoneTemplate(e);if(!t)return i.logger.warn("[SLOTS][".concat(e,"]: Excluded from next-auction slot requirement, because the slot does not exist in this tag")),!1;if(t.excludeFromAuctionBlock)return i.logger.warn("[SLOTS][".concat(e,"]: Excluded from next-auction slot requirement, because the slot has an activation condition")),!1;var n=i.getCurrentBreakpointName();return!!i.settings.isSlotEnabledForBreakpoint(t,n)||(i.logger.info("[SLOTS][".concat(e,"]: Excluded from next-auction slot requirement, because it is not enabled at the ").concat(n," breakpoint")),!1)})),this.auctionBlockSlots.length>0?(this.logger.info("[SCHEDULER]: Enabled auction block. Will not proceed until Zones with FuseIds ".concat(JSON.stringify(this.auctionBlockSlots)," are registered, or ").concat(t,"ms have elapsed")),this.auctionBlockTimeoutHandle=setTimeout((function(){i.auctionBlockTriggered?(i.logger.warn("[SCHEDULER]: Auction block timeout reached, missing: ".concat(JSON.stringify(i.getMissingAuctionBlockSlots()),". Running deferred auction")),i.clearAuctionBlock(),i.runAuction()):(i.getMissingAuctionBlockSlots().length>0&&i.logger.warn("[SCHEDULER]: Auction block timeout reached, missing: ".concat(i.getMissingAuctionBlockSlots())),i.clearAuctionBlock())}),t)):this.logger.info("[SCHEDULER]: Did not enable AuctionBlock, because no (valid) slots specified")}},{key:"getMissingAuctionBlockSlots",value:function(){var e=this;return this.auctionBlockSlots.filter((function(t){return!(e.isTemplateScheduled(t)||e.isAfsActive(t))}))}},{key:"isAfsActive",value:function(e){var t=this,i=this.activeSlots().find((function(i){return t.hasZoneTemplateId(i,e)}));return!!i&&i.zoneTemplate.attributes.afs}},{key:"isAnyAuctionExecuted",value:function(){return this.anyAuctionExecuted}},{key:"clearAuctionBlock",value:function(){this.auctionBlockSlots=[],this.auctionBlockTriggered=null,this.auctionBlockTimeoutHandle&&clearTimeout(this.auctionBlockTimeoutHandle),this.auctionBlockTimeoutHandle=null}}])}(),Cn="div",Tn="data-fuse",xn="".concat(Cn,"[").concat(Tn,"]"),_n="data-fuse-reset-at",An=function(){function e(t,n,o,r,s,a,u,l){var c=this;i(this,e),this.logger=t,this.browserWindow=n,this.templateSettings=o,this.fuseSlotFormatter=r,this.getElapsedTime=s,this.getApi=a,this.comboZoneManager=u,this.comboZoneState=l,this.document=this.browserWindow.document,this.slotCounter={},this.zoneCounter={},this.canProcessSlot=function(e,t){var i=e.getAttribute("data-fuse-code"),n=e.getAttribute(_n);if(t){if(i&&!n)return c.logger.debug("[SLOTS]: Skip ".concat(i," because it was already processed")),!1;i&&n&&c.logger.debug("[SLOTS]: Processing ".concat(i," again because it has been reset"))}else i&&c.logger.warn("[SLOTS]: Processing ".concat(i," again. This is likely to be an error, but preserved for backwards compatibility"));return!0},this.finalizeZones=function(t){var i=t.comboZoneEligible,n=t.templateToUse;return t.zoneDivs.map((function(t){var o,r,s=(null===(o=t.id)||void 0===o?void 0:o.trim())?null===(r=t.id)||void 0===r?void 0:r.trim():void 0,a=c.assignSlotDivId(n.id),u=c.assignZoneInstanceId(n.id),l=c.assignGpid(n.id,n.slot,"single");return c.prepareZoneDiv(a,u,l,t,n),{zoneTemplate:n,slotDivId:a,zoneDiv:t,zoneDivId:s,zoneInstanceId:u,gpid:l,targeting:e.extractTargeting(t),comboZoneEligible:i}}))}}return o(e,[{key:"prepareZoneDiv",value:function(e,t,i,n,o){if(this.logger.debug("[SLOTS][".concat(e,": Preparing the element")),n.setAttribute("data-fuse-code","".concat(e)),n.setAttribute("data-fuse-zone-instance","".concat(t)),n.setAttribute("data-fuse-slot","".concat(e)),this.templateSettings.isGptPreAuctionEnabled()&&n.setAttribute("data-gpid",i),n.setAttribute("data-fuse-processed-at",this.getElapsedTime().toString()),n.removeAttribute(_n),this.document.getElementById(e))this.logger.warn("[DOM-SCAN]: Found existing slot element with id ".concat(e));else{var r=this.document.createElement("div");r.setAttribute("id","".concat(e)),r.classList.add("fuse-slot"),r.style.maxWidth="inherit",r.style.maxHeight="inherit",this.fuseSlotFormatter.format(n,o),this.templateSettings.isYandexEnabled()&&this.fuseSlotFormatter.updateSlotForYandex(r,o),n.appendChild(r)}return n}},{key:"assignSlotDivId",value:function(t){return"fuse-slot-".concat(t,"-").concat(e.assignCounter(t,this.slotCounter))}},{key:"assignZoneInstanceId",value:function(t){return"zone-instance-".concat(t,"-").concat(e.assignCounter(t,this.zoneCounter))}},{key:"assignGpid",value:function(e,t,i){return"".concat(t,"#").concat(i,"-").concat(this.slotCounter[e])}},{key:"processRawElement",value:function(e,t){var i,n=this,o=e.getAttribute(Tn);if(!o)return this.logger.warn("[SLOTS]: Empty data-fuse attribute ".concat(o)),[];var r=this.templateSettings.generateZoneTemplate(o,this.getApi());if(!r)return this.logger.warn("[SLOTS]: Unknown ZoneCode found in data-fuse attribute ".concat(o)),[];if(!this.canProcessSlot(e,t))return[];var s=this.getApi().viewportInfo.getCurrentBreakpoint().name,a=function(e,t,i){if(!i||i.length<1)return[];var n=pt(e,t),o=n.maxWidth,r=n.maxHeight;return vt.filter((function(e){var t=i.find((function(t){return t[0]===e.parentSize[0]&&t[1]===e.parentSize[1]})),n=i.find((function(t){return t[0]===e.comboZoneSize[0]&&t[1]===e.comboZoneSize[1]}));return t&&n&&(!o||o>=e.computedSize[0])&&(!r||r>=e.computedSize[1])}))}(e,this.browserWindow,null===(i=r.sizeMapping)||void 0===i?void 0:i[s]),u=this.comboZoneManager.tryInitialize({zoneDiv:e,currentBp:s,comboZoneOptions:a,template:r}),l=u.template,c=u.zoneDivs,d=u.comboZoneVal,g=this.finalizeZones({templateToUse:l,zoneDivs:c,comboZoneEligible:a.length>0});return d&&g.forEach((function(e){n.comboZoneState.setComboZoneState(e.slotDivId,d)})),g}},{key:"findElementWithDomId",value:function(e){var t=this.document.querySelectorAll("".concat(Cn,'[id="').concat(e,'"][').concat(Tn,"]"));return 0==t.length?this.logger.warn("[SLOTS]: No DOM element found with both id='".concat(e,"' AND a data-fuse attribute")):t.length>1&&this.logger.warn("[SLOTS]: Multiple DOM elements found with id '".concat(e,"'")),t}},{key:"findAllFuseElements",value:function(){return this.document.querySelectorAll(xn)}},{key:"findElementsWithTemplateId",value:function(e){return this.document.querySelectorAll("".concat(Cn,"[").concat(Tn,'="').concat(e,'"]'))}},{key:"processRawElements",value:function(e,t){var i=this;return Array.from(e).reduce((function(e,n){var o=i.processRawElement(n,t);return[].concat(d(e),d(o))}),[])}},{key:"processSlots",value:function(e){var t=this.findAllFuseElements();return this.processRawElements(t,e)}},{key:"processZoneWithDivId",value:function(e,t){var i=this.findElementWithDomId(e),n=this.processRawElements(i,t);return n[n.length-1]}},{key:"processLastSlotWithFuseId",value:function(e,t){var i=this.findElementsWithTemplateId(e),n=this.processRawElements(i,t);return n[n.length-1]}},{key:"processSlotsWithFuseId",value:function(e,t){var i=this.findElementsWithTemplateId(e);return this.processRawElements(i,t)}}],[{key:"assignCounter",value:function(e,t){return t[e]||(t[e]=0),++t[e]}},{key:"getTargetingValue",value:function(e){return e.indexOf(",")>0?e.split(",").map((function(e){return e.trim()})).filter((function(e){return""!==e})):e}},{key:"extractTargeting",value:function(t){var i=t.getAttributeNames().filter((function(e){return"data-targeting-key"!==e&&"data-targeting-value"!==e})).filter((function(e){return 0===e.indexOf("data-targeting-",0)})).map((function(e){return{attributeKey:e,targetingKey:e.replace("data-targeting-","").trim()}})).map((function(e){return{key:e.targetingKey,value:t.getAttribute(e.attributeKey)}})).filter((function(e){var t=e.key,i=e.value;return(null==t?void 0:t.length)&&(null==i?void 0:i.length)})).map((function(t){var i=t.key,n=t.value;return{key:i,value:e.getTargetingValue(n)}})),n=t.getAttribute("data-targeting-key"),o=t.getAttribute("data-targeting-value");return(null==n?void 0:n.length)&&(null==o?void 0:o.length)&&!i.some((function(e){return e.key===n}))&&i.push({key:n,value:e.getTargetingValue(o)}),i}}])}(),Rn=function(){return o((function e(t,n,o){i(this,e),this.logger=t,this.templateSettings=n,this.viewportInfo=o}),[{key:"logContext",value:function(e){return"[SLOT-FORMAT][".concat(e.id,"]:")}},{key:"hasOverflow",value:function(e,t,i){for(var n=this,o=e.parentElement,r=["hidden","scroll","auto"],s=["overflow","overflow-x","overflow-y"];o;)s.forEach((function(e){var s=n.viewportInfo.browserWindow.getComputedStyle(o)[e];if(y(s)&&-1!==r.indexOf(s)){if(!i)return n.logger.debug("".concat(n.logContext(t)," Miniscroller was not applied. ").concat(String(e),' on "').concat(o.id," ").concat(o.className,'"')),!0;o.style[e]="visible",n.logger.debug("".concat(n.logContext(t)," Force miniscroller. Update ").concat(String(e),' on "').concat(o.id," ").concat(o.className,'"'))}})),o=o.parentElement;return!1}},{key:"hasHeight",value:function(e,t,i){var n=e,o=this.viewportInfo.browserWindow.getComputedStyle(e),r=o.height,s=o.minHeight;if(this.logger.debug("".concat(this.logContext(t),' applying miniscroller on element with height "').concat(r,'" min-height: "').concat(s,'"')),-1===["0px","auto"].indexOf(r)){if(!i)return this.logger.debug("".concat(this.logContext(t)," Miniscroller was not applied because of height ").concat(r,' already set for element "').concat(e.id,'"')),!0;this.logger.debug("".concat(this.logContext(t),' Force miniscroller. Update height on "').concat(n.className,'"'))}return!1}},{key:"format",value:function(e,t){var i=t.attributes;!this.templateSettings.isMiniScrollersEnabled()||!1===i.miniscroller||i.sticky||i.interscroller||i.interstitial||i.scrollToStick||t.attributes.forceComboZone||t.attributes.comboZoneEnabled||this.hasHeight(e,t)||this.hasOverflow(e,t)||(this.logger.debug("".concat(this.logContext(t),' Update slot element "').concat(e.id,'" to miniscroller')),this.updateSlotElementToMiniScroller(e,t))}},{key:"updateSlotElementToMiniScroller",value:function(e,t){var i=this.viewportInfo.getCurrentBreakpoint().name;e.classList.add("fuse-slot-mini-scroller");var n=this.templateSettings.maxSlotHeightForBreakpoint(t,i);e.style.minHeight="".concat(n,"px")}},{key:"updateSlotForYandex",value:function(e,t){var i,n=this.viewportInfo.getCurrentBreakpoint().name,o=null===(i=t.sizeMapping)||void 0===i?void 0:i[n],r=0,s=0;o&&o.length>0&&(o.forEach((function(e){"fluid"!==e&&"fluid"!==e[0]&&(Number(e[0])>s&&(s=Number(e[0])),Number(e[1])>r&&(r=Number(e[1])))})),e.style.width="".concat(s,"px"),e.style.height="".concat(r,"px"),e.style.margin="auto")}}])}(),Pn=E.getLogger(),On=E.getPackageMajorVersion(),Dn=gn.getPrebidGlobal(),zn=Pt.getReporter(),Ln=kt.getSettings(),Nn="https://mpbs.rubiconproject.com/openrtb2/auction",Bn="https://mpbs.rubiconproject.com/cookie_sync";function Mn(e){return e.hasOwnProperty("libLoaded")}var Fn=function(e){if(zn.setStateStatus("prebid_load_script_start"),!Mn(Dn)){var t=Ln.getPrebidHash(),i=Ln.getFuseCDN();return D(Object.assign({name:"Prebid.org"},t?{url:"//".concat(i,"/prebid/"),file:"prebid-".concat(t,".js")}:{url:"//".concat(i,"/").concat(Ln.getTenantCode(),"/tags/").concat(On,"/").concat(Ln.getFuseId(),"/"),file:"prebid.js"}),(function(){Pn.debug("[INIT]: Prebid ".concat(Mn(Dn)&&Dn.libLoaded?"".concat(Dn.version," is loaded and ready"):"not loaded")),zn.setStateStatus("prebid_onload_received"),e()}))}Pn.warn("[INIT]: Prebid ".concat(Dn.version," is already loaded skip loading it again"))},jn=function(e){Dn.que.push((function(){try{e()}catch(e){e instanceof Error?Pn.error("Error processing command :",e.message,e.stack):Pn.error("Error processing command :",e)}}))};function Un(){if(Ln.isResponsiveEnabled()&&!at.isUseBrowserOuterwidth()){var e=null,t=[];return Object.keys(at.getBreakpoints()).forEach((function(i){var n=at.getBreakpoints()[i],o=e?e-1:null;Pn.debug("[PREBID]: Configured breakpoint ".concat(i," ").concat(n,"px to ").concat(o)),t.push({mediaQuery:"(min-width:".concat(n,"px)").concat(e?" and (max-width: ".concat(o,"px)"):""),sizesSupported:Ln.getSupportedSizes(i),labels:[i]}),e=n})),t}var i=gt.getViewportInfo().getCurrentBreakpoint().name;return[{mediaQuery:"(min-width: ".concat(0,"px)"),sizesSupported:Ln.getSupportedSizes(i),labels:[i]}]}function Gn(e){var t,i,n,o,r,s,a,u,l=E.getBrowserWindowObject(),c=E.getWindowLocation();return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableSendAllBids:e&&!0===e.sendAllBids,priceGranularity:{buckets:[{max:3,increment:.01,precision:2},{max:10,increment:.1,precision:2},{max:50,increment:1,precision:2},{max:100,increment:10,precision:2}]},sizeConfig:Un(),userSync:(r={enabled:!0,useCriteoId:e.useCriteoId,useSharedId:Ln.isSharedIdEnabled(),usePairId:Ln.isPairIdEnabled()},s=r.useCriteoId,a=r.useSharedId,u=r.usePairId,{filterSettings:{iframe:{bidders:"*",filter:"include"}},enableOverride:!0,userIds:[].concat(d(s?[{name:"criteo"}]:[]),d(a?[(Pn.debug("[PREBID]: Added shared id"),{name:"sharedId",storage:{name:"_sharedID",type:"cookie",expires:30}})]:[]),d(u?[(Pn.debug("[PREBID]: Added pair id"),{name:"pairId",params:{liveramp:{storageKey:"_lr_pairId"}}})]:[]))}),targetingControls:{addTargetingKeys:["SOURCE","DSP","CRID"]},eventHistoryTTL:Ln.getEventHistoryTTLOverride()},Ln.isCmpRequired()&&(Pn.debug("[PREBID]: Configured CMP module"),{consentManagement:{gdpr:{cmpApi:"iab",timeout:Ln.getUspTimeoutMillis(),defaultGdprScope:!0,allowAuctionWithoutConsent:!Ln.isStrictCmp()},usp:{cmpApi:"iab",timeout:Ln.getUspTimeoutMillis()}}})),Ln.isGptPreAuctionEnabled()&&(Pn.debug("[PREBID]: Configured GPT Pre auction module"),{gptPreAuction:{enabled:!0,customPreAuction:function(e){var t;return null===(t=document.querySelector('div[data-fuse-slot="'.concat(e.code,'"]')))||void 0===t?void 0:t.getAttribute("data-gpid")}}})),Ln.isPrebidContextualSignalsEnabled()&&{ortb2:{site:{name:c.hostname,domain:c.hostname,cat:Ln.getFuseIndustry(),page:c.href,ref:l.document.referrer,keywords:null===(i=null===(t=l.document.querySelector('meta[name="keywords"]'))||void 0===t?void 0:t.getAttribute("content"))||void 0===i?void 0:i.split(",").map((function(e){return e.trim()}))}}}),e.sco&&{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:(o=e.sco).asi,sid:o.sellerId,hp:1}]}}}),e.prebidServerBidders.length>0&&(n=e.prebidServerBidders,Pn.debug("[PREBID]: Enabling Prebid Server for ".concat(JSON.stringify(n))),{s2sConfig:{accountId:"20884",bidders:n,adapter:"prebidServer",enabled:!0,endpoint:Nn,syncEndpoint:Bn,timeout:750,extPrebid:{cache:{vastxml:{returnCreative:!1}}}}})),{currency:{adServerCurrency:"USD",granularityMultiplier:1,defaultRates:{AUD:{USD:.67}}}}),Ln.isBidCacheEnabled()&&{useBidCache:!0}),Ln.getPrebidIasPubId()&&{realTimeData:{dataProviders:[{name:"ias",waitForIt:!0,params:{pubId:Ln.getPrebidIasPubId()}}]}}),"v5"===Ln.getTagRevision()&&{enableTIDs:!0})}var Wn=function(e){return Pn.debug("[PREBID]: Applied config settings ".concat(JSON.stringify(e))),Dn.setConfig(Object.assign(Object.assign({},e),Ln.isPrebidVideoEnabled()&&{cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},rubicon:{rendererConfig:{align:"center",position:"append",closeButton:!0,label:"Advertisement",collapse:!0}}})),"v5"===Ln.getTagRevision()&&(Dn.bidderSettings={standard:{storageAllowed:["cookie"]}}),e};var Vn={loadPrebidLibrary:Fn,pushToPrebidQue:jn,getPrebidDefaultConfig:Gn,setPrebidConfig:Wn,getPrebidUnitIndex:function(e){return Mn(Dn)?Dn.adUnits.findIndex((function(t){return t.code===e})):void 0},getPrebidUnits:function(e){var t={};Dn.adUnits.forEach((function(e){return t[e.code]=e}));var i={};return e.forEach((function(e){var n=t[e];n?i[e]=JSON.parse(JSON.stringify(n)):Pn.warn("[PREBID]: No prebid unit found for ".concat(e))})),i},enable:function(e){jn((function(){var e=Gn({sendAllBids:Ln.getPrebidSettings()&&!0===Ln.getPrebidSettings().sendAllBids,sco:Ln.getSco(),prebidServerBidders:[],useCriteoId:Ln.isCriteoIdEnabled()}),t=wi.getIdentityModule();Ln.isIdentityEnabled()&&t&&(Pn.debug("[PREBID] Enabled identity module"),e=t.configPrebid(e),Pn.debug("[PREBID] Enabled ATS analytics module"),Dn.enableAnalytics([{provider:"atsAnalytics",options:{pid:Ln.getIdentitySettings().placementId}}]));var i=ki.getId5Module();Ln.isId5Enabled()&&i&&(Pn.debug("[PREBID] Enabled id5 module"),e=i.configPrebid(e)),Wn(e),jn((function(){Pn.debug("[PREBID] Adding auctionEnd event listener"),Dn.onEvent("auctionEnd",(function(e){Pn.debug("[PREBID] auctionEnd event callback triggered"),He.onPrebidAuctionEnd.emit(e)})),Pn.debug("[PREBID] Adding adRenderFailed event listener"),Dn.onEvent("adRenderFailed",(function(e){Pn.debug("[PREBID] adRenderFailed event callback triggered"),He.onPrebidAdRenderFailed.emit(e)})),Pn.debug("[PREBID] Adding adRenderSucceeded event listener"),Dn.onEvent("adRenderSucceeded",(function(e){Pn.debug("[PREBID] adRenderSucceeded event callback triggered"),He.onPrebidAdRenderSucceeded.emit(e)}))})),Pn.debug("[PREBID]: Enabled prebid ".concat(JSON.stringify(e)))})),T(et("fuseDelayPrebidInit"),"simulate prebid download delay",Pn,(function(){var t=zn.getElapsedTime();Fn((function(){var i=E.getBrowserWindowObject(),n=i.pbjs;S(n)||!Mn(n)?i.pbjs=Dn:n.renderAd&&(n.renderAd=Dn.renderAd),e(t)}))}))},reset:function(){Mn(Dn)&&Dn.removeAdUnit()}};function Hn(e,t,i,n){var o=i/100,r=function(e,t,i,n,o){var r=e.top,s=e.bottom,a=e.left,u=e.right,l=e.width,c=e.height*o,d=l*o;return r+c+n>=0&&a+d>=0&&s-c-n<=i&&u-d<=t}(t.getBoundingClientRect(),e.width,e.innerHeight,n,o);return!e.hidden&&r}var Zn=function(){return o((function e(t,n,o,r,s,a){var u=this;i(this,e),this.slot=t,this.refreshInterval=n,this.triggerAuction=o,this.logger=r,this.onSlotRender=s,this.onSlotLoaded=a,this.isRefreshEnabled=!0,this.slotRenderEventHandle=function(){return u.scheduleRefresh("slotRenderEnded")},this.slotLoadEventHandle=function(){return u.scheduleRefresh("slotOnLoad")},this.logger.debug("[REFRESH]: ScheduledRefreshStrategy initialized for slot ".concat(this.slot.slotDivId,", interval: ").concat(this.refreshInterval)),this.slotRenderEventStream=this.createFilteredObservable(s,t),this.slotLoadEventStream=this.createFilteredObservable(a,t),this.slotRenderEventStream.subscribe(this.slotRenderEventHandle),this.slotLoadEventStream.subscribe(this.slotLoadEventHandle)}),[{key:"createFilteredObservable",value:function(e,t){return new We(this.logger,"",e,(function(e){return e.slot.getSlotElementId()===t.slotDivId?t:null}))}},{key:"getInfo",value:function(){return{strategyName:"ScheduledRefreshStrategy",isRefreshEnabled:this.isRefreshEnabled}}},{key:"destroy",value:function(){this.slotRenderEventStream.unsubscribe(this.slotRenderEventHandle),this.slotLoadEventStream.unsubscribe(this.slotLoadEventHandle),this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null),this.isRefreshEnabled=!1,this.logger.debug("[REFRESH]: Refresh strategy destroyed for slot ".concat(this.slot.slotDivId))}},{key:"disableRefresh",value:function(){this.isRefreshEnabled=!1,this.logger.debug("[REFRESH]: Refresh disabled for slot ".concat(this.slot.slotDivId))}},{key:"enableRefresh",value:function(){this.isRefreshEnabled=!0,this.scheduleRefresh("enableRefresh"),this.logger.debug("[REFRESH]: Refresh enabled for slot ".concat(this.slot.slotDivId))}},{key:"isBlockedByRefreshCallback",value:function(){try{return!this.slot.isAllowRefresh()}catch(e){return this.logger.error("[REFRESH]: ".concat(this.slot.slotDivId," Refresh callback failed with ").concat(e)),!0}}},{key:"shouldSkipRefresh",value:function(){return this.isRefreshEnabled?this.isBlockedByRefreshCallback()?(this.logger.log("[REFRESH]: ".concat(this.slot.slotDivId," Refresh blocked by callback")),!0):this.slot.isInDom()?(!this.slot.zoneDiv||!this.slot.isInView())&&(this.logger.log("[REFRESH]: Not refreshing ".concat(this.slot.slotDivId," because it is not in view")),!0):(this.logger.warn("[REFRESH]: Could not refresh ".concat(this.slot.slotDivId," because a div with that id was not found in the DOM")),!0):(this.logger.log("[REFRESH]: Not refreshing ".concat(this.slot.slotDivId," because refresh is disabled")),!0)}},{key:"setRefreshTimer",value:function(e){var t=this,i=this.slot.slotDivId;this.refreshTimer&&(this.logger.warn("[REFRESH]: Refresh timer already set for ".concat(i,". Clearing it.")),clearInterval(this.refreshTimer)),this.refreshTimer=setInterval((function(){t.processRefresh()}),1e3*e)}},{key:"scheduleRefresh",value:function(e){this.refreshTimer?this.logger.debug("[REFRESH]: Slot ".concat(this.slot.slotDivId," is already scheduled. eventName: ").concat(e)):this.setRefreshTimer(this.refreshInterval)}},{key:"processRefresh",value:function(){this.shouldSkipRefresh()||(this.logger.log("[REFRESH]: Slot ".concat(this.slot.slotDivId," meets the conditions and will trigger auction.")),this.triggerAuction(this.slot))}}])}(),qn=function(){return o((function e(t,n){i(this,e),this.slot=t,this.logger=n,this.debug("[REFRESH]: NoRefreshStrategy initialized for slot ".concat(this.slot.slotDivId))}),[{key:"debug",value:function(e){this.logger&&this.logger.debug(e)}},{key:"getInfo",value:function(){return{strategyName:"NoRefreshStrategy",isRefreshEnabled:!1}}},{key:"destroy",value:function(){this.debug("[REFRESH]: NoRefreshStrategy destroy called for slot ".concat(this.slot.slotDivId,", no action taken."))}},{key:"disableRefresh",value:function(){this.debug("[REFRESH]: NoRefreshStrategy disableRefresh called for slot ".concat(this.slot.slotDivId,", no action taken."))}},{key:"enableRefresh",value:function(){this.debug("[REFRESH]: NoRefreshStrategy enableRefresh called for slot ".concat(this.slot.slotDivId,", no action taken."))}}])}(),Yn=function(){return o((function e(t,n,o,r,s,a,u,l){var c=this;i(this,e),this.slot=t,this.refreshInterval=n,this.triggerAuction=o,this.logger=r,this.onSlotRender=s,this.onSlotLoaded=a,this.onImpressionViewable=u,this.minOnScreenDuration=l,this.isRefreshEnabled=!0,this.CHECK_INTERVAL=500,this.onScreenDuration=0,this.lastRefreshTimestamp=0,this.hasReceivedImpressionViewable=!1,this.slotRenderEventHandle=function(){return c.handleSlotRenderEvent()},this.slotLoadEventHandle=function(){return c.handleSlotLoadEvent()},this.impressionViewableEventHandle=function(){return c.handleImpressionViewableEvent()},this.logger.debug("[REFRESH]: ViewportRefreshStrategy initialized for slot ".concat(this.slot.slotDivId,", interval: ").concat(this.refreshInterval)),this.slotRenderEventStream=this.createFilteredObservable(s,t),this.slotLoadEventStream=this.createFilteredObservable(a,t),this.impressionViewableEventStream=this.createFilteredObservable(u,t),this.slotRenderEventStream.subscribe(this.slotRenderEventHandle),this.slotLoadEventStream.subscribe(this.slotLoadEventHandle),this.impressionViewableEventStream.subscribe(this.impressionViewableEventHandle)}),[{key:"createFilteredObservable",value:function(e,t){return new We(this.logger,"",e,(function(e){return e.slot.getSlotElementId()===t.slotDivId?t:null}))}},{key:"getInfo",value:function(){return{strategyName:"ViewportRefreshStrategy",isRefreshEnabled:this.isRefreshEnabled}}},{key:"destroy",value:function(){this.slotRenderEventStream.unsubscribe(this.slotRenderEventHandle),this.slotLoadEventStream.unsubscribe(this.slotLoadEventHandle),this.impressionViewableEventStream.unsubscribe(this.impressionViewableEventHandle),this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null),this.isRefreshEnabled=!1,this.resetCounter(),this.logger.debug("[REFRESH]: Refresh strategy destroyed for slot ".concat(this.slot.slotDivId))}},{key:"disableRefresh",value:function(){this.isRefreshEnabled=!1,this.logger.debug("[REFRESH]: Refresh disabled for slot ".concat(this.slot.slotDivId))}},{key:"enableRefresh",value:function(){this.isRefreshEnabled=!0,this.scheduleRefresh("enableRefresh"),this.logger.debug("[REFRESH]: Refresh enabled for slot ".concat(this.slot.slotDivId))}},{key:"isBlockedByRefreshCallback",value:function(){try{return!this.slot.isAllowRefresh()}catch(e){return this.logger.error("[REFRESH]: ".concat(this.slot.slotDivId," Refresh callback failed with ").concat(e)),!0}}},{key:"resetCounter",value:function(){this.onScreenDuration=0,this.lastRefreshTimestamp=Date.now(),this.hasReceivedImpressionViewable=!1}},{key:"shouldSkipRefresh",value:function(){return this.isRefreshEnabled?this.isBlockedByRefreshCallback()?(this.logger.log("[REFRESH]: ".concat(this.slot.slotDivId," Refresh blocked by callback")),!0):!this.slot.isInDom()&&(this.logger.warn("[REFRESH]: Could not refresh ".concat(this.slot.slotDivId," because a div with that id was not found in the DOM")),!0):(this.logger.log("[REFRESH]: Not refreshing ".concat(this.slot.slotDivId," because refresh is disabled")),!0)}},{key:"setRefreshTimer",value:function(){var e=this,t=this.slot.slotDivId;this.refreshTimer&&(this.logger.warn("[REFRESH]: Refresh timer already set for ".concat(t,". Clearing it.")),clearInterval(this.refreshTimer)),this.refreshTimer=setInterval((function(){e.processRefresh()}),this.CHECK_INTERVAL)}},{key:"scheduleRefresh",value:function(e){this.refreshTimer?this.logger.debug("[REFRESH]: Slot ".concat(this.slot.slotDivId," is already scheduled. eventName: ").concat(e)):(this.lastRefreshTimestamp=Date.now(),this.setRefreshTimer())}},{key:"handleSlotRenderEvent",value:function(){this.onScreenDuration=0,this.scheduleRefresh("slotRenderEnded")}},{key:"handleSlotLoadEvent",value:function(){this.onScreenDuration=0,this.scheduleRefresh("slotOnLoad")}},{key:"handleImpressionViewableEvent",value:function(){this.logger.debug("[REFRESH]: Received impression viewable event for slot ".concat(this.slot.slotDivId)),this.hasReceivedImpressionViewable=!0}},{key:"processRefresh",value:function(){if(!(Date.now()-this.lastRefreshTimestamp<1e3*this.refreshInterval)&&this.slot.zoneDiv&&this.slot.isInView()&&(this.onScreenDuration+=this.CHECK_INTERVAL,(this.hasReceivedImpressionViewable||!(this.onScreenDuration<this.minOnScreenDuration))&&!this.shouldSkipRefresh()))try{this.logger.log("[REFRESH]: Slot ".concat(this.slot.slotDivId," meets the conditions durationSinceLastRefresh: ").concat(Date.now()-this.lastRefreshTimestamp,", onScreenDuration: ").concat(this.onScreenDuration,", hasReceivedImpressionViewable: ").concat(this.hasReceivedImpressionViewable," and will trigger auction.")),this.lastRefreshTimestamp=Date.now(),this.triggerAuction(this.slot)}catch(e){this.logger.warn("[REFRESH]: ".concat(this.slot.slotDivId," Refresh triggerAuction failed with ").concat(e))}finally{this.resetCounter()}}}])}(),Jn=function(){return o((function e(t,n,o,r,s,a,u,l,c,d,g){i(this,e),this.logger=t,this.reporter=n,this.browserWindow=o,this.gptSlotRegistry=r,this.settings=s,this.conditionFactory=a,this.viewportInfo=u,this.events=l,this.prebidSlotRegistrator=c,this.getIn2wCallbackId=d,this.auctionScheduler=g,this.DELETED_FUSE_DIVS=[],this.REGISTERED_SLOTS={},this.SLOT_ACTIVATOR={},this.SLOT_REFRESH_STRATEGY={},this.slotRefreshCounts={},this.slotInitialised=new Ge(this.logger,"onSlotCreated"),this.slotsInitialised=new Ge(this.logger,"onSlotsInitialised")}),[{key:"getZoneDivs",value:function(){var e=this,t={};return Object.keys(this.REGISTERED_SLOTS).forEach((function(i){var n=e.REGISTERED_SLOTS[i];t[n.slotDivId]=n.zoneDiv})),t}},{key:"getZoneTemplates",value:function(){var e=this,t={};return Object.keys(this.REGISTERED_SLOTS).forEach((function(i){var n=e.REGISTERED_SLOTS[i];t[n.slotDivId]=n.zoneTemplate})),t}},{key:"getSlotsForTemplateId",value:function(e){var t=this;return Object.keys(this.REGISTERED_SLOTS).filter((function(i){return t.REGISTERED_SLOTS[i].zoneTemplate.id===e})).map((function(e){return t.REGISTERED_SLOTS[e]}))}},{key:"getActiveSlots",value:function(){var e=this;return Object.keys(this.REGISTERED_SLOTS).filter((function(t){return e.REGISTERED_SLOTS[t].currentlyActive})).map((function(t){return e.REGISTERED_SLOTS[t]}))}},{key:"disableRefreshBySlotId",value:function(e){var t;null===(t=this.SLOT_REFRESH_STRATEGY[e])||void 0===t||t.disableRefresh()}},{key:"enableRefreshBySlotId",value:function(e){var t;null===(t=this.SLOT_REFRESH_STRATEGY[e])||void 0===t||t.enableRefresh()}},{key:"destroyAllRefresh",value:function(){var e=this;Object.keys(this.SLOT_REFRESH_STRATEGY).forEach((function(t){e.SLOT_REFRESH_STRATEGY[t].destroy()}))}},{key:"enableAllRefresh",value:function(){var e=this;Object.keys(this.SLOT_REFRESH_STRATEGY).forEach((function(t){e.SLOT_REFRESH_STRATEGY[t].enableRefresh()}))}},{key:"disableAllRefresh",value:function(){var e=this;Object.keys(this.SLOT_REFRESH_STRATEGY).forEach((function(t){e.SLOT_REFRESH_STRATEGY[t].disableRefresh()}))}},{key:"getAllRefresh",value:function(){return Object.entries(this.SLOT_REFRESH_STRATEGY).filter((function(e){return"NoRefreshStrategy"!==c(e,2)[1].getInfo().strategyName})).reduce((function(e,t){var i=c(t,2),n=i[0],o=i[1],r=Object.assign({},e);return r[n]=o.getInfo(),r}),{})}},{key:"getSlotInitObservable",value:function(){return this.slotInitialised}},{key:"getSlotsInitObservable",value:function(){return this.slotsInitialised}},{key:"isInDom",value:function(e){return y(window.document.getElementById(e))}},{key:"isDeletedSlot",value:function(e){return-1!==this.DELETED_FUSE_DIVS.indexOf(e)}},{key:"isAboveViewport",value:function(e){var t,i;return null!==(i=null===(t=this.REGISTERED_SLOTS[e])||void 0===t?void 0:t.isAboveViewport())&&void 0!==i&&i}},{key:"isLazy",value:function(e){var t;return"lazy"===(null===(t=this.REGISTERED_SLOTS[e])||void 0===t?void 0:t.zoneTemplate.activateConditionConfig.type)}},{key:"excludeDeleted",value:function(e,t){var i=this;return e.filter((function(e){var n=!i.isDeletedSlot(e.slotDivId);return!n&&t&&t(e.slotDivId),n}))}},{key:"reset",value:function(){var e=this;Object.keys(this.REGISTERED_SLOTS).forEach((function(t){e.isDeletedSlot(t)&&e.logger.log("[EVENT]: resetSlots() unit already deleted ".concat(t)),e.DELETED_FUSE_DIVS.push(t)}));var t=this.getZoneDivs();Object.keys(t).forEach((function(i){t[i].setAttribute(_n,e.reporter.getElapsedTime().toString())})),Object.keys(this.SLOT_ACTIVATOR).forEach((function(t){e.SLOT_ACTIVATOR[t].destroy()})),Object.keys(this.SLOT_REFRESH_STRATEGY).forEach((function(t){e.SLOT_REFRESH_STRATEGY[t].destroy()})),this.REGISTERED_SLOTS={},this.SLOT_ACTIVATOR={},this.SLOT_REFRESH_STRATEGY={},this.clearFuseSkins()}},{key:"registeredSlotConfig",value:function(e,t,i,n,o){var r=this;return{slotDivId:e,zoneDiv:n,zoneDivId:o,zoneInstanceId:t,zoneTemplate:i,zoneTemplateId:i.id,isInView:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=i.attributes.interscroller?r.browserWindow.document.querySelector(".publift-widget-".concat(i.id,"-container")):r.browserWindow.document.getElementById(e);if(n){var o=(i.attributes.interscroller?n:n.parentElement).getBoundingClientRect(),s=o.top,a=o.bottom,u=o.left,l=o.right,c=o.width,d=o.height;return s||a||u||l||c||d?Hn(r.viewportInfo.getViewportStatus(),n,50,t):(r.logger.log("[SLOTS][".concat(e,"]: Skipped slot checkInView because zone/interscroller element is not visible")),!1)}return r.logger.warn("[SLOTS][".concat(e,"]: Slot element is not found")),!1},isAllowRefresh:function(){return!0},isInDom:function(){return r.isInDom(e)},isAboveViewport:function(){return n.getBoundingClientRect().bottom<0}}}},{key:"registerActiveSlot",value:function(e,t){e.currentlyActive=!0,this.enablePartners(e,t),this.events.onZoneEvent.emit({zoneTemplateId:e.zoneTemplate.id,zoneDivId:e.zoneDivId,zoneEventType:"registered",instanceId:e.zoneInstanceId,status:"active",gpid:e.gpid,comboZoneEligible:e.comboZoneEligible,slotDivId:e.slotDivId})}},{key:"registerInactiveSlot",value:function(e,t){this.SLOT_ACTIVATOR[e.slotDivId]=t,this.events.onZoneEvent.emit({zoneTemplateId:e.zoneTemplate.id,zoneDivId:e.zoneDivId,zoneEventType:"registered",instanceId:e.zoneInstanceId,status:"inactive",gpid:e.gpid,comboZoneEligible:e.comboZoneEligible,slotDivId:e.slotDivId})}},{key:"activateInactiveSlot",value:function(e,t,i){var n=e.slotDivId;if(this.REGISTERED_SLOTS[n]&&!0===this.REGISTERED_SLOTS[n].currentlyActive)this.logger.warn("[SLOTS][".concat(n,"]: Skipped activation because the slot was already activated"));else{if(!this.isInDom(n))return this.logger.warn("[SLOTS][".concat(n,"]: Skipped activation because the slot was removed from the DOM")),void this.deleteSlot(n);this.SLOT_ACTIVATOR[n].destroy(),e.currentlyActive=!0,this.enablePartners(e,t),this.events.onZoneEvent.emit({zoneTemplateId:e.zoneTemplate.id,zoneDivId:e.zoneDivId,zoneEventType:"activated",instanceId:e.zoneInstanceId,gpid:e.gpid,slotDivId:e.slotDivId}),i([e])}}},{key:"enablePartners",value:function(e,t){e.zoneTemplate.attributes.afs?this.logger.debug("[SLOTS][".concat(e.slotDivId,"]: Afs zone detected, skipping gpt/prebid registration")):(this.enableGptAsync(e,t),e.allowHeaderBidding?this.enablePrebidAsync(e):this.logger.debug("[SLOTS][".concat(e.slotDivId,"]: Skip prebid registration because headerbidding not enabled")))}},{key:"enablePrebidAsync",value:function(e){var t=this;Vn.pushToPrebidQue((function(){t.isDeletedSlot(e.slotDivId)?t.logger.log("[SLOTS][".concat(e.slotDivId,"]: Skip prebid registration because div deleted")):t.prebidSlotRegistrator.registerPrebidUnit(e)}))}},{key:"enableGptAsync",value:function(e,t){var i=this;qt((function(){if(i.isDeletedSlot(e.slotDivId))i.logger.log("[SLOTS][".concat(e.slotDivId,"]: Skip GPT registration because div deleted"));else{var n;i.settings.isIn2wSafeframe()&&(n=i.getIn2wCallbackId());var o=Jt(e,n?[].concat(d(t),[{key:"i2wcbid",value:n}]):t);o&&(i.settings.isIn2wSafeframe()&&(o.__i2wcbid=n),i.gptSlotRegistry.add(e.zoneTemplate.id,o),r=e.slotDivId,Mt.debug("[GPT]: googletag.display(".concat(r,")")),_t.display(r))}var r}))}},{key:"deleteSlot",value:function(e){var t,i;this.logger.debug("[SLOTS][".concat(e,"]: Deleting slot"));var n=this.getSlot(e);n?this.gptSlotRegistry.purgeByElement(n.zoneTemplate.id,n.slotDivId):this.logger.debug("[SLOTS][".concat(e,"]: Registered slot not found upon deletion")),this.DELETED_FUSE_DIVS.push(e),delete this.REGISTERED_SLOTS[e],null===(t=this.SLOT_ACTIVATOR[e])||void 0===t||t.destroy(),delete this.SLOT_ACTIVATOR[e],null===(i=this.SLOT_REFRESH_STRATEGY[e])||void 0===i||i.destroy(),delete this.SLOT_REFRESH_STRATEGY[e],n&&this.events.onZoneEvent.emit({zoneTemplateId:n.zoneTemplate.id,zoneDivId:n.zoneDivId,zoneEventType:"deleted",instanceId:n.zoneInstanceId,gpid:n.gpid,slotDivId:n.slotDivId})}},{key:"getSlot",value:function(e){return this.REGISTERED_SLOTS[e]}},{key:"getSlotByZoneDivId",value:function(e){var t=this;return this.REGISTERED_SLOTS[Object.keys(this.REGISTERED_SLOTS).find((function(i){return t.REGISTERED_SLOTS[i].zoneDivId===e}))]}},{key:"getSlots",value:function(e){var t=this,i=[];return e.forEach((function(e){var n=t.getSlot(e);n&&i.push(n)})),i}},{key:"buildActivator",value:function(e,t,i,n,o){var r=this;return this.conditionFactory.buildActivator(t,e.slotDivId,i,(function(){return r.activateInactiveSlot(e,n,o)}))}},{key:"createRefreshStrategy",value:function(e){var t=this.settings.getRefreshTimeout(e.zoneTemplate);return b(t)&&t>0?"ViewportRefreshStrategy"===this.settings.getRefreshStrategy()?(this.logger.debug("[SLOTS]: Using ViewportRefreshStrategy for slot ".concat(e.slotDivId)),new Yn(e,t,this.auctionScheduler.triggerAuction.bind(this.auctionScheduler),this.logger,this.events.onSlotRender,this.events.onSlotLoaded,this.events.onImpressionViewable,1e3)):(this.logger.debug("[SLOTS]: Using ScheduledRefreshStrategy for slot ".concat(e.slotDivId)),new Zn(e,t,this.auctionScheduler.triggerAuction.bind(this.auctionScheduler),this.logger,this.events.onSlotRender,this.events.onSlotLoaded)):(this.logger.debug("[SLOTS]: Using NoOpRefreshStrategy for slot ".concat(e.slotDivId)),new qn(e,this.logger))}},{key:"registerFuseSlot",value:function(e){var t,i=this,n=e.slotDivId,o=e.zoneDiv,r=e.zoneInstanceId,s=e.zoneDivId,a=e.zoneTemplate,u=e.gpid,l=e.targeting,c=e.forceActivate,d=e.api,g=e.runAuctionFn,h=e.comboZoneEligible,f=this.viewportInfo.getCurrentBreakpoint().name,p=function(e,t,i){var n=pt(t,e),o=n.maxWidth,r=n.maxHeight;return i.filter((function(e){return!ht(e)||!y(o)||e[0]<=o})).filter((function(e){return!ht(e)||!y(r)||e[1]<=r}))}(this.browserWindow,o,null!==(t=a.sizeMapping[f])&&void 0!==t?t:[]),v=p.length>0?p:void 0,b=ft(p),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.registeredSlotConfig(n,r,a,o,s)),{currentlyActive:!1,storedAt:this.reporter.getElapsedTime(),breakpoint:f,sizes:v,sizesHb:b,path:a.slot,allowHeaderBidding:y(b)&&b.length>0&&this.settings.isHeaderBiddingSlot(a)}),a.mediaTypes&&{mediaTypes:a.mediaTypes}),a.videoAttributes&&{prebidVideoConfig:a.videoAttributes}),{gpid:u}),a.targeting&&{targeting:a.targeting}),this.allowSlotRefreshCallback?{isAllowRefresh:function(){return i.allowSlotRefreshCallback(n)}}:{}),{comboZoneEligible:h});if(this.REGISTERED_SLOTS[n]=m,this.SLOT_REFRESH_STRATEGY[n]=this.createRefreshStrategy(m),S(v))return this.logger.info("[SLOTS][".concat(n,"]: Registered as inactive because no sizes available")),m;var k=m,I=function(e,t,i,n){e.log("[SLOTS][".concat(t,"]: merge slot targeting ").concat(JSON.stringify(i),", ").concat(JSON.stringify(n)));var o=i;return null==n||n.forEach((function(e){o.find((function(t){return t.key===e.key}))||o.push({key:e.key,value:e.value})})),e.log("[SLOTS][".concat(t,"]: set slot targeting ").concat(JSON.stringify(o))),o}(this.logger,n,l,a.targeting);if(c)this.logger.info("[SLOTS][".concat(n,"]: Registering as active because it is forced")),this.registerActiveSlot(k,I);else if(a.activateCondition){var w=this.buildActivator(k,a.activateCondition,d,I,g);w.checkCondition()?(this.logger.info("[SLOTS][".concat(n,"]: Registering as active because conditions already satisfied")),this.registerActiveSlot(k,I)):(this.logger.info("[SLOTS][".concat(n,"]: Registering as inactive and enabling triggers")),this.registerInactiveSlot(k,w),w.enableTriggers())}else this.logger.log("[SLOTS][".concat(n,"]: Registering as active because no conditions defined")),this.registerActiveSlot(k,I);return this.slotInitialised.emit({}),m}},{key:"register",value:function(e,t,i,n){var o=this,r=e.map((function(e){return o.registerFuseSlot({slotDivId:e.slotDivId,zoneDiv:e.zoneDiv,zoneInstanceId:e.zoneInstanceId,zoneDivId:e.zoneDivId,zoneTemplate:e.zoneTemplate,gpid:e.gpid,targeting:e.targeting,forceActivate:i,api:t,runAuctionFn:n,comboZoneEligible:e.comboZoneEligible})})).filter(y);return this.logger.debug("[SLOTS]: Registered ".concat(r.length," slots")),this.slotsInitialised.emit({}),r}},{key:"clearFuseSkins",value:function(){this.logger.debug("[DOM]: Clearing fuse skins");for(var e=this.browserWindow.document.querySelectorAll("div.fuse-custom-skin"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])}},{key:"setAllowSlotRefreshCallback",value:function(e){this.allowSlotRefreshCallback=e,this.logger.debug("[SLOTS]: Registered setAllowSlotRefreshCallback")}},{key:"getSlotRefreshCount",value:function(e){var t;return null!==(t=this.slotRefreshCounts[e])&&void 0!==t?t:0}},{key:"incrementSlotRefreshCount",value:function(e){this.slotRefreshCounts[e]=this.getSlotRefreshCount(e)+1}}])}(),Qn=function(){return o((function e(t,n,o,r,s,a){var u=this;i(this,e),this.fuseSlotRegistry=t,this.zoneRegistry=n,this.logger=o,this.auctionScheduler=r,this.domProcessor=s,this.isTagInitialised=a,this.runAuctionFn=function(e){u.auctionScheduler.queueSlots(e),u.runAuction()}}),[{key:"registerAndQueue",value:function(e,t,i){var n=this.domProcessor.processSlots(e),o=this.registerSlots(n,i,t),r=o.filter((function(e){return e.currentlyActive}));return this.auctionScheduler.queueSlots(r),o}},{key:"registerAndRunAuction",value:function(e,t,i){var n=this.registerAndQueue(e,t,i);return this.runAuction(),n}},{key:"registerZoneAndQueue",value:function(e,t,i,n){var o=this.domProcessor.processZoneWithDivId(e,t);if(!o)return null;var r=this.registerSlots([o],n,i)[0];return(null==r?void 0:r.currentlyActive)&&this.auctionScheduler.queueSlots([r]),r}},{key:"activateZone",value:function(e){this.zoneRegistry.activateZone(e)}},{key:"registerAndQueueLastSlotWithFuseId",value:function(e,t,i,n){var o=this.domProcessor.processLastSlotWithFuseId(e,t);if(o){var r=this.registerSlots([o],n,i)[0];return r&&r.currentlyActive&&this.auctionScheduler.queueSlots([r]),r}}},{key:"registerSlots",value:function(e,t,i){var n=this;return e.forEach((function(e){n.zoneRegistry.register(e)})),this.fuseSlotRegistry.register(e,t,i,this.runAuctionFn)}},{key:"runAuction",value:function(){return this.isTagInitialised()?this.auctionScheduler.runAuction():(this.logger.info("[CONTROLLER] Deferred the auction start until the tag is initialised"),!1)}},{key:"forceRunAuction",value:function(e){var t=this.fuseSlotRegistry.getSlot(e);t?this.auctionScheduler.forceRunAuction(t):this.logger.warn("[CONTROLLER]: Could not force auction because slot ".concat(e," not found"))}},{key:"runAuctionAllActiveSlots",value:function(){this.auctionScheduler.queueSlots(this.fuseSlotRegistry.getActiveSlots()),this.runAuction()}},{key:"reset",value:function(){this.logger.log("[CONTROLLER]: resetSlots()"),this.fuseSlotRegistry.reset(),this.auctionScheduler.reset(),this.zoneRegistry.reset()}},{key:"destroyZone",value:function(e){this.zoneRegistry.deleteZone(e);var t=this.fuseSlotRegistry.getSlotByZoneDivId(e);t?this.fuseSlotRegistry.deleteSlot(t.slotDivId):this.logger.debug("[CONTROLLER] Registered slot for zoneDivId ".concat(e," not found upon deletion"))}},{key:"destroyAllRefresh",value:function(){this.fuseSlotRegistry.destroyAllRefresh()}},{key:"enableAllRefresh",value:function(){this.fuseSlotRegistry.enableAllRefresh()}},{key:"getAllRefresh",value:function(){return this.fuseSlotRegistry.getAllRefresh()}},{key:"handleBreakpointChange",value:function(){this.auctionScheduler.clearPendingAuctions(),this.auctionScheduler.clearAuctionBlock(),this.fuseSlotRegistry.destroyAllRefresh();var e=this.fuseSlotRegistry.getActiveSlots();this.auctionScheduler.queueSlots(e),this.auctionScheduler.runAuction()}},{key:"loadSlots",value:function(e,t,i){if(!e)return this.logger.warn("[CONTROLLER]: loadSlots() called during initialisation. Translating call to registerSlots() to avoid reset"),void this.registerAndRunAuction(!0,!1,t);i(),this.registerAndQueue(!1,!1,t),this.runAuction()}}])}(),Kn=function(){return o((function e(t,n,o){i(this,e),this.logger=t,this.reporter=n,this.zoneEventEmitter=o,this.DELETED_ZONES=[],this.REGISTERED_ZONES={},this.MANUAL_ACTIVATE_API={},this.templateUsageCounts={}}),[{key:"register",value:function(e){var t=e.zoneInstanceId;if(!this.REGISTERED_ZONES[t]){var i=e.zoneDivId?this.findByDivId(e.zoneDivId):void 0;if(i){var n=i.zoneDiv,o=i.zoneInstanceId;if(o===t)return void this.logger.error("[ZONE][".concat(o,"]: Ignoring unexpected re-registration"));this.logger.warn("[ZONE][".concat(o,"]: Div ").concat(n.id," replaced in DOM without pageInit(). Registering ").concat(t)),this.DELETED_ZONES.push(o),delete this.REGISTERED_ZONES[o],delete this.MANUAL_ACTIVATE_API[o]}this.logger.info("[ZONE][".concat(t,"]: Registered with DivId ").concat(e.zoneDiv.id)),this.reporter.reportFirstZone();var r={zoneInstanceId:t,zoneDiv:e.zoneDiv,zoneDivId:e.zoneDivId,zoneTemplateId:e.zoneTemplate.id,gpid:e.gpid};return this.REGISTERED_ZONES[t]=r,r}this.logger.error("[ZONE][".concat(t,"]: Already registered"))}},{key:"isDeletedZone",value:function(e){return-1!==this.DELETED_ZONES.indexOf(e)}},{key:"findByDivId",value:function(e){var t=this;return Object.keys(this.REGISTERED_ZONES).map((function(e){return t.REGISTERED_ZONES[e]})).filter((function(t){return t.zoneDivId==e})).shift()}},{key:"activateZone",value:function(e){var t=this.findByDivId(e);if(!t)return this.logger.error("[ZONE][".concat(e,"]: Unknown zone")),!1;var i=t.zoneInstanceId;return!this.MANUAL_ACTIVATE_API[i]&&(this.MANUAL_ACTIVATE_API[i]=!0,this.zoneEventEmitter.emit({zoneTemplateId:t.zoneTemplateId,zoneDivId:t.zoneDivId,zoneEventType:"activate_zone_api",instanceId:t.zoneInstanceId,gpid:t.gpid,slotDivId:t.zoneDiv.id}),!0)}},{key:"isManuallyActivated",value:function(e){var t;return this.REGISTERED_ZONES[e]?null!==(t=this.MANUAL_ACTIVATE_API[e])&&void 0!==t&&t:(this.logger.error("[ZONE][".concat(e,"]: Unknown zone")),!1)}},{key:"getRegisteredZones",value:function(){var e=this;return Object.keys(this.REGISTERED_ZONES).map((function(t){return e.REGISTERED_ZONES[t]}))}},{key:"reset",value:function(){var e=this;Object.keys(this.REGISTERED_ZONES).forEach((function(t){e.isDeletedZone(t)?e.logger.debug("[EVENT]: resetSlots() unit already deleted ".concat(t)):e.DELETED_ZONES.push(t)})),this.MANUAL_ACTIVATE_API={},this.REGISTERED_ZONES={}}},{key:"deleteZone",value:function(e){var t=this.findByDivId(e);t?this.isDeletedZone(t.zoneInstanceId)?this.logger.warn("[ZONE][".concat(e,"]: Deleted zone")):(delete this.REGISTERED_ZONES[t.zoneInstanceId],this.DELETED_ZONES.push(t.zoneInstanceId)):this.logger.warn("[ZONE][".concat(e,"]: Unknown zone"))}},{key:"getTemplateUsageCount",value:function(e){var t;return null!==(t=this.templateUsageCounts[e])&&void 0!==t?t:0}},{key:"incrementTemplateUsageCount",value:function(e){this.templateUsageCounts[e]=this.getTemplateUsageCount(e)+1}}])}(),Xn=!1,$n=E.getLogger(),eo=function(){return E.getBrowserWindowObject().fusetag.que},to=function(){$n.debug("[QUEUE]: Cleared fuse queue with ".concat(io()," remaining items")),eo().splice(0,eo().length)},io=function(){return eo().length};function no(){if(Xn)$n.error("[INIT] processBacklog() called, but it already ran");else{for(Xn=!0,$n.log("[INIT]: Processing fuse queue with ".concat(eo().length," pending items"));eo().length>0;){var e=eo().shift();if("function"==typeof e)try{$n.debug("[INIT]: Calling queued function"),e.call(),e.called=!0}catch(e){$n.error("[INIT]: Error calling queued function:",e.message,e.stack)}else $n.error("[INIT]: Commands written into fusetag.que.push must be wrapped in a function")}eo().push=function(e){if("function"==typeof e)try{e.call()}catch(e){$n.error("Error processing command :",e.message,e.stack)}else $n.error("Commands written into fusetag.que.push must be wrapped in a function");return 0}}}var oo=function(){return o((function e(t,n){var o=this;i(this,e),this.f=n,t.immediateOrOnce((function(e){return o.f=e}))}),[{key:"value",get:function(){return this.f}},{key:"asSupplier",value:function(){var e=this;return function(){return e.f}}}])}();function ro(e,t){if(!e||!t)return!1;var i=new URL(e),n=new URL(t);return i.hash="",n.hash="",i.toString()==n.toString()}var so=function(){return o((function e(t,n,o,r,s,a,u,l){var c=this;i(this,e),this.logger=t,this.initialUrl=n,this.resetPageFn=o,this.setAuctionBlockFn=r,this.setPageTargeting=s,this.events=a,this.currentBreakpoint=u,this.lowDwellPages=l,this.lastPageInitUrl=null,this.afsPageParams=null,this.tagInitOnce=new oo(this.events.onTagInitComplete),this.events.onTagInitComplete.immediateOrOnce((function(e){c.emitPageInit(e.tagInitUrl,!1)}))}),[{key:"reset",value:function(){this.logger.info("[PAGE]: Resetting all page state"),this.resetPageFn(),this.emitPageReset()}},{key:"handlePageInitCall",value:function(e,t,i){var n;this.logger.info("[PAGE]: pageInit('".concat(e,"', ").concat(t,", ").concat(JSON.stringify(i)));var o,r=null===this.lastPageInitUrl,s=y(this.tagInitOnce.value);if(r)if(s){if(ro(e,this.initialUrl))return void this.logger.warn("[PAGE]: Ignored pageInit(), because URL unchanged since tag init");this.logger.info("[PAGE]: First pageInit() call, and URL changed since tag init. Resetting."),this.reset(),o=!0}else o=!1;else if(ro(e,this.lastPageInitUrl)){if(!(null==i?void 0:i.forceReset))return void this.logger.warn("[PAGE]: Ignored pageInit(), because URL unchanged since last pageInit call");this.logger.debug("[PAGE]: pageInit call with forceReset=true. Resetting."),this.reset()}else this.logger.info("[PAGE]: pageInit() called, and the URL has changed. Resetting."),o=!0,this.reset();this.lastPageInitUrl=e,(null==i?void 0:i.pageTargets)&&this.setPageTargeting(null==i?void 0:i.pageTargets),(null==i?void 0:i.blockingFuseIds)&&this.setBlock(null!==(n=null==i?void 0:i.blockingTimeout)&&void 0!==n?n:2e3,i.blockingFuseIds,o,t),(null==i?void 0:i.afsPageParams)&&(this.afsPageParams=i.afsPageParams),s&&this.emitPageInit(e,!0)}},{key:"isPageInitCalled",value:function(){return y(this.lastPageInitUrl)}},{key:"isLowDwellUrl",value:function(e){return this.lowDwellPages.filter((function(t){var i=e.match(t);return i&&i.length>0})).length>0}},{key:"emitPageInit",value:function(e,t){var i=Object.assign({url:e,isPageTransition:t,isLowDwellPage:this.isLowDwellUrl(e),breakpoint:this.currentBreakpoint().name},this.afsPageParams?{afsPageParams:this.afsPageParams}:{});this.events.onPageInit.emit(i)}},{key:"emitPageReset",value:function(){this.events.onPageReset.emit({breakpoint:this.currentBreakpoint().name})}},{key:"setBlock",value:function(e,t,i,n){var o=i?e:e-n;if(o<=0)this.logger.info("[PAGE][pageInit]: Skipped setting auction block, because there is no time left on the timeout");else{var r=t.map((function(e){return"".concat(e)}));this.setAuctionBlockFn(r,o)}}}])}(),ao=E.getLogger(),uo=[];function lo(){ao.info("[TARGETING] Clearing page targeting"),function(e){qt((function(){e.forEach((function(e){_t.pubads().clearTargeting(e.key)}))}))}(uo),uo=[]}function co(e,t){var i=-1;uo.forEach((function(t,n){-1===i&&t.key===e&&(i=n)})),ao.info("[TARGETING]: Updating custom targeting for [key: ".concat(e,", value: ").concat(t,"]")),i>-1?uo[i].value=t:uo.push({key:e,value:t}),function(e,t){qt((function(){return Qt(e,t)}))}(e,t)}var go=function(){return o((function e(t,n,o,r,s,a,u,l,c,d){i(this,e),this.logger=t,this.settingsGlobal=n,this.slotsController=o,this.slotRegistry=r,this.zoneRegistry=s,this.auctionScheduler=a,this.insertConditionFactory=u,this.slotConditionFactory=l,this.events=c,this.viewportInfo=d,this.settings=new ho(this.settingsGlobal)}),[{key:"getCurrentBreakpointName",value:function(){return this.viewportInfo.getCurrentBreakpoint().name}},{key:"getWindow",value:function(){return this.viewportInfo.browserWindow}},{key:"registerAll",value:function(){this.logger.debug("[APIV3]: registerAll() started");var e=this.slotsController.registerAndRunAuction(!0,!1,this);this.logger.debug("[APIV3]: registerAll() finished, ".concat(e.length," slots found"))}},{key:"processNewSlots",value:function(){this.registerAll()}},{key:"registerZone",value:function(e){this.logger.debug("[APIV3]: registerZone('".concat(e,"') started"));var t=this.slotsController.registerZoneAndQueue(e,!0,!1,this);return t&&this.slotsController.runAuction(),t}},{key:"queueZone",value:function(e){return this.logger.debug("[APIV3]: queueZone('".concat(e,"') started")),this.slotsController.registerZoneAndQueue(e,!0,!1,this)}},{key:"runAuction",value:function(){return this.logger.debug("[APIV3]: runAuction() started"),this.slotsController.runAuction()}},{key:"disableRefreshByZone",value:function(e){return this.slotRegistry.disableRefreshBySlotId(e)}},{key:"enableRefreshByZone",value:function(e){return this.slotRegistry.enableRefreshBySlotId(e)}},{key:"getSlotsForTemplateId",value:function(e){return this.slotRegistry.getSlotsForTemplateId(e)}}])}(),ho=function(){return o((function e(t){i(this,e),this.settings=t}),[{key:"getZoneTemplate",value:function(e){return this.settings.getZoneTemplate(e)}},{key:"setDisableWidgetRenderer",value:function(e){this.settings.getV2CompatOverrides().disableWidgetsRenderer=e}},{key:"setForceSafeFrames",value:function(e){this.settings.setForceSafeFrames(e)}}])}(),fo=function(){return o((function e(t,n,o,r,s){var a=this;i(this,e),this.browserWindow=t,this.viewportInfo=n,this.fuseSlotRegistry=o,this.gptRegisterSlotRenderEndedCallbackAsyncFn=r,this.requestMethod=s,this.slots={},this.gptRegisterSlotRenderEndedCallbackAsyncFn((function(e){return a.handleSlotRenderEndedEvent(e)}))}),[{key:"handleSlotRenderEndedEvent",value:function(e){var t,i=e.slot.getSlotElementId(),n=this.fuseSlotRegistry.getZoneTemplates()[i],o=this.browserWindow.document.getElementById(i);if(n){var r={creativeId:e.creativeId,advertiserId:e.advertiserId,lineItemId:e.lineItemId,orderId:e.campaignId,respSizes:e.size,reqSizes:n.sizeMapping[this.viewportInfo.getCurrentBreakpoint().name],googleQueryId:null!==(t=null==o?void 0:o.getAttribute("data-google-query-id"))&&void 0!==t?t:null},s=this.slots[i];m(s)||0==s.length?this.slots[i]=[r]:1==s.length?this.slots[i]=[].concat(d(s),[r]):2==s.length&&(this.slots[i]=[].concat(d(s.slice(1)),[r]))}}},{key:"reportSlotInfo",value:function(e,t){var i={email:null==t?void 0:t.email,url:this.browserWindow.location.href,datetimeStamp:(new Date).toLocaleString(),slots:this.slots};if(null==t?void 0:t.authHeader)return this.requestMethod(e,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:t.authHeader},body:JSON.stringify(i)}).then((function(){alert("Blocking request sent.")})).catch((function(){alert("Error occurred while sending blocking request. Please reach out to the customer support team.")}));this.requestMethod(e,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json",Authorization:(null==t?void 0:t.authHeader)||""},body:JSON.stringify(i)}),alert("Blocking request sent. Please reach out to the customer support team to update your bookmarklet")}}])}();E.getLogger();var po=function(){return o((function e(t,n,o){i(this,e),this.browserWindow=t,this.events=n,this.logger=o,this.i2wcbid=1}),[{key:"getIn2wCallbackId",value:function(){return this.i2wcbid+++""}},{key:"enable",value:function(){var e=this;this.logger.debug("[INIT]: loadIn2wSafeframe"),this.browserWindow.addEventListener("message",(function(t){if(t.data&&"object"===h(t.data)&&void 0!==t.data.__i2wGPTEvent)try{var i=t.data.__i2wGPTEvent,n=i.i2wcbid,o=Zt().pubads().getSlots().find((function(e){return e.__i2wcbid===n}));if(o)switch(i.type){case"slotResponseReceived":e.logger.debug("[I2w]: emitting slotResponseReceived event: ".concat(JSON.stringify(t))),e.events.onSlotResponse.emit(Object.assign(Object.assign({},i.responseInformation),{slot:o,i2wcbid:n}));break;case"slotRenderEnded":e.logger.debug("[I2w]: emitting slotRenderEnded event: ".concat(JSON.stringify(t))),e.events.onSlotRender.emit(Object.assign(Object.assign({},i.responseInformation),{slot:o,i2wcbid:n}));break;case"slotOnload":e.logger.debug("[I2w]: emitting slotOnload event: ".concat(JSON.stringify(t))),e.events.onSlotLoaded.emit(Object.assign(Object.assign({},i.responseInformation),{slot:o,i2wcbid:n}));break;default:e.logger.warn("[I2w]: Unknown event type: ".concat(i.type,": ").concat(JSON.stringify(t)))}else e.logger.warn("[I2w]: no slot found with i2wcbid: ".concat(n))}catch(t){e.logger.error("[I2w]: Something wrong while processing safeframe gpt events: ".concat(t.toString()))}}))}}])}(),vo=function(){return o((function e(t,n,o,r){i(this,e),this.browserWindow=t,this.logger=n,this.settings=o,this.reporter=r,this.advertiserIds=[],this.pubIds=[],this.idsProvided=!1,this.advertiserIds=o.getGeoEdgeAdvertiserIds(),this.pubIds=o.getGeoEdgePubIds(),this.idsProvided=Boolean(this.advertiserIds.length||this.pubIds.length),this.key=o.getGeoEdgeKey()||"039fe8d9-5c1c-455e-812b-a926b44f77f9"}),[{key:"init",value:function(){var e,t=this;this.reporter.setStateStatus("geoedge_load_start"),this.logger.info("[INIT]: Initialising GeoEdge"),this.idsProvided&&this.logger.info("[INIT]: GeoEdge advertiser or publisher IDs found, setting config"),this.browserWindow.grumi=Object.assign(Object.assign({},this.idsProvided?{cfg:{advs:this.parseIds(this.advertiserIds),pubIds:this.parseIds(this.pubIds)}}:{}),{key:this.key}),D((e=this.key,{name:"GeoEdge",url:"//rumcdn.geoedge.be/",file:"".concat(e,"/grumi-ip.js")}),(function(){t.logger.info("[INIT]: GeoEdge script loaded"),t.reporter.setStateStatus("geoedge_load_finish")}))}},{key:"parseIds",value:function(e){return e.reduce((function(e,t){return Object.assign(Object.assign({},e),r({},t,!0))}),{})}}])}(),bo=function(){return o((function e(t,n,o,r){i(this,e),this.browserWindow=t,this.logger=n,this.settings=o,this.reporter=r,this.entityId=o.getAssertiveYieldEntityId()||"7oDcS2a8NXtFyxnDn"}),[{key:"init",value:function(){var e,t=this;this.reporter.setStateStatus("assertiveyield_load_start"),this.logger.info("[INIT]: Initialising AssertiveYield"),D((e=this.entityId,{name:"AssertiveYield",url:"//".concat(e,".ay.delivery/"),file:"s2s-client-v1.js"}),(function(){t.logger.info("[INIT]: AssertiveYield script loaded"),t.reporter.setStateStatus("assertiveyield_load_finish");var e=t.settings.getPrebidClientBidders(),i=t.settings.getPrebidServerBidders().reduce((function(t,i){var n=e.includes(i);return{hybridBidders:[].concat(d(t.hybridBidders),d(n?[i]:[])),serverOnlyBidders:[].concat(d(t.serverOnlyBidders),d(n?[]:[i]))}}),{hybridBidders:[],serverOnlyBidders:[]}),n=i.hybridBidders,o=i.serverOnlyBidders,r={orgId:"LiCgEBeRTmRgR6M2n",entityId:t.entityId,bidders:n,serverOnlyBidders:o,pbjs:"fusePbjs",continent:"NA",analytics:!t.settings.isPrebidServerAnalytics(),aliasRegistry:null,suffix:"_s2s",abPercentage:95};t.logger.info("[INIT]: AssertiveYield config ".concat(JSON.stringify(r))),t.browserWindow.ayS2STag.init(Object.assign(Object.assign({},r),{callback:function(e){}})),t.settings.isPrebidServerAnalytics()&&(t.reporter.setStateStatus("assertiveyieldanalytics_load_start"),t.logger.info("[INIT]: Initialising AssertiveYield Analytics"),t.initAnalytics(t.settings.getFuseUUID()))}))}},{key:"initAnalytics",value:function(e){var t,i=this;this.browserWindow.assertive={debug:!0,entityId:this.entityId,analytics:{integrations:{webAnalytics:!0},logUnfilled:!0,custom:{layout:null,userState:null,custom_1:e,custom_2:null,custom_3:null,custom_4:null,custom_5:null,custom_6:null,custom_7:null,custom_8:null,custom_9:null,custom_10:null,custom_11:null,custom_12:null,custom_13:null,custom_14:null,custom_15:null}}},D((t=this.entityId,{name:"AssertiveYieldAnalytics",url:"//".concat(t,".ay.delivery/"),file:"client-v2.js"}),(function(){i.logger.info("[INIT]: AssertiveYieldAnalytics script loaded"),i.reporter.setStateStatus("assertiveyieldanalytics_load_finish")}))}}])}(),mo=new(function(){return o((function e(){i(this,e)}),[{key:"getIn2wSafeframe",value:function(){return this.in2wSafeframeLoader||(this.in2wSafeframeLoader=new po(E.getBrowserWindowObject(),{onSlotResponse:He.onSlotResponse,onSlotLoaded:He.onSlotLoaded,onSlotRender:He.onSlotRender},E.getLogger())),this.in2wSafeframeLoader}},{key:"getGeoEdgeManager",value:function(){return this.geoEdgeManager||(this.geoEdgeManager=new vo(E.getBrowserWindowObject(),E.getLogger(),kt.getSettings(),Pt.getReporter())),this.geoEdgeManager}},{key:"getAssertiveYieldManager",value:function(){return this.assertiveYieldManager||(this.assertiveYieldManager=new bo(E.getBrowserWindowObject(),E.getLogger(),kt.getSettings(),Pt.getReporter())),this.assertiveYieldManager}}])}()),So=function(){return o((function e(t,n,o){i(this,e),this.logger=t,this.createFuseDivElement=n,this.templateSettings=o,this.eligibleCount=0,this.comboZoneCount=0,this.stylesAdded=!1,this.isComboZoneEnabled=this.templateSettings.isComboZoneEnabled(),this.isComboZoneYeRunning=this.templateSettings.isComboZoneYeRunning()}),[{key:"getTargeting",value:function(e,t){if(!this.isComboZoneYeRunning)return[];if(this.logger.info("[COMBO-ZONE][".concat(e.id,"]: Calculating comboZone targeting")),!e.attributes.comboZoneEnabled)return this.logger.info("[COMBO-ZONE][".concat(e.id,"]: ComboZone targeting is not applicable, returning an empty array")),[];var i=[{key:"fuse_exp_16-val",value:this.calculateTargetingValue(t)}];return this.logger.info("[COMBO-ZONE][".concat(e.id,"]: ComboZone targeting calculated with result: ").concat(JSON.stringify(i))),t.length>0&&this.eligibleCount++,i}},{key:"areMoreComboZonesAllowed",value:function(e){return e<1}},{key:"calculateTargetingValue",value:function(e){var t=e.length>0;if(t&&this.isComboZoneEnabled&&this.areMoreComboZonesAllowed(this.eligibleCount))return e[0].name;var i="ye-".concat(this.isComboZoneEnabled.toString()),n=t?"eligible":"ineligible";if(t){var o=this.areMoreComboZonesAllowed(this.eligibleCount)?"selected":"not-selected";return"".concat(i,"_").concat(n,"_").concat(o)}return"".concat(i,"_").concat(n)}},{key:"convert",value:function(e,t,i,n){var o,s=this;if(!(null===(o=t.sizeMapping)||void 0===o?void 0:o[i]))return this.logger.log("[COMBO-ZONE][".concat(t.id,"] no sizes found for breakpoint ").concat(i)),{zoneDivs:[e],template:t};e.setAttribute("data-fuse-combo",t.id),e.removeAttribute("data-fuse"),this.logger.log("[COMBO-ZONE][".concat(t.id,"] updated data-fuse to data-fuse-combo"));var a="fuse-zone-combo-".concat(n.name.replace("@","-"));e.classList.add(a),this.logger.log("[COMBO-ZONE][".concat(t.id,"] added class ").concat(a," to combo zone parent div"));var u=new Array(n.numZones).fill(0).map((function(){return s.createFuseDivElement.createDivElement(t.id,"fuse-slot-comboZone")}));this.logger.log("[COMBO-ZONE][".concat(t.id,"] created ").concat(u.length," slots for template")),e.append.apply(e,d(u)),this.addComboZoneStyles();var l=Object.assign(Object.assign({},t),{sizeMapping:Object.assign(Object.assign({},t.sizeMapping),r({},i,d(n.sizes)))});return this.logger.log("[COMBO-ZONE][".concat(t.id,"] Updated comboZone slot sizes to ").concat(JSON.stringify(n.sizes))),{zoneDivs:u,template:l}}},{key:"tryInitialize",value:function(e){var t,i,n,o,r,s,a,u,l=e.currentBp,c=e.comboZoneOptions,g=e.template,h=e.zoneDiv,f=this.templateSettings.isComboZoneEnabled()&&this.areMoreComboZonesAllowed(this.comboZoneCount)&&(null===(t=g.attributes)||void 0===t?void 0:t.comboZoneEnabled)&&c.length>0,p=(null===(i=g.attributes)||void 0===i?void 0:i.forceComboZone)&&(null===(n=null==g?void 0:g.comboZoneAttributes)||void 0===n?void 0:n.name);if(this.logger.debug("[COMBO-ZONE][".concat(g.id,"]: Checking if template can be used as Combo zone ").concat(JSON.stringify({isComboZoneQualified:{count:this.comboZoneCount,enabled:null===(o=g.attributes)||void 0===o?void 0:o.comboZoneEnabled,comboZoneOptions:c},isComboZoneForced:{forced:null===(r=g.attributes)||void 0===r?void 0:r.forceComboZone,eligible:null===(s=g.comboZoneAttributes)||void 0===s?void 0:s.name}}))),!f&&!p){this.logger.info("[COMBO-ZONE][".concat(g.id,"]: Template wasn't be picked for comboZone"));var v=this.getTargeting(g,c);return{zoneDivs:[h],template:Object.assign(Object.assign({},g),{targeting:[].concat(d(g.targeting||[]),d(v))}),comboZoneVal:null===(a=v[0])||void 0===a?void 0:a.value}}this.logger.info("[COMBO-ZONE][".concat(g.id,"]: Using template as Combo zone")),p||++this.comboZoneCount;var b=bt(p?g.comboZoneAttributes.name:c[0].name);this.logger.log("[COMBO-ZONE][".concat(g.id,"]: Picked attributes for the comboZone: ").concat(JSON.stringify(b)));var m=this.convert(h,g,l,b),S=m.zoneDivs,y=m.template,k=this.getTargeting(y,c);return{zoneDivs:S,template:Object.assign(Object.assign({},y),{targeting:[].concat(d(y.targeting||[]),d(k))}),comboZoneVal:null===(u=k[0])||void 0===u?void 0:u.value}}},{key:"addComboZoneStyles",value:function(){this.stylesAdded||(this.createFuseDivElement.insertStyles("publift-fuse-combozone-styles",this.getComboZoneStyles()),this.stylesAdded=!0)}},{key:"getComboZoneStyles",value:function(){return"\n      .fuse-zone-combo-V2-300x250, .fuse-zone-combo-V2-728x90 {\n        display: flex;\n        flex-direction: column;\n      }\n      .fuse-zone-combo-V2-300x250 .fuse-slot-comboZone, .fuse-zone-combo-V2-728x90 .fuse-slot-comboZone {\n        margin-bottom: 10px;\n      }\n      .fuse-zone-combo-H2-300x250, .fuse-zone-combo-H3-300x250 {\n        display: flex;\n        flex-direction: row;\n        justify-content: center;\n      }\n      .fuse-zone-combo-H2-300x250 .fuse-slot-comboZone, .fuse-zone-combo-H3-300x250 .fuse-slot-comboZone {\n        padding-right: 10px;\n      }\n    "}}])}(),yo=function(){return o((function e(){i(this,e)}),[{key:"configureResponsive",value:function(){var e=this,t=new oo(He.onTagInitComplete);He.onBreakpointChanged.subscribe((function(i){E.getLogger().info("[RESPONSIVE]: Switching page to breakpoint '".concat(i.name,"'")),e.resetAfterChangedBreakpoint(),y(t.value)?e.getController().registerAndRunAuction(!0,!1,e.getApiV3()):e.getController().registerAndQueue(!0,!1,e.getApiV3())}))}},{key:"getAuctionExecutor",value:function(){if(!this.auctionExecutor){var e=kt.getSettings();this.auctionExecutor=new In(this.getFuseSlotRegistry(),gn.getPrebidGlobal(),mn.getUam(),E.getLogger(),Pt.getReporter(),e,He,gt.getTouchObserver(),Yt,e.getUseTelemetry()?Pt.getTelemetry():void 0)}return this.auctionExecutor}},{key:"getFuseSlotRegistry",value:function(){return this.fuseSlotRegistry||(this.fuseSlotRegistry=new Jn(E.getLogger(),Pt.getReporter(),E.getBrowserWindowObject(),sn.getGptSlotRegistry(),kt.getSettings(),on.getSlotConditionFactory(),gt.getViewportInfo(),He,gn.getPrebidSlotRegistrator(),(function(){return mo.getIn2wSafeframe().getIn2wCallbackId()}),this.getAuctionScheduler())),this.fuseSlotRegistry}},{key:"getZoneRegistry",value:function(){return this.zoneRegistry||(this.zoneRegistry=new Kn(E.getLogger(),Pt.getReporter(),He.onZoneEvent)),this.zoneRegistry}},{key:"getAuctionScheduler",value:function(){var e=this;return this.auctionScheduler||(this.auctionScheduler=new En(E.getLogger(),(function(){var t;return(t=e.getAuctionExecutor()).executeAuction.apply(t,arguments)}),(function(t,i){return e.getAuctionPlanner().plan(t,i)}),(function(t){return e.getFuseSlotRegistry().isDeletedSlot(t)}),(function(){return gt.getViewportInfo().getCurrentBreakpoint().name}),gt.getViewportInfo(),kt.getSettings(),(function(e,t){return co(e,t)}),(function(){return e.getFuseSlotRegistry().getActiveSlots()}))),this.auctionScheduler}},{key:"getAuctionPlanner",value:function(){return this.auctionPlanner||(this.auctionPlanner=new wn(E.getLogger(),kt.getSettings(),gt.getViewportInfo(),(function(){return un.getInitManager().isLowDwellPage()}),Pt.getComponentStatusStore())),this.auctionPlanner}},{key:"getController",value:function(){return this.controller||(this.controller=new Qn(this.getFuseSlotRegistry(),this.getZoneRegistry(),E.getLogger(),this.getAuctionScheduler(),this.getDomProcessor(),(function(){return un.getInitManager().isTagInitialised()}))),this.controller}},{key:"getDomProcessor",value:function(){var e=this;return this.domProcessor||(this.domProcessor=new An(E.getLogger(),E.getBrowserWindowObject(),kt.getSettings(),this.getFuseSlotFormatter(),(function(){return Pt.getReporter().getElapsedTime()}),(function(){return e.getApiV3()}),this.getComboZoneManager(),Pt.getComboZoneState())),this.domProcessor}},{key:"getComboZoneManager",value:function(){return this.comboZoneManager||(this.comboZoneManager=new So(E.getLogger(),gt.getCreateFuseDivElement(),kt.getSettings())),this.comboZoneManager}},{key:"getFuseSlotFormatter",value:function(){return this.fuseSlotFormatter||(this.fuseSlotFormatter=new Rn(E.getLogger(),kt.getSettings(),gt.getViewportInfo())),this.fuseSlotFormatter}},{key:"getPageManager",value:function(){var e=this;if(!this.pageManager){var t=kt.getSettings();this.pageManager=new so(E.getLogger(),E.getBrowserWindowObject().location.href,(function(){return e.resetPage()}),(function(e,i){t.isSpaOldBlockingPageInit()||ko.getAuctionScheduler().setAuctionBlock(e,i)}),(function(e){return function(e){e.forEach((function(e){return co(e.key,e.value)}))}(e)}),He,gt.getViewportInfo().breakpointSupplier(),t.getLowDwellPages())}return this.pageManager}},{key:"resetAfterChangedBreakpoint",value:function(){sn.getGptSlotRegistry().purgeAll(),Vn.reset(),this.getController().reset()}},{key:"resetPage",value:function(){lo(),to(),Xt(),Pt.getGptCountManager().resetCounts(),Bt=!0,sn.getGptSlotRegistry().purgeAll(),Vn.reset(),ko.getController().reset(),lo(),to()}},{key:"getApiV3",value:function(){return this.apiV3||(this.apiV3=new go(E.getLogger(),kt.getSettings(),this.getController(),this.getFuseSlotRegistry(),this.getZoneRegistry(),this.getAuctionScheduler(),on.getInsertConditionFactory(),on.getSlotConditionFactory(),He,gt.getViewportInfo())),this.apiV3}},{key:"getSlotInfo",value:function(){var e=Et(E.getBrowserWindowObject(),E.getLogger(),Pt.getDeviceInfo().getBrowser(),"slotInfo");return this.slotInfo||(this.slotInfo=new fo(E.getBrowserWindowObject(),gt.getViewportInfo(),this.getFuseSlotRegistry(),(function(e){return He.onSlotRender.subscribe(e)}),e)),this.slotInfo}}])}(),ko=new yo,Io=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},wo="publift-fuse-afs-injection",Eo=function(){return o((function e(t,n,o,r,s,a){var u=this;i(this,e),this.logger=t,this.reporter=n,this.browserWindow=o,this.settings=r,this.events=s,this.fuseSlotRegistry=a,this.personalizedAds=!1,this.inited=!1,this.afsPageParams=null,this.settings.isCmpRequired()||(this.logger.log("[AFS]: Personalized ads set to true by isCmpRequired"),this.personalizedAds=!0),this.events.onPageInit.subscribe((function(e){var t;u.inited=!1,u.afsPageParams=null!==(t=e.afsPageParams)&&void 0!==t?t:u.extractPageParams(),setTimeout((function(){return u.init(!0)}),2e3)})),this.events.onAuctionEvent.subscribe((function(){return u.init()})),this.events.onPageReset.subscribe((function(){u.removeAfs(),u.inited=!1})),this.events.onComponentInitEvent.subscribe((function(e){"cmp"===e.component&&"ready"===e.state._tag&&e.state.output.allowPersonalisation&&(u.logger.log("[AFS]: Personalized ads allowed by CMP output ".concat(JSON.stringify(e.state.output))),u.personalizedAds=!0)}))}),[{key:"extractPageParams",value:function(){try{var e=new RegExp(this.settings.getAfsSettings().urlPattern).exec(this.browserWindow.location.href);if(e)return this.logger.log("[AFS]: Page params extracted",e),{query:null==e?void 0:e[1],page:null==e?void 0:e[2]}}catch(e){this.logger.error("[AFS]: Error extracting page params",e)}}},{key:"getZones",value:function(){return this.fuseSlotRegistry.getActiveSlots().filter((function(e){var t;return!0===(null===(t=e.zoneTemplate.attributes)||void 0===t?void 0:t.afs)})).map((function(e){return e.zoneTemplate}))}},{key:"loadLibrary",value:function(){var e=this;this.reporter.setStateStatus("afs_load_start");var t=this.browserWindow.document,i=t.createElement("script");i.type="text/javascript",i.innerHTML="\n    (function(g,o){g[o]=g[o]||function(){(g[o]['q']=g[o]['q']||[]).push(\n      arguments)},g[o]['t']=1*new Date})(window,'_googCsa');\n    ",t.querySelector("head").appendChild(i),D({name:"Afs",url:"//www.google.com/adsense/search/",file:"ads.js",insertSelector:"head"},(function(){e.logger.log("[AFS]: Script loaded"),e.reporter.setStateStatus("afs_load_finish")}))}},{key:"inject",value:function(e,t,i,n){var o=this,r=function(e){return e.enabled,e.urlPattern,Io(e,["enabled","urlPattern"])}(this.settings.getAfsSettings()),s=Object.assign(Object.assign({},r),{query:e,adPage:i,personalizedAds:this.personalizedAds,styleId:null!=n?n:r.styleId});this.logger.log("[AFS]: Page options ".concat(JSON.stringify(s)));var a="var pageOptions = ".concat(JSON.stringify(s),";"),u=t.sort((function(e,t){var i,n;return Number(null===(i=t.afsAttributes)||void 0===i?void 0:i.maxTop)-Number(null===(n=e.afsAttributes)||void 0===n?void 0:n.maxTop)})).map((function(e,t){var i,n=o.browserWindow.document.querySelector('[data-fuse="'.concat(e.id,'"]'));if(n){var r=e.afsAttributes;0!==t&&Number(null===(i=e.afsAttributes)||void 0===i?void 0:i.maxTop)&&(o.logger.warn("[AFS]: Zone ".concat(e.id," has maxTop set but is not the first zone. maxTop will be ignored")),r.maxTop=void 0);var s=Object.assign(Object.assign({},e.afsAttributes),{container:n.id}),u="adblock".concat(t+1);return o.logger.log("[AFS][".concat(e.id,"]: Container options ").concat(JSON.stringify(s))),a+="var ".concat(u," = ").concat(JSON.stringify(s),";"),u}o.logger.warn("[AFS]: No container found for zone ".concat(e.id))})).filter((function(e){return e}));if(u.length){a+="_googCsa('ads', pageOptions, ".concat(u.join(", "),");");var l=document.createElement("script");l.type="text/javascript",l.id=wo,l.innerHTML=a,document.head.appendChild(l)}}},{key:"init",value:function(e){this.inited||(this.inited=!0,this.logger.log("[AFS]: Inited by ".concat(e?"timeout":"auction")),this.initPage(this.getZones(),this.afsPageParams))}},{key:"reset",value:function(e){this.logger.debug("[API]: resetting with ".concat(JSON.stringify(e),"')")),e&&(this.afsPageParams=e),this.initPage(this.getZones(),this.afsPageParams,!0)}},{key:"initPage",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.length)if(t){var n=t.query,o=t.page,r=t.styleId;if(n){var s=this.browserWindow.document.getElementById(wo);if(s){if(!i)return void this.logger.log("[AFS]: Already initialized");s.remove()}this.inject(n,e,o,r)}else this.logger.log("[AFS]: No query provided")}else this.logger.log("[AFS]: No page params found. Skip init");else this.logger.log("[AFS]: No zones provided. Skip init")}},{key:"removeAfs",value:function(){var e=document.getElementById(wo);null==e||e.remove()}}])}(),Co=new(function(){return o((function e(){i(this,e)}),[{key:"getAfsManager",value:function(){return this.afsManager||(this.afsManager=new Eo(E.getLogger(),Pt.getReporter(),E.getBrowserWindowObject(),kt.getSettings(),He,ko.getFuseSlotRegistry())),this.afsManager}}])}()),To=function(){return o((function e(t,n,o,r){i(this,e),this.logger=t,this.settings=n,this.insertFactory=o,this.apiV3=r,this._hasInterstitial=!1}),[{key:"hasInterstitial",get:function(){return this._hasInterstitial}},{key:"initInterstitial",value:function(){var e=this;if(this._hasInterstitial)this.logger.log("[INTERSTITIAL]: Already present");else{this.logger.info("[INTERSTITIAL]: Initialising");var t=this.getInterstitialSlot();if(null==t?void 0:t.injectConditionConfig){var i=this.insertFactory.buildActivator(t.injectConditionConfig,t.id,this.apiV3,(function(){e.setInterstitialSlot(t)}));i.checkCondition()?this.setInterstitialSlot(t):i.enableTriggers()}else t&&this.setInterstitialSlot(t)}}},{key:"clearInterstitial",value:function(){if(this._hasInterstitial){this.logger.info("[INTERSTITIAL]: Clearing");var e,t,i=this.getInterstitialSlot();i&&(e=i.slot,t=_t.pubads().getSlots().filter((function(t){return t.getOutOfPage()&&e===t.getAdUnitPath()})),ni(t),this._hasInterstitial=!1)}else this.logger.log("[INTERSTITIAL]: No interstitial to clear")}},{key:"getInterstitialSlot",value:function(){return this.settings.getFuseSlots().find((function(e){var t=e.attributes;return!0===(null==t?void 0:t.interstitial)}))}},{key:"setInterstitialSlot",value:function(e){var t,i;t=e,(i=_t.defineOutOfPageSlot(t.slot,_t.enums.OutOfPageFormat.INTERSTITIAL))?(i.addService(_t.pubads()),_t.enableServices(),_t.display(i),Kt(),Mt.info("[GPT]: Requesting interstitial refresh for ".concat(i.getSlotElementId())),_t.pubads().refresh([i],{changeCorrelator:!1})):Mt.warn("setInterstitialSlot(): googletag.defineOutOfPageSlot returned undefined"),this._hasInterstitial=!0}}])}(),xo=function(){return o((function e(t,n,o,r){i(this,e),this.slot=t,this.logger=n,this.viewportInfo=o,this.createFuseDivElement=r}),[{key:"getSlotNonFluidSizes",value:function(){var e,t,i=this.viewportInfo.getCurrentBreakpoint().name;return null===(t=null===(e=this.slot.sizeMapping)||void 0===e?void 0:e[i])||void 0===t?void 0:t.filter((function(e){return"fluid"!==e}))}},{key:"getSlotMaxNonFluidHeight",value:function(){var e=this.getSlotNonFluidSizes(),t=e?e.map((function(e){return Number(e[1])})):[];return t.length?Math.max.apply(Math,d(t)):0}},{key:"createSlotElement",value:function(){return this.createFuseDivElement.createDivElement(this.slot.id,"fuse-slot-".concat(this.type))}},{key:"toHTML",value:function(e){return this.createFuseDivElement.toHTML(e)}},{key:"getSlotMaxNonFluidWidth",value:function(){var e=this.getSlotNonFluidSizes(),t=e?e.map((function(e){return Number(e[0])})):[];return t.length?Math.max.apply(Math,d(t)):0}},{key:"getLogContext",value:function(){return"[".concat(this.type,"][").concat(this.slot.id,"]:")}},{key:"getClassName",value:function(){return"publift-widget-".concat(this.slot.id)}},{key:"getContainerElement",value:function(){return document.querySelector(".".concat(this.getClassName(),"-container"))}},{key:"getStylesElement",value:function(){return document.querySelector("#".concat(this.getClassName(),"-styles"))}},{key:"getWidgetElement",value:function(){return document.querySelector(".".concat(this.getClassName()))}}])}(),_o=function(e){function n(e,o,r,s,a,u,l){var c,d,g=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return i(this,n),(c=t(this,n,[e,o,r,s])).slot=e,c.logger=o,c.viewportInfo=r,c.createFuseDivElement=s,c.registerAdRendered=a,c.apiV3=u,c.onShowCloseCallback=l,c.waitForCreative=g,c.loadingByCreative=!1,c.hiddenForever=!1,c.hasLoadedCreative=!1,c.type="sticky",c.barScrollHeight=0,c.barHeight=60,c.scrollingHeight=500,c.scrollCreative=!1,c.creativeHeight=0,c.scrollOffset=0,c.scrollPosition=0,c.scrollMultiplier=0,c.slotRenderCallbackRegistered=!1,c.attributes=c.makeAttributes(),c.scrollCreative=(null===(d=c.slot.stickyAttributes)||void 0===d?void 0:d.scrollCreative)||!1,c.scrollableElement=c.getScrollableElement(),c.setHeights(0),c}return a(n,e),o(n,[{key:"getScrollableElement",value:function(){var e,t;if(null===(e=this.slot.stickyAttributes)||void 0===e?void 0:e.scrollableSelector){var i=Ui(this.viewportInfo.browserWindow.document,this.logger,null===(t=this.slot.stickyAttributes)||void 0===t?void 0:t.scrollableSelector);if(i)return i}return this.viewportInfo.browserWindow}},{key:"createWidget",value:function(e){var t=this.getClassName();return this.toHTML('\n<div class="'.concat(t,'-container closed" style="display: ').concat(0===e?"none":"block",'">\n<div class="').concat(t,'-container-background">\n</div>\n  <div class="').concat(t,'-button">\n    <div></div>\n    <div></div>\n  </div>\n  <div class="').concat(t,'">\n  </div>\n</div>\n'))}},{key:"getHideAtSelector",value:function(){return this.getAttributes().hideSelector}},{key:"getHideAtElement",value:function(){var e=this.getHideAtSelector();return e?Ui(document,this.logger,e):null}},{key:"getFixedElement",value:function(){var e=this.getAttributes().fixedSelector;return e?Ui(document,this.logger,e):null}},{key:"getFixedClass",value:function(){return"".concat(this.getClassName(),"-fixed")}},{key:"getWidgetCloseButtonElement",value:function(){return document.querySelector(".".concat(this.getClassName(),"-button"))}},{key:"makeAttributes",value:function(){var e=Object.assign({bgColor:"#EFEFEF",bgOpacity:.7,allowClose:!1,buttonColor:"#313131",barColor:"#EFEFEF",borderWidth:"0px",zIndex:2147483645,compact:!1},this.slot.stickyAttributes);return e.compact&&(e.bgOpacity=1,e.bgColor=e.barColor),e}},{key:"addContent",value:function(e,t){var i=this,n=this.getClassName(),o=e.querySelector(".".concat(n)),r=this.createSlotElement();o.appendChild(r),e.querySelector(".".concat(n,"-button")).addEventListener("click",(function(){e.classList.contains("closed")?i.onShow():i.onClose(),clearInterval(i.hideAtElementInterval)}));var s=document.querySelector("body");return null==s||s.insertAdjacentElement("beforeend",t),null==s||s.insertAdjacentElement("beforeend",e),r}},{key:"getButtonStyles",value:function(e,t,i,n,o){return e?t?"border-radius: 0 0 2px 2px; top: ".concat(i,"px;"):"border-radius: 2px 2px 0 0; top: -20px;":t?"border-radius: 2px 2px 0 0; top: ".concat(n-20+o,"px;"):"border-radius: 0 0 2px 2px; top: 0px;"}},{key:"getFixedSelectorStyles",value:function(e,t,i,n,o){return t?".".concat(e,"-fixed {\n  ").concat(i?"top":"bottom"," : ").concat(n?o:0,"px !important;\n}\n").concat(t," {\n  transition: ").concat(i?"top":"bottom"," .3s linear;\n}"):""}},{key:"createStyles",value:function(){var e,t=this.getAttributes(),i=t.zIndex,n=t.compact,o=t.isTop,r=t.isButtonOutside,s=t.bgColor,a=t.bgOpacity,u=t.barColor,l=t.allowReopen,c=t.buttonColor,d=t.fixedSelector,g=t.borderWidth,h=this.getSlotMaxNonFluidHeight(),f=this.getContainerBordersSize(),p=this.getContainerBorderSize(),v=h+f,b=this.getSlotMaxNonFluidWidth()+f,m=l&&r?p:0,S=this.getClassName();return this.toHTML('\n<style id="'.concat(S,'-styles">\n.').concat(S,"-container {\n  direction: ltr;\n  z-index: ").concat(i,";\n  position: fixed;\n  ").concat(o?"top: 0":"bottom: 0",";\n  width: ").concat(n?b+"px":"100%",";\n  height: ").concat(v,"px;\n  transition: transform .3s linear, height .3s linear;\n  ").concat(r?"":"overflow: hidden;","\n  ").concat(n?"left: 50%; transform: translateX(-50%);":"left: 0;","\n}\n\n.").concat(S,"-container-background {\n  background-color: ").concat(s,";\n  opacity: ").concat(a,";\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: -1;\n}\n\n.").concat(S,"-button {\n  width: 40px;\n  margin-left: 2px;\n  height: 20px;\n  background-color: ").concat(u,";\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  display: none;\n  transition: top .3s linear;\n  ").concat(this.getButtonStyles(Boolean(r),Boolean(o),v,h,p),"\n}\n.").concat(S,"-button :first-child, .").concat(S,"-button :last-child  {\n  background-color: ").concat(c,";\n  width: 13px;\n  height: 3px;\n  border-radius: 2px;\n}\n.").concat(S,"-button :first-child {\n  transform: rotate(").concat(o?"-":"","30deg) translateX(2px);\n}\n.").concat(S,"-button :last-child {\n  transform: rotate(").concat(o?"":"-","30deg) translateX(-2px);\n}\n.").concat(S," {\n  width: ").concat(n?b+"px":"100%",";\n  height: ").concat(v,"px;\n  display: flex;\n  justify-content: center;\n  align-items: ").concat(this.scrollCreative?"baseline":"center",";\n  transition: transform .3s linear, height .3s linear;\n  border").concat(n?"":o?"-bottom":"-top",": ").concat(g," solid ").concat(u,";\n  ").concat((null===(e=this.slot.stickyAttributes)||void 0===e?void 0:e.scrollCreative)?"overflow: hidden":"","\n}\n.").concat(S,"-container.closed {\n  ").concat(o?"transform: translateY(-".concat(v-m,"px)").concat(n?" TranslateX(-50%)":"",";"):"height: "+m+"px !important;","\n}\n.").concat(S,"-container.closed .").concat(S,"-button {\n  visibility: ").concat(l?"visible":"hidden",";\n  ").concat(l?"":"display: none;","\n}\n.").concat(S,"-container.closed .").concat(S,"-button :first-child {\n  transform: rotate(").concat(o?"":"-","30deg) translateX(2px);\n}\n.").concat(S,"-container.closed .").concat(S,"-button :last-child {\n  transform: rotate(").concat(o?"-":"","30deg) translateX(-2px);\n}\n").concat(this.getFixedSelectorStyles(S,d||"",Boolean(o),h,v),"\n</style>\n"))}},{key:"getContainerBorderSize",value:function(){var e=this.getAttributes().borderWidth;return Number(e.substring(0,e.length-2))}},{key:"getContainerBordersSize",value:function(){var e=this.getAttributes().compact;return this.getContainerBorderSize()*(e?2:1)}},{key:"getAttributes",value:function(){return this.attributes}},{key:"insert",value:function(){var e=this;this.logger.debug("".concat(this.getLogContext()," add widget"));var t=this.createWidget(this.getSlotMaxNonFluidHeight()),i=this.createStyles(),n=this.addContent(t,i);return this.viewportInfo.browserWindow.requestAnimationFrame((function(){e.logger.debug("".concat(e.getLogContext()," showing on insert with waitForCreative ").concat(e.waitForCreative)),e.show()})),this.getHideAtSelector()&&this.setHideAtElementListener(),this.scrollCreative&&this.scrollableElement&&this.scrollableElement.addEventListener("scroll",(function(){e.updateWidgetPosition()})),[n]}},{key:"getSlotMaxNonFluidHeight",value:function(){return this.barHeight}},{key:"setHeights",value:function(e){this.creativeHeight=e;var t=this.getSlotNonFluidSizes(),i=(null==t?void 0:t.length)?t.map((function(e){return Number(e[1])})):[0],n=this.slot.stickyAttributes.heightCalculationMethod,o=i.sort((function(e,t){return t-e}));if(this.scrollCreative)switch(n){case"half_max":this.barHeight=o[0]/2+1;break;case"second_max":this.barHeight=o[1]||o[0];break;case"min":this.barHeight=Math.min.apply(Math,d(i));break;default:this.barHeight=Math.max.apply(Math,d(i))}else this.barHeight=Math.max.apply(Math,d(i));this.barScrollHeight=e?e-this.barHeight:0}},{key:"hideAtElementListener",value:function(){var e=this.getContainerElement(),t=this.getHideAtElement(),i=this.getAttributes().isHideForever;y(t)&&e&&(Hn(this.viewportInfo.getViewportStatus(),t,1,0)?e.classList.contains("closed")||(this.hide(),i&&clearInterval(this.hideAtElementInterval)):e.classList.contains("closed")&&(this.logger.debug("".concat(this.getLogContext()," showing from hideAtElementListener with waitForCreative ").concat(this.waitForCreative)),this.show()))}},{key:"setHideAtElementListener",value:function(){var e=this;this.hideAtElementInterval=setInterval((function(){e.hideAtElementListener()}),500)}},{key:"isHideSelectorVisible",value:function(){var e=this.getHideAtElement();return!(!e||!Hn(this.viewportInfo.getViewportStatus(),e,1,0))}},{key:"onBreakpointChange",value:function(){var e=this.getAttributes().compact,t=this.getContainerElement(),i=this.getWidgetElement();if(i){this.setHeights(0);var n=this.barHeight,o=this.getSlotMaxNonFluidWidth(),r=this.getContainerBordersSize(),s=n+r,a=o+r;t.style.height=(0===n?0:s)+"px",t.style.display=0===n?"none":"block",e&&n&&(t.style.width=a+"px",i.style.width=o+"px"),i.style.height=n+"px",0===n||this.isHideSelectorVisible()?this.updateFixedElement(!0):this.updateFixedElement(),this.getStylesElement().innerHTML=this.createStyles().innerHTML}}},{key:"delete",value:function(){this.logger.debug("".concat(this.getLogContext()," delete sticky"));var e=this.getStylesElement(),t=this.getContainerElement();return this.updateFixedElement(!0),this.getHideAtSelector()&&clearInterval(this.hideAtElementInterval),e&&e.remove(),t&&t.remove(),!0}},{key:"getSlotElement",value:function(){return document.querySelector(".".concat(this.getClassName()," .fuse-slot-sticky"))}},{key:"getScrollY",value:function(){var e;return(null===(e=this.slot.stickyAttributes)||void 0===e?void 0:e.scrollableSelector)?this.scrollableElement.scrollTop:this.scrollableElement.scrollY}},{key:"updateWidgetPosition",value:function(e){if(this.scrollCreative&&this.hasLoadedCreative&&this.slot.stickyAttributes){var t=this.slot.stickyAttributes,i=t.scrollingHeight,n=t.scrollableSelector;if(i){var o=i.trim();o.includes("vh")?this.scrollingHeight=n?this.scrollableElement.scrollHeight-(this.scrollableElement.offsetHeight||0):Number(o.replace("vh",""))*this.viewportInfo.browserWindow.innerHeight:this.scrollingHeight=Number(o.replace("px",""))}this.scrollMultiplier=this.barScrollHeight/this.scrollingHeight;var r=this.getScrollY();if(this.logger.debug("".concat(this.getLogContext()," updateWidgetPosition before"),e,this.creativeHeight,this.barHeight,this.scrollOffset,this.scrollPosition,this.getWidgetElement().style.marginTop,r,this.scrollingHeight),e)this.getWidgetElement().style.alignItems=this.creativeHeight>this.barHeight?"baseline":this.attributes.isTop?"start":"end";else if(this.creativeHeight>this.barHeight){var s=r-this.scrollPosition,a=s*this.scrollMultiplier;this.scrollOffset+=a,this.logger.debug("".concat(this.getLogContext()," updateWidgetPosition check"),a,s,this.scrollOffset),s<=0?this.scrollOffset<=0&&(this.scrollOffset=0):this.scrollOffset>this.barScrollHeight&&(this.scrollOffset=this.barScrollHeight),this.getSlotElement().style.marginTop="-"+this.scrollOffset+"px",this.scrollPosition=r}this.logger.debug("".concat(this.getLogContext()," updateWidgetPosition after"),e,this.creativeHeight,this.barHeight,this.scrollOffset,this.scrollPosition,this.getWidgetElement().style.marginTop,this.scrollMultiplier,this.barScrollHeight)}}},{key:"show",value:function(){var e=this,t=this.slot.id;return this.loadingByCreative||(this.waitForCreative&&!this.hasLoadedCreative?(this.loadingByCreative=!0,this.slotRenderCallbackRegistered||(this.logger.debug("".concat(this.getLogContext()," register slotRender callback")),this.registerAdRendered((function(i){if(-1!==i.slot.getSlotElementId().indexOf(t)){if(e.scrollCreative&&i.size){var n=Number(i.size[1]),o=0,r=i.slot.getTargeting("hb_size")[0]||i.slot.getTargeting("amznsz")[0];1===n&&r&&(o=J(r)[1],e.logger.debug("".concat(e.getLogContext()," get height ").concat(o," from targeting"))),e.setHeights(o||n),e.updateWidgetPosition(!0)}e.logger.debug("".concat(e.getLogContext()," show widget by creative ").concat(i.slot.getSlotElementId())),!e.isHideSelectorVisible()&&e.loadingByCreative?e.onShow():e.logger.debug("".concat(e.getLogContext()," unable to show widget by creative ").concat(i.slot.getSlotElementId(),", isHideSelectorVisible: ").concat(e.isHideSelectorVisible(),", loadingByCreative: ").concat(e.loadingByCreative)),e.loadingByCreative=!1,e.hasLoadedCreative=!0,e.logger.debug("".concat(e.getLogContext()," has loaded ").concat(i.slot.getSlotElementId()))}})),this.slotRenderCallbackRegistered=!0)):this.onShow()),!0}},{key:"onShow",value:function(){var e=this,t=this.getContainerElement();if(t){t.classList.remove("closed"),this.updateFixedElement(),this.apiV3.getSlotsForTemplateId(this.slot.id).forEach((function(t){t&&e.apiV3.enableRefreshByZone(t.slotDivId)})),this.onShowCloseCallback();var i=this.getClassName(),n=this.getAttributes().allowClose,o=t.querySelector(".".concat(i,"-button"));o&&n&&(o.style.display="flex")}}},{key:"onClose",value:function(){var e=this,t=this.getContainerElement();t&&(t.classList.add("closed"),this.updateFixedElement(!0),this.apiV3.getSlotsForTemplateId(this.slot.id).forEach((function(t){t&&e.apiV3.disableRefreshByZone(t.slotDivId)})),this.onShowCloseCallback())}},{key:"hide",value:function(){return this.logger.debug("".concat(this.getLogContext()," hiding")),this.onClose(),!0}},{key:"updateFixedElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger.debug("".concat(this.getLogContext()," updateFixedElement ").concat(e?"restore":"update"));var t=this.getFixedElement();if(t){var i=this.getFixedClass();e?t.classList.remove(i):t.classList.add(i)}}}])}(xo),Ao=function(e){function n(e,o,r,s,a,u){var l;return i(this,n),(l=t(this,n,[e,o,r,s])).slot=e,l.logger=o,l.viewportInfo=r,l.createFuseDivElement=s,l.registerAdRendered=a,l.widgetsRenderer=u,l.type="interscroller",l}return a(n,e),o(n,[{key:"getAttributes",value:function(){return Object.assign({selector:".adBreak",showBanner:!1,height:"100vh",zIndex:1e7,top:"auto"},this.slot.interscrollerAttributes)}},{key:"getTopOffset",value:function(){return this.widgetsRenderer.getMiniScrollersTopOffset()}},{key:"insert",value:function(){var e=this,t=this.getAttributes(),i=t.showBanner,n=t.zIndex,o=t.top,r=t.height,s=t.selector,a=this.getSlotMaxNonFluidHeight(),u=this.createSlotElement(),l=this.getClassName(),c=i?'<div class="'.concat(l,'-container-message banner_top">Advertisement</div>'):"",d=this.toHTML('\n    <div class="'.concat(l,'-container">\n      ').concat(c,'\n        <div class="').concat(l,'-scroll-clip">\n          <div class="').concat(l,' publift-widget-interscroller">').concat(u.outerHTML,"</div>\n        </div>\n    </div>\n  ")),g=this.toHTML('\n  <style id="'.concat(l,'-styles">\n  .').concat(l,"-container {\n    width: 100vw;\n    min-height: ").concat(r,";\n    z-index: ").concat(n,";\n    position: relative;\n    display: ").concat(0===a?"none":"block",";\n  }\n\n  .").concat(l,"-container-message {\n    position: absolute;\n    background-color: black;\n    color: white;\n    padding: .5em;\n    text-align: center;\n    font-family: sans-serif;\n    width: calc(100% - 1em);\n    z-index: 9999;\n  }\n\n  .").concat(l,"-scroll-clip {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    clip-path: inset(0px);\n    clip: rect(0px, auto, auto, 0px);\n    min-height: ").concat(r,"\n  }\n\n  .").concat(l," {\n    position: fixed;\n    top: ").concat(o||this.widgetsRenderer.getMiniScrollersTopOffset()+"px"," !important;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    bottom: 0;\n    transform: translateZ(0px);\n  }\n  </style>\n  ")),h=document.querySelector("body");if(h){var f=Ui(document,this.logger,s);if(f){h.insertAdjacentElement("beforeend",g),f.appendChild(d);var p=d.getBoundingClientRect().x-h.getBoundingClientRect().x;return d.style.marginLeft="-".concat(p,"px"),d.style.marginRight="-".concat(p,"px"),[u]}this.logger.info("".concat(this.getLogContext()," insertionPoint with selector not found: ").concat(s))}return this.registerAdRendered((function(t){if(e.logger.debug("".concat(e.getLogContext()," gpt event ").concat(JSON.stringify(t))),-1!==t.slot.getSlotElementId().indexOf(e.slot.id)&&(e.logger.debug("".concat(e.getLogContext()," gpt event suit")),t.creativeId&&t.size)){e.logger.debug("".concat(e.getLogContext()," gpt event creative ").concat(t.size[1]));var i=Number(t.size[1]),n=0,o=t.slot.getTargeting("hb_size")[0]||t.slot.getTargeting("amznsz")[0];1===i&&o&&(n=J(o)[1],e.logger.debug("".concat(e.getLogContext()," get height ").concat(n," from targeting"))),e.updateWidgetPosition(n||i)}})),[]}},{key:"updateWidgetPosition",value:function(e){var t=this.getSlotMaxNonFluidHeight(),i=this.widgetsRenderer.getMiniScrollersTopOffset(),n=(this.viewportInfo.browserWindow.innerHeight-(e>1?e:t))/2,o=i;this.logger.debug("".concat(this.getLogContext()," get top offset ").concat(o," for adunit size ").concat(e," maxHeight ").concat(t," topOffsetCentered ").concat(n," topOffsetSettings ").concat(i)),this.getWidgetElement().style.top="".concat(o,"px")}},{key:"onBreakpointChange",value:function(){var e=this.getSlotMaxNonFluidHeight(),t=this.getContainerElement();t&&(t.style.display=0===e?"none":"block")}},{key:"delete",value:function(){var e=this.getStylesElement(),t=this.getContainerElement();return!(!e||!t)&&(e.remove(),t.remove(),!0)}},{key:"hide",value:function(){return this.getContainerElement().style.display="none",!0}},{key:"show",value:function(){return this.getContainerElement().style.display="block",!0}}])}(xo),Ro=function(e){function n(){var e;return i(this,n),(e=t(this,n,arguments)).type="dynamic",e}return a(n,e),o(n,[{key:"getAttributes",value:function(){var e,t,i,n;return Object.assign(Object.assign({},this.slot.dynamicAttributes),{skip:Number((null===(e=this.slot.dynamicAttributes)||void 0===e?void 0:e.skip)||0),each:Number((null===(t=this.slot.dynamicAttributes)||void 0===t?void 0:t.each)||0),incrementEach:Number((null===(i=this.slot.dynamicAttributes)||void 0===i?void 0:i.incrementEach)||0),repeatHeight:Number((null===(n=this.slot.dynamicAttributes)||void 0===n?void 0:n.repeatHeight)||1e3)})}},{key:"createElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this.createSlotElement();return e&&e.split(" ").forEach((function(e){return i.classList.add(e)})),t&&(i.style.cssText=t),i}},{key:"getInsertNodes",value:function(e){var t=this.getLogContext();if(!e)return this.logger.warn("".concat(t," Selector should be defined")),null;var i=function(e,t,i){if(!i)return t.warn("[WIDGETS] safeQuerySelectorAll selector should be defined"),null;try{return e.querySelectorAll(i)}catch(e){t.error("[WIDGETS] safeQuerySelectorAll error: ".concat(i))}return null}(document,this.logger,e);return(null==i?void 0:i.length)?this.logger.debug("".concat(t," Page has ").concat(i.length," elements suitable for selector ").concat(e)):this.logger.info("".concat(t," No element with selector ").concat(e," found")),i}},{key:"notFuseSlot",value:function(e){return!e||e.getAttribute("data-fuse")!==this.slot.id||(this.logger.debug("".concat(this.getLogContext()," Skip insertion cause slot already inserted")),!1)}},{key:"filterNodes",value:function(e){var t=this.getAttributes(),i=t.skip,n=t.each,o=t.position,r=t.incrementEach,s=[],a=0,u=n;return e.forEach((function(e,t){var n=t+1;if(i&&n<=i)return!1;if("incontent"!==o&&u){if((n-i-a)%u!=0)return!1;r&&(a+=u,u+=r)}s.push(e)})),s}},{key:"getZoneDiv",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.querySelector("div[data-fuse]"):e}},{key:"insert",value:function(){var e=this,t=this.getAttributes(),i=t.selector,n=t.position,o=t.classNames,r=t.css,s=t.wrapperContent,a=t.repeatHeight,u=this.getInsertNodes(i);if(!(null==u?void 0:u.length))return this.logger.debug("".concat(this.getLogContext()," Injection skipped")),[];var l=0,c=[];return this.filterNodes(u).forEach((function(t){var i=e.createElement(o,r),u=i;s&&(i=e.wrapElement(i,s));var d=t.nextElementSibling,g=t.parentNode,h=t.previousElementSibling,f=t.lastElementChild;switch(n){case"after":e.notFuseSlot(d)&&(g.insertBefore(i,d),c.push(u));break;case"before":e.notFuseSlot(h)&&(g.insertBefore(i,t),c.push(u));break;case"replace":t.replaceWith(i),c.push(u);break;case"incontent":var p=t.getBoundingClientRect().top+t.getBoundingClientRect().height+document.documentElement.scrollTop,v=Math.floor(p/a);v>l&&(l=v,e.notFuseSlot(d)&&(g.insertBefore(i,d),c.push(u)));break;default:e.notFuseSlot(f)&&(t.appendChild(i),c.push(u))}})),c}},{key:"wrapElement",value:function(e,t){var i=document.createElement("div");return i.innerHTML=t,i.firstElementChild.appendChild(e),i.firstElementChild}},{key:"delete",value:function(){var e=document.querySelectorAll('[data-fuse="'.concat(this.slot.id,'"]'));return e.forEach((function(e){e.remove()})),e.length>0}},{key:"hide",value:function(){throw new Error("Method not implemented.")}},{key:"show",value:function(){throw new Error("Method not implemented.")}},{key:"onBreakpointChange",value:function(){throw new Error("Method not implemented.")}}])}(xo),Po=function(){return o((function e(t,n){i(this,e),this.logger=t,this.widgetsRenderer=n,this.checkInterval=null,this.statuses=[]}),[{key:"getStatuses",value:function(){return this.statuses}},{key:"start",value:function(e){var t=this;!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.statuses.length||(this.logger.debug("[WIDGETS][CHECKER] Start to check slots"),this.statuses=e.filter((function(e){var t,i;return(null===(t=e.dynamicAttributes)||void 0===t?void 0:t.selector)||(null===(i=e.interscrollerAttributes)||void 0===i?void 0:i.selector)})).map((function(e){var i,n,o=(null===(i=e.dynamicAttributes)||void 0===i?void 0:i.selector)||(null===(n=e.interscrollerAttributes)||void 0===n?void 0:n.selector);return{slot:e,selector:o||"",countSelector:t.countSelector(o),countSlot:t.countSlot(e.id)}})),this.statuses.length&&(this.checkInterval=setInterval((function(){return t.check()}),100)))}},{key:"stop",value:function(){this.checkInterval&&clearInterval(this.checkInterval),this.statuses=[]}},{key:"check",value:function(){var e=this;this.statuses.forEach((function(t){var i=t.slot,n=e.countSelector(t.selector),o=e.countSlot(i.id);t.countSelector===n&&t.countSlot===o||i.injectConditionConfig||(e.logger.debug("[WIDGETS][".concat(i.id,'] Injecting by selector "').concat(t.selector,'" change: selectors ').concat(n," slots ").concat(o)),e.widgetsRenderer.injectWidget(t.slot),t.countSelector=e.countSelector(t.selector),t.countSlot=e.countSlot(t.slot.id))}))}},{key:"countSelector",value:function(e){if(!e)return this.logger.warn("[WIDGETS]: Selector should be defined for countSelector"),0;try{return document.querySelectorAll(e).length}catch(t){this.logger.warn("[WIDGETS]: Invalid selector for count ".concat(e))}return 0}},{key:"countSlot",value:function(e){return document.querySelectorAll('[data-fuse="'.concat(e,'"]')).length}}])}(),Oo=function(){return o((function e(t,n,o,r,s,a,u,l){var c=this;i(this,e),this.logger=t,this.settings=n,this.apiV3=o,this.conditionFactory=r,this.viewportInfo=s,this.events=a,this.videoManager=u,this.createFuseDivElement=l,this.inited=!1,this.widgets=[],this.widgetsChecker=new Po(this.logger,this),this.events.onBreakpointChanged.subscribe((function(){return c.handleBreakpointChange()})),this.events.onPageInit.subscribe((function(e){e.isPageTransition&&c.reset()}))}),[{key:"getStickySlots",value:function(){return this.settings.getFuseSlots().filter((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.sticky}))}},{key:"getInterscrollerSlots",value:function(){return this.settings.getFuseSlots().filter((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.interscroller}))}},{key:"getDynamicSlots",value:function(){return this.settings.getFuseSlots().filter((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.dynamic}))}},{key:"getScrollToStickSlots",value:function(){return this.settings.getFuseSlots().filter((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.scrollToStick}))}},{key:"getMiniscrollerSlots",value:function(){return this.settings.getFuseSlots().filter((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.miniscroller}))}},{key:"isSlotInjected",value:function(e){return null!==document.querySelector('[data-fuse="'.concat(e.id,'"]'))}},{key:"getWidget",value:function(e){return this.widgets.filter((function(t){return t.slot.id===e.id}))[0]}},{key:"removeWidget",value:function(e){var t=this.getWidget(e);return t?(t.delete(),this.logger.debug("[WIDGETS][".concat(e.id,"] Widget deleted")),!0):(this.logger.debug("[WIDGETS][".concat(e.id,"] Widget was not found")),!1)}},{key:"handleBreakpointChange",value:function(){var e=this,t=this.getStickySlots(),i=this.getInterscrollerSlots();this.logger.info("[WIDGETS] onBreakpointChange Stickies: ".concat(t.length," Scrolls: ").concat(i.length)),t.concat(i).forEach((function(t){var i=e.getWidget(t);i&&i.onBreakpointChange()}))}},{key:"getWidgetSlots",value:function(){return this.getDynamicSlots().concat(this.getInterscrollerSlots(),this.getStickySlots())}},{key:"getWidgetsWithSelector",value:function(){return this.getDynamicSlots().concat(this.getInterscrollerSlots())}},{key:"cleanupDynamicSlots",value:function(){this.getDynamicSlots().forEach((function(e){document.querySelectorAll('[data-fuse="'.concat(e.id,'"]')).forEach((function(e){e.remove()}))}))}},{key:"injectWidget",value:function(e){var t,i=this;this.logger.debug("[WIDGETS][".concat(e.id,"] Inject widget"));var n=e.attributes,o=n.sticky,r=n.interscroller,s=n.dynamic,a=this.getWidget(e),u=!1;if((o||r)&&this.isSlotInjected(e))this.logger.debug("[WIDGETS][".concat(e.id,"] Skip injection. DOM element exists"));else{if(!a){if(o)a=new _o(e,this.logger,this.viewportInfo,this.createFuseDivElement,(function(e){return i.events.onSlotRender.subscribe(e)}),this.apiV3,(function(){i.updateFuseStyles()}),!this.settings.isYandexEnabled()),u=Boolean(null===(t=e.stickyAttributes)||void 0===t?void 0:t.isTop);else if(r)a=new Ao(e,this.logger,this.viewportInfo,this.createFuseDivElement,(function(e){return i.events.onSlotRender.subscribe(e)}),this);else{if(!s)return void this.logger.warn("[WIDGETS][".concat(e.id,"] Skip injection of unknown widget"));this.logger.debug("[WIDGETS][".concat(e.id,"] Injecting dynamic slot with attributes ").concat(JSON.stringify(e.dynamicAttributes))),a=new Ro(e,this.logger,this.viewportInfo,this.createFuseDivElement)}this.widgets.push(a)}var l=a.insert(),c=this.videoManager.getSettings();l.forEach((function(e){i.logger.debug("[WIDGETS][".concat(e.id,"] Run queueZone")),i.apiV3.queueZone(e.id),c.enabled&&c.injectedAdUnitId&&e.id.includes(c.injectedAdUnitId)&&i.videoManager.initVideo(!0)})),l.length>0&&this.apiV3.runAuction(),u&&this.updateFuseStyles()}}},{key:"render",value:function(){var e=this;this.getWidgetSlots().forEach((function(t){if(t.injectConditionConfig){var i=e.conditionFactory.buildActivator(t.injectConditionConfig,t.id,e.apiV3,(function(){e.injectWidget(t)}));i.checkCondition()?e.injectWidget(t):i.enableTriggers()}else e.injectWidget(t)}))}},{key:"init",value:function(){this.logger.debug("[WIDGETS] Init"),this.inited?this.logger.debug("[WIDGETS] Skipped initialisation as it is already initialised"):(this.inited=!1,this.render(),this.widgetsChecker.start(this.getWidgetsWithSelector()),this.addScrollToStickListener(),this.injectFuseStyles(),this.inited=!0)}},{key:"cleanup",value:function(){var e=this;this.logger.debug("[WIDGETS] cleanup"),this.widgetsChecker.stop(),this.getWidgetSlots().forEach((function(t){return e.removeWidget(t)}))}},{key:"reset",value:function(){this.cleanup(),this.logger.debug("[WIDGETS] reset"),this.render(),this.widgetsChecker.start(this.getWidgetsWithSelector(),!0)}},{key:"getMiniScrollersTopOffset",value:function(){var e=this,t=0,i=this.settings.getTopStickyHeaderSelector();if(i){var n=Ui(document,this.logger,i);n&&(t+=n.clientHeight,this.logger.debug("[WIDGETS] miniscrollers offset set to ".concat(t," because of topStickyHeader")))}return this.getStickySlots().forEach((function(i){var n;if(null===(n=i.stickyAttributes)||void 0===n?void 0:n.isTop){var o=e.getWidget(i);if((null==o?void 0:o.getContainerElement())&&!o.getContainerElement().classList.contains("closed")){var r=e.settings.maxSlotHeightForBreakpoint(i,e.viewportInfo.getCurrentBreakpoint().name);t+=null!=r?r:0,e.logger.debug("[WIDGETS] miniscrollers offset set to ".concat(t," because of top sticky"))}}})),t}},{key:"injectFuseStyles",value:function(){if(document.getElementById("publift-fuse-styles"))this.logger.debug("[WIDGETS] styles already injected");else{var e="",t=this.getMiniScrollersTopOffset();if(this.settings.isMiniScrollersEnabled()){this.logger.debug("[WIDGETS] inject fuse styles");var i="\n      .fuse-slot-mini-scroller .fuse-slot {\n        top: ".concat(0|t,"px;\n        position: sticky !important;\n        overflow: hidden !important;\n      }\n      .fuse-slot-mini-scroller {\n        overflow: initial !important;\n        display: block !important;\n      }\n      ");this.logger.debug("[WIDGETS] injected miniScroller styles"),e+=i}e+="\n    .fuse-slot-scroll-to-stick .fuse-slot {\n      z-index: 9999;\n      top: ".concat(0|t,"px;\n      position: fixed;\n      width: 100%;\n      pointer-events: auto;\n    }\n    .publift-widget-interscroller {\n      top: ").concat(0|t,"px;\n    }"),this.createFuseDivElement.insertStyles("publift-fuse-styles",e)}}},{key:"updateFuseStyles",value:function(){var e=document.getElementById("publift-fuse-styles");e&&e.remove(),this.injectFuseStyles()}},{key:"getScrollToStickPrevElement",value:function(e){var t=e.previousElementSibling;return t||this.getScrollToStickPrevElement(e.parentElement)}},{key:"addScrollToStickListener",value:function(){var e=this;this.getScrollToStickSlots().length&&(this.logger.debug("[WIDGETS] scrollToStick slots found ".concat(this.getScrollToStickSlots().length,". Attach scroll listener")),this.viewportInfo.browserWindow.addEventListener("scroll",(function(){return e.scrollToStickListener()}),!0))}},{key:"scrollToStickListener",value:function(){var e=this;this.logger.debug("[WIDGETS] scrollToStickListener");var t=this.getScrollToStickSlots(),i=this.settings.scrollToStickDisableDepth()||0,n=this.getMiniScrollersTopOffset(),o=i>0&&this.viewportInfo.browserWindow.scrollY>i;t.forEach((function(i){document.querySelectorAll('[data-fuse="'.concat(i.id,'"]')).forEach((function(r){if(o)return e.logger.debug("[WIDGETS][".concat(i.id,"] scrollToStick removed by scrollToStickDisableDepth")),r.classList.remove("fuse-slot-scroll-to-stick"),void(t=t.filter((function(e){return e.id!==i.id})));var s=e.getScrollToStickPrevElement(r);s&&s.getBoundingClientRect().y+s.getBoundingClientRect().height-n<0?(e.logger.debug("[WIDGETS][".concat(i.id,"] scrollToStick set")),r.classList.add("fuse-slot-scroll-to-stick")):(e.logger.debug("[WIDGETS][".concat(i.id,"] scrollToStick removed")),r.classList.remove("fuse-slot-scroll-to-stick"))}))}))}}])}(),Do="publift-primis-script",zo="primisPlayer",Lo=function(){return o((function e(t,n,o,r,s,a){i(this,e),this.logger=t,this.settings=n,this.browserWindow=o,this.viewportInfo=r,this.events=s,this.scoSettings=a,this._hasVideo=!1,this.inited=!1}),[{key:"init",value:function(){var e=this;this.logger.log("[VIDEO]: Video init"),this.settings.enabled&&(this.inited||(this.logger.log("[VIDEO]: Video init events"),this.events.onBreakpointChanged.subscribe((function(){return e.resetVideo(e.settings.enabled&&!!e.settings.injectedAdUnitId)})),this.events.onPageInit.subscribe((function(){return e.initVideo()})),this.events.onPageReset.subscribe((function(){return e.removeVideo()})),this.initVideo(),this.inited=!0))}},{key:"getSettings",value:function(){return this.settings}},{key:"initVideo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.logger.log("[VIDEO]: Video initVideo"),this.settings.enabled)if(e&&!this.settings.injectedAdUnitId||!e&&this.settings.injectedAdUnitId)this.logger.log("[VIDEO]: Video initVideo skipped -  dynamic: ".concat(e,", injectedAdUnitId: ").concat(this.settings.injectedAdUnitId));else if(this._hasVideo)this.logger.log("[VIDEO]: Video all ready setup");else if(!this.settings.breakpoints||this.settings.breakpoints[this.viewportInfo.getCurrentBreakpoint().name]){if("primis"===this.settings.partner)this.setupPrimis(this.settings.placementId);this._hasVideo=!0}else this.logger.log("[VIDEO]: Not starting video at breakpoint ".concat(this.viewportInfo.getCurrentBreakpoint().name))}},{key:"resetVideo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger.log("[VIDEO]: Resetting video"),this.removeVideo(),this.initVideo(e)}},{key:"removeVideo",value:function(){if(this.settings.enabled&&this._hasVideo){if("primis"===this.settings.partner)this.resetPrimis();this._hasVideo=!1,this.logger.log("[VIDEO]: Removed video script ".concat(Do))}}},{key:"setupPrimis",value:function(e){var t=this;this.logger.log("[INIT]: Setup primis");var i=this.scoSettings?"&schain=1.0,1!".concat(this.scoSettings.asi,",").concat(this.scoSettings.sellerId,",1"):"";if(this.settings.enabled&&this.settings.injectedAdUnitId){var n='[data-fuse="'.concat(this.settings.injectedAdUnitId,'"]'),o=this.browserWindow.document.querySelector(n);if(o){var r=this.browserWindow.document.createElement("div");r.id=zo,o.appendChild(r)}else this.logger.warn("[INIT]: Injection video library. Element with selector ".concat(n," not found"))}D({name:"Primis",url:"//live.primis.tech/live/",file:"liveView.php",query:"s=".concat(e).concat(i,"&playerApiId=publift-primis-video"),id:Do,insertSelector:this.settings.enabled&&this.settings.injectedAdUnitId?"#".concat(zo):"body"},(function(){t.logger.log("[VIDEO]: Primis video loaded")}))}},{key:"resetPrimis",value:function(){var e,t,i;null===(e=this.browserWindow.document.getElementById(Do))||void 0===e||e.remove(),null===(t=this.browserWindow.document.getElementById(zo))||void 0===t||t.remove(),null===(i=this.browserWindow.document.getElementById("primisPlayerContainerDiv"))||void 0===i||i.remove()}}])}(),No=function(){return o((function e(){i(this,e)}),[{key:"getWidgetsRenderer",value:function(){return this.widgetsRenderer||(this.widgetsRenderer=new Oo(E.getLogger(),kt.getSettings(),ko.getApiV3(),on.getInsertConditionFactory(),gt.getViewportInfo(),He,this.getVideoManager(),gt.getCreateFuseDivElement())),this.widgetsRenderer}},{key:"getInterstitialManager",value:function(){return this.interstitialManager||(this.interstitialManager=new To(E.getLogger(),kt.getSettings(),on.getInsertConditionFactory(),ko.getApiV3())),this.interstitialManager}},{key:"getVideoManager",value:function(){if(!this.videoManager){var e=kt.getSettings();this.videoManager=new Lo(E.getLogger(),e.getVideoSettings(),E.getBrowserWindowObject(),gt.getViewportInfo(),He,e.getSco())}return this.videoManager}}])}(),Bo=new No,Mo=E.getLogger(),Fo=kt.getSettings(),jo=sn.getGptSlotRegistry(),Uo=Pt.getReporter(),Go=ko.getFuseSlotRegistry(),Wo=ko.getController(),Vo=un.getInitManager(),Ho=E.getBrowserWindowObject(),Zo=ko.getSlotInfo(),qo="onTagInitialised",Yo=new Ge(Mo,qo),Jo=ko.getApiV3(),Qo=ko.getPageManager();var Ko={enableApi:function(e){Mo.debug("[INIT]: Enabling Fuse API"),e.fuseUUID=Fo.getFuseUUID(),e.initialised=!1,e.init=!1,e.getCurrentBreakpoint=function(){return gt.getViewportInfo().getCurrentBreakpoint()},e.pageInit=function(e){return Mo.debug("[API]: pageInit(".concat(JSON.stringify(e),")")),Qo.handlePageInitCall(Ho.location.href,Uo.getElapsedTime(),e)},e.registerAll=function(){return Mo.debug("[API]: registerAll()"),Wo.registerAndRunAuction(!0,!1,Jo)},e.registerZone=function(e){var t;if(e&&"string"==typeof e){Mo.debug("[API]: registerZone('".concat(e,"')"));var i=null===(t=Wo.registerZoneAndQueue(e,!0,!1,Jo))||void 0===t?void 0:t.slotDivId;return i&&Wo.runAuction(),i}Mo.error("[API]: registerZone with invalid zoneDivId: ".concat(JSON.stringify(e)," - ").concat(h(e)))},e.destroyZone=function(e){e&&"string"==typeof e?(Mo.debug("[API]: destroyZone('".concat(e,"')")),Wo.destroyZone(e)):Mo.error("[API]: destroyZone with invalid zoneDivId: ".concat(JSON.stringify(e)," - ").concat(h(e)))},e.activateZone=function(e){e&&"string"==typeof e?(Mo.debug("[API]: activateZone('".concat(e,"')")),Wo.activateZone(e)):Mo.error("[API]: activateZone with invalid zoneDivId: ".concat(JSON.stringify(e)," - ").concat(h(e)))},e.states=Uo.states,e.events=Uo.events,e.setTargeting=function(e,t){if("string"==typeof e){if("string"==typeof t||Array.isArray(t))return Mo.debug("[API]: setTargeting(".concat(e,", ").concat(JSON.stringify(t),")")),co(e,t);Mo.error("[API]: setTargeting with invalid value: ".concat(JSON.stringify(t)," - ").concat(h(t)))}else Mo.error("[API]: setTargeting with invalid key: ".concat(JSON.stringify(e)," - ").concat(h(e)))},e.onSlotRenderEnded=function(e){return He.onSlotRender.subscribe((function(t){var i={slotId:t.slot.getSlotElementId(),hasCreative:!t.isEmpty,gptEvent:t};e(i)}))},e.onTagInitialised=function(e){Yo.once(e)},e.onSlotsInitialised=function(e){Go.getSlotsInitObservable().once(e)},e.onSlotInitialised=function(e){Go.getSlotInitObservable().once(e)},e.setAllowRefreshCallback=function(e){Go.setAllowSlotRefreshCallback(e)},e.resetAfs=function(e){Mo.debug("[API]: resetAfs ".concat(JSON.stringify(e),"')")),Co.getAfsManager().reset(e)},e.privateApi={getWidgetRenderer:function(){return Bo.getWidgetsRenderer()},getInitStatus:function(){return Vo.getInitStatus()},getSlotProblems:function(){return Uo.getSlotProblems()},resetPage:function(){return Mo.debug("[API]: resetPage()"),Qo.reset()},runAuctionAllActiveSlots:function(){return Mo.debug("[API]: runAuctionAllActiveSlots()"),Wo.runAuctionAllActiveSlots()},setLogLevel:function(e){return Mo.setLogLevel(e)},getLogLevel:function(){return Mo.getLogLevel()},getLogs:function(){return Mo.getLogs()},getAuctionState:function(){return ko.getAuctionExecutor().getStateView()},getSlotTestUrls:function(){return Fo.getSlotTestUrls()},isYandexEnabled:function(){return Fo.isYandexEnabled()},isPrebidEnabled:function(){return Fo.isPrebidEnabled()},isCmpEnabled:function(){return Fo.isCmpRequired()},isUamEnabled:function(){return Fo.isUamEnabled()},isBlockthroughEnabled:function(){return Fo.isBlockthroughEnabled()},disableRefreshBySlotId:function(e){return ko.getFuseSlotRegistry().disableRefreshBySlotId(e)},enableRefreshBySlotId:function(e){return ko.getFuseSlotRegistry().enableRefreshBySlotId(e)},enableRefresh:function(){return Mo.debug("[API]: enableAllRefresh()"),Wo.enableAllRefresh()},getAllRefresh:function(){return ko.getFuseSlotRegistry().getAllRefresh()}},e.loadSlots=function(){Mo.debug("[API]: loadSlots()"),Wo.loadSlots(e.initialised,Jo,(function(){return Qo.reset()}))},e.getUnits=function(){return Go.getZoneDivs()},e.loadSlotById=function(e,t){return function(e,t){var i;Mo.debug("[API]: loadSlotById(".concat(e,", ").concat(t,")")),(t?Wo.registerZoneAndQueue(t,!0,!0,Jo):Wo.registerAndQueueLastSlotWithFuseId("".concat(e),!0,!0,Jo))||Mo.debug("[API]: loadSlotById(".concat(e,", ").concat(t,") did not register a slot")),t&&!1===(null===(i=Go.getSlotByZoneDivId(t))||void 0===i?void 0:i.currentlyActive)&&(Mo.debug("[API]: loadSlotById(".concat(e,", ").concat(t,") activate zone")),Wo.activateZone(t)),Wo.runAuction()}(e,t)},e.refreshSlots=function(){return Mo.debug("[API]: refreshSlots()"),Wo.runAuctionAllActiveSlots()},e.refreshSlotByCode=function(e){if(e&&"string"==typeof e)return Mo.debug("[API]: refreshSlotByCode(".concat(e,")")),Wo.forceRunAuction(e);Mo.error("[API]: refreshSlotByCode with invalid creativeDivId: ".concat(JSON.stringify(e)," - ").concat(h(e)))},e.getAdSlotsById=function(e){return function(e){if(e&&("string"==typeof e||"number"==typeof e))return jo.getSlots("".concat(e));Mo.warn("[API]: getAdSlotsById with invalid fuseId: ".concat(JSON.stringify(e)," - ").concat(h(e)))}(e)},e.processNewSlots=function(){return Mo.debug("[API]: processNewSlots()"),Wo.registerAndRunAuction(!0,!1,Jo)},e.getTargeting=function(){return uo},e.getAdSlotsByFuseId=e.getAdSlotsById,e.getFuseUnits=e.getUnits,e.loadFuseSlots=e.loadSlots,e.resetSlots=function(){return Mo.debug("[API]: resetSlots()"),Qo.reset()},e.resetFuseSlots=function(){return Mo.debug("[API]: resetFuseSlots()"),Qo.reset()},e.loadFuseSlotById=e.loadSlotById,e.setSlotTargetingById=function(e,t,i){return function(e,t,i){!e||"string"!=typeof e&&"number"!=typeof e?Mo.error("[API]: setSlotTargetingById with invalid fuseId: ".concat(JSON.stringify(e)," - ").concat(h(e))):"string"==typeof t?"string"==typeof i||Array.isArray(i)?(Mo.debug("[API]: setSlotTargetingById(".concat(e,", ").concat(t,", ").concat(i,") started")),jo.setSlotTargetingById("".concat(e),t,i)):Mo.error("[API]: setSlotTargetingById with invalid value: ".concat(JSON.stringify(i)," - ").concat(h(i))):Mo.error("[API]: setSlotTargetingById with invalid key: ".concat(JSON.stringify(t)," - ").concat(h(t)))}(e,t,i)},e.widgetsRenderer=e.privateApi.getWidgetRenderer(),e.setDefaultTargeting=function(){return Mo.debug("[API]: setDefaultTargeting()"),Xt()},e.disableRefresh=function(){return Mo.debug("[API]: disableRefresh()"),Wo.destroyAllRefresh()},e.getSlots=function(){return Go.getZoneTemplates()},e.getSettings=function(){return Object.assign({},Fo.getAccountSettings())},Fo.getReportPageInfo()&&(e.reportPageInfo=function(e,t){Mo.debug("[API]: reportPageInfo()",e,t),Zo.reportSlotInfo(e,t)}),e.setForceSafeFrames=function(e){Mo.debug("[API]: setForceSafeFrame(".concat(e,")")),$t(e)},e.isForceSafeFrames=function(){return Fo.isForceSafeFrames()}},tagInitEmitter:Yo,ON_TAG_INIT_EVENT:qo},Xo=function(){return o((function e(t,n,o){i(this,e),this.logger=t,this.browserWindow=n,this.reporter=o}),[{key:"load",value:function(e){switch(this.reporter.setStateStatus("cmp_load_quantcast_start"),e.partner){case"quantcast":return this.loadQuantcast();case"cookiebot":return this.loadCookieBot(e.domainGroupId);case"fundingchoices":return void this.logger.log("[CMP]: Funding Choices CMP provider selected no external script required")}}},{key:"loadQuantcast",value:function(){this.logger.log("[CMP]: Loading Quantcast CMP provider");var e=this,t=this.browserWindow.document.location.hostname,i=this.browserWindow.document.createElement("script"),n=this.browserWindow.document.getElementsByTagName("script")[0],o=this.browserWindow.document.getElementsByTagName("head")[0]||this.browserWindow.document.documentElement,r="https://cmp.inmobi.com".concat("/choice/","PRrmquD1Ggcb1","/",t,"/choice.js?tag_version=V3"),s=new XMLHttpRequest;s.onreadystatechange=function(){4===this.readyState&&(i.async=!0,i.type="text/javascript",200===this.status?i.src=r:e.logger.error("GET call to CMP script with ".concat(t," responed with the status code - ").concat(this.status)),(null==n?void 0:n.parentNode)?n.parentNode.insertBefore(i,n):(e.logger.debug("First script element not fully initialised, falling back to head-based insertion"),o.insertBefore(i,o.firstChild)),e.logger.log("[CMP]: Added Quantcast script to document"))},this.logger.log("[CMP]: Opening Quantcast URL"),s.open("GET",r,!0),s.send()}},{key:"loadCookieBot",value:function(e){var t=this;this.logger.log("[CMP]: Loading Cookie Bot - ".concat(e)),D({name:"CookieBot",url:"//consent.cookiebot.com/",file:"uc.js",insertSelector:"head",attributes:{"data-cbid":e,"data-blockingmode":"auto","data-framework":"IAB"}},(function(){t.logger.log("[CMP]: Cookie Bot script loaded")}))}}])}(),$o=function(){return o((function e(t,n){i(this,e),this.logger=t,this.browserWindow=n}),[{key:"generate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.createStubFunctionV2(),e&&this.createGppStub()}},{key:"createStubFunctionV2",value:function(){var e=this;!function(){e.logger.debug("[CMP]: Generating V2 stub");for(var t="__tcfapiLocator",i=[],n=e.browserWindow,o=void 0,r=function(){var i=n.document,o=!!n.frames[t];if(o)e.logger.debug("[CMP] Found existing version 2 stub");else if(e.logger.debug("[CMP] Version 2 stub not found - generating"),i.body){var s=i.createElement("iframe");s.style.cssText="display:none",s.name=t,i.body.appendChild(s)}else setTimeout(r,5);return!o},s=n;s;){try{if(s.frames[t]){o=s,e.logger.debug("[CMP] Found locator frame");break}}catch(t){"{}"!==JSON.stringify(t)&&e.logger.log("[CMP]:",JSON.stringify(t))}if(s===e.browserWindow.top)break;s=s.parent}o||(e.logger.debug("[CMP] Locator frame not found"),r(),n.__tcfapi=function(){var e=arguments,t=void 0;if(!e.length)return i;if("setGdprApplies"===e[0])e.length>3&&2===e[2]&&"boolean"==typeof e[3]&&(t=e[3],"function"==typeof e[2]&&e[2]("set",!0));else if("ping"===e[0]){var n={gdprApplies:t,cmpLoaded:!1,cmpStatus:"stub"};"function"==typeof e[2]&&e[2](n)}else{var o="init"===e[0]&&"object"===h(e[3])?[e[0],e[1],e[2],Object.assign(e[3],{tag_version:"V2"})].concat(Array.from(e).slice(4)):e;i.push(o)}},n.addEventListener("message",(function(t){var i="string"==typeof t.data,n=void 0;try{n=i?JSON.parse(t.data):t.data}catch(t){"{}"!==JSON.stringify(t)&&e.logger.error("[CMP]:",JSON.stringify(t))}var o=null==n?void 0:n.__tcfapiCall;if(o){var r=t.source;e.browserWindow.__tcfapi(o.command,o.version,(function(e,t){var n={__tcfapiReturn:{returnValue:e,success:t,callId:o.callId}};(null==r?void 0:r.postMessage)&&r.postMessage(i?JSON.stringify(n):n,"*")}),o.parameter),r=null}}),!1))}()}},{key:"createGppStub",value:function(){this.logger.log("[CMP]: Generating GPP stub");var e=this.browserWindow;this.browserWindow.__gpp_addFrame=function(t){if(!e.frames[t])if(e.document.body){var i=document.createElement("iframe");i.style.cssText="display:none",i.name=t,e.document.body.appendChild(i)}else e.setTimeout((function(){return e.__gpp_addFrame(t)}),10)},this.browserWindow.__gpp_stub=function(){var t=arguments;if(e.__gpp.queue=e.__gpp.queue||[],!t.length)return e.__gpp.queue;var i=t[0],n=t.length>1?t[1]:null,o=t.length>2?t[2]:null;if("ping"===i){var r={gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",supportedAPIs:["2:tcfeuv2","5:tcfcav1","6:uspv1"],cmpId:31,sectionList:[],applicableSections:[-1],gppString:""};return n(r,!0),r}if("addEventListener"===i){e.__gpp.events=e.__gpp.events||[],"lastId"in e.__gpp||(e.__gpp.lastId=0),e.__gpp.lastId++;var s=e.__gpp.lastId;e.__gpp.events.push({id:s,callback:n,parameter:o});var a={eventName:"listenerRegistered",listenerId:s,data:!0,pingData:{gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",supportedAPIs:["2:tcfeuv2","5:tcfcav1","9:usva","7:usnat"],cmpId:31,sectionList:[],applicableSections:[-1],gppString:""}};return n(a,!0),a}if("removeEventListener"===i){var u=!1;e.__gpp.events=e.__gpp.events||[];for(var l=0;l<e.__gpp.events.length;l++)if(e.__gpp.events[l].id==o){e.__gpp.events.splice(l,1),u=!0;break}var c={eventName:"listenerRemoved",listenerId:o,data:u,pingData:{gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",supportedAPIs:["2:tcfeuv2","5:tcfcav1","9:usva","7:usnat"],cmpId:31,sectionList:[],applicableSections:[-1],gppString:""}};return n(c,!0),c}if("hasSection"===i||"getSection"===i||"getField"===i)return null;e.__gpp.queue.push([].slice.apply(t))},this.browserWindow.__gpp_msghandler=function(t){var i,n="string"==typeof t.data;try{i=n?JSON.parse(t.data):t.data}catch(e){i=null}if("object"===h(i)&&null!==i&&"__gppCall"in i){var o=i.__gppCall;e.__gpp(o.command,(function(e,i){var r={__gppReturn:{returnValue:e,success:i,callId:o.callId}};t.source.postMessage(n?JSON.stringify(r):r,"*")}),"parameter"in o?o.parameter:null,"version"in o?o.version:"1.1")}},"__gpp"in this.browserWindow&&"function"==typeof this.browserWindow.__gpp?this.logger.log("[CMP]: GPP already set, not setting __gpp"):(this.logger.log("[CMP]: GPP not yet set, setting to stub"),this.browserWindow.__gpp=this.browserWindow.__gpp_stub,this.browserWindow.addEventListener("message",this.browserWindow.__gpp_msghandler,!1),this.browserWindow.__gpp_addFrame("__gppLocator"))}}])}(),er=function(e,t){var i,n,o;return(null===(n=null===(i=t.purpose)||void 0===i?void 0:i.consents)||void 0===n?void 0:n[e])||(null===(o=t.purposeConsents)||void 0===o?void 0:o[e])},tr=function(e,t){var i,n;return Boolean(er(e,t)||(null===(n=null===(i=t.purpose)||void 0===i?void 0:i.legitimateInterests)||void 0===n?void 0:n[e]))},ir=function(){return o((function e(t,n,o){i(this,e),this.logger=t,this.consentUIPrompt=o,this.callCount=-1,this.uspTries=0,this.uspTriesLimit=3,this.browserWindow=n,this.createUspStub()}),[{key:"cmpLoaded",value:function(e){var t=!1;setTimeout((function(){if(!t)return e(!1)}),1e3),this.browserWindow.__tcfapi("ping",2,(function(i){return t=!0,(null==i?void 0:i.cmpLoaded)?e(!0):e(!1)}))}},{key:"setGDPRConsentPrompt",value:function(){var e=this;this.consentUIPrompt.setup("Privacy Settings",(function(){e.browserWindow.__tcfapi("displayConsentUi",2,(function(){return e.logger.log("[CMP-V2]: GDPR Consent UI displayed")}))}))}},{key:"setCCPAConsentPrompt",value:function(){var e=this;this.consentUIPrompt.setup("Do Not Sell My Data",(function(){e.browserWindow.__uspapi("displayUspUi")}))}},{key:"checkForCCPA",value:function(e){var t=this;if(this.browserWindow.googlefc||this.browserWindow.Cookiebot)return this.logger.log("[CMP-v2]: Checking CCPA with cookiebot/funding choices"),this.handleNonInmobiCCPA(e);this.browserWindow.__uspapi("uspPing",1,(function(i,n){n&&i.mode.includes("USP")&&i.jurisdiction.includes(i.location.toUpperCase())?(t.logger.log("[CMP-V2]: CCPA Region"),t.browserWindow.__uspapi("setUspDftData",1,(function(i,n){t.logger.log("[CMP-V2]: Setting up data for USP API",JSON.stringify(i),n),t.browserWindow.__uspapi("getUSPData",1,(function(i,n){if(!n)return t.logger.log("[CMP-V2]: Failed retrieving USP data use default instead"),e({applies:!0,privacyString:"1---"});e({applies:!0,privacyString:i.uspString})}))}))):e({applies:!1})}))}},{key:"handleNonInmobiCCPA",value:function(e){var t,i,n=this;Boolean((null===(t=this.browserWindow.googlefc)||void 0===t?void 0:t.ccpa)||(null===(i=this.browserWindow.Cookiebot)||void 0===i?void 0:i.regulations.ccpaApplies))?this.browserWindow.__uspapi("getUSPData",1,(function(t,i){if(!i)return n.logger.log("[CMP-V2]: Failed retrieving USP data use default instead"),e({applies:!0,privacyString:"1---"});e({applies:!0,privacyString:t.uspString})})):e({applies:!1})}},{key:"handleGdprApplies",value:function(e,t){var i=e.eventStatus.toLowerCase();if("useractioncomplete"===i||"tcloaded"===i){var n=er(1,e),o=er(3,e),r=er(4,e),s=tr(2,e),a=tr(7,e),u=tr(9,e),l=tr(10,e),c=!m(n),d=!m(o),g=!m(o),h=c&&d&&g,f=h&&n&&o&&r&&s&&a&&u&&l;return this.logger.debug("[CMP-V2]: Consents available: ".concat(h,", Consent: ").concat(f," Data: ").concat(JSON.stringify(e))),t({dataAvailable:!0,gdprChoiceReceived:!0,personalisedAdsConsent:f,gdprApplies:!0,cmpStatus:null==e?void 0:e.cmpStatus,eventStatus:null==e?void 0:e.eventStatus,tcData:e})}return"cmpuishown"===i||this.callCount%8==0&&this.logger.warn("[CMP-V2]: Unexpected eventStatus. Data: ".concat(JSON.stringify(e))),t({dataAvailable:!0,gdprChoiceReceived:!1,gdprApplies:!0,cmpStatus:null==e?void 0:e.cmpStatus,eventStatus:null==e?void 0:e.eventStatus})}},{key:"createUspStub",value:function(){var e=this,t=this.logger,i=this.browserWindow,n=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t.warn("[CMP-V2] USP is still in stub mode. Calling to ".concat(i[0]," API will be unsuccessful")),"function"==typeof i[2]&&i[2](void 0,!1)};if(void 0===i.__uspapi){i.__uspapi=n;var o=setInterval((function(){e.uspTries++,i.__uspapi!==n?(t.debug("[CMP-V2]: USP stub function has been replaced"),clearInterval(o)):e.uspTries<e.uspTriesLimit?t.debug("[CMP-V2]: USP stub function has NOT been replaced, will retry"):(t.warn("[CMP-V2]: USP stub function has NOT been replaced, but the timeout has been reached"),clearInterval(o))}),300)}}}])}(),nr=function(e){function n(e,o,r){var s;return i(this,n),(s=t(this,n,[e,o,r])).logger=e,s.consentUIPrompt=r,s}return a(n,e),o(n,[{key:"getConsentData",value:function(e){var t=this;this.browserWindow.__tcfapi("getTCData",2,(function(i,n){var o;return t.callCount++,n&&i?m(i.gdprApplies)||"loading"===(null===(o=null==i?void 0:i.cmpStatus)||void 0===o?void 0:o.toLowerCase())||i.gdprApplies&&m(null==i?void 0:i.eventStatus)?(t.logger.log("[CMP-V2]: GDPR not yet determined"),e({dataAvailable:!0,gdprApplies:void 0,cmpStatus:null==i?void 0:i.cmpStatus,eventStatus:null==i?void 0:i.eventStatus})):!1===i.gdprApplies?e({dataAvailable:!0,gdprApplies:!1,cmpStatus:null==i?void 0:i.cmpStatus,eventStatus:null==i?void 0:i.eventStatus}):!0===i.gdprApplies?t.handleGdprApplies(i,e):void t.logger.warn("[CMP-V2]: Unexpected gdprApplies status. Data: ".concat(JSON.stringify(i))):(t.logger.warn("[CMP-V2]: Failed to get TCData"),e({dataAvailable:!1,cmpStatus:null==i?void 0:i.cmpStatus,eventStatus:null==i?void 0:i.eventStatus}))}))}}])}(ir),or=function(e){function n(e,o,r){var s;return i(this,n),(s=t(this,n,[e,o,r])).logger=e,s.consentUIPrompt=r,s.tcData=null,s.browserWindow.__tcfapi("addEventListener",2,s.handleTCEvent.bind(s)),s}return a(n,e),o(n,[{key:"getConsentData",value:function(e){var t,i,n,o,r,s,a;return this.callCount++,this.tcData?m(this.tcData.gdprApplies)||"loading"===(null===(i=null===(t=this.tcData)||void 0===t?void 0:t.cmpStatus)||void 0===i?void 0:i.toLowerCase())||this.tcData.gdprApplies&&m(null===(n=this.tcData)||void 0===n?void 0:n.eventStatus)?(this.logger.log("[CMP-V2.2]: GDPR not yet determined"),e({dataAvailable:!0,gdprApplies:void 0,cmpStatus:null===(o=this.tcData)||void 0===o?void 0:o.cmpStatus,eventStatus:null===(r=this.tcData)||void 0===r?void 0:r.eventStatus})):!1===this.tcData.gdprApplies?e({dataAvailable:!0,gdprApplies:!1,cmpStatus:null===(s=this.tcData)||void 0===s?void 0:s.cmpStatus,eventStatus:null===(a=this.tcData)||void 0===a?void 0:a.eventStatus}):!0===this.tcData.gdprApplies?this.handleGdprApplies(this.tcData,e):void this.logger.warn("[CMP-V2.2]: Unexpected gdprApplies status. Data: ".concat(JSON.stringify(this.tcData))):(this.logger.log("[CMP-V2.2]: TCData not yet set"),e({dataAvailable:!1,cmpStatus:void 0,eventStatus:void 0}))}},{key:"handleTCEvent",value:function(e,t){t&&e?(this.logger.log("[CMP-V2.2]: TCFv2 event listener triggered"),this.tcData=Object.assign({},e)):this.logger.log("[CMP-V2.2]: TCFv2 event listener failed - success ".concat(t," - tcData ").concat(JSON.stringify(e)))}}])}(ir),rr=function(){return o((function e(t,n,o,r,s,a,u){i(this,e),this.logger=n,this.reporter=o,this.stubFunctionsGenerator=r,this.consentUIPrompt=s,this.componentStateStore=a,this.settings=u,this.cmpLoadCounter=0,this.dialogShown=!1,this.browserWindow=t}),[{key:"enable",value:function(){this.componentStateStore.updateState("cmp",U(this.reporter.getElapsedTime())),this.generateStubs(),this.loadVersion()}},{key:"generateStubs",value:function(){this.settings.getCmpSkipStub()?this.logger.log("[CMP]: Skipping stubs"):this.stubFunctionsGenerator.generate(!this.settings.getDisableGppStub())}},{key:"loadVersion",value:function(){this.reporter.setStateStatus("cmp_load_wait_start"),this.logger.info("[CMP]: Wait for CMP to load"),this.checkForVersion2()}},{key:"makeVersion",value:function(){this.settings.getUseTcfV2()?(this.logger.log("[CMP]: Using deprecated TCFv2.0"),this.version=new nr(this.logger,this.browserWindow,this.consentUIPrompt)):(this.logger.log("[CMP]: Using TCFv2.2"),this.version=new or(this.logger,this.browserWindow,this.consentUIPrompt))}},{key:"versionLoader",value:function(e){var t=this,i=e.found,n=e.versionNumber;y(this.version)?this.logger.warn("[CMP]: Version already loaded: ".concat(n)):i?2===n?(this.reporter.setStateStatus("cmp_load_wait_finish"),this.reporter.reportCmpLoadFinish(),this.logger.debug("[CMP]: Loaded version ".concat(n)),this.makeVersion(),this.handleCmpLoaded()):(this.logger.error("[CMP]: Version ".concat(n," is not supported, disabling personalisation")),this.setDetermination("none",!0,!0)):(++this.cmpLoadCounter%10==0&&this.logger.debug("[CMP] Waiting for load"),setTimeout((function(){return t.checkForVersion2()}),50))}},{key:"checkForVersion2",value:function(){var e=this;if(this.settings.getCmpSkipStub()&&!this.browserWindow.__tcfapi)return this.logger.log("[CMP]: Stub function not setup yet"),this.versionLoader({found:!1,versionNumber:2});this.browserWindow.__tcfapi("ping",null,(function(t,i){var n=t.cmpLoaded;n&&e.browserWindow.Cookiebot&&!e.browserWindow.Cookiebot.userCountry&&(e.logger.log("[CMP]: CookieBot ping response when no user country: ".concat(i," - ").concat(JSON.stringify(t))),n=!1),e.versionLoader({found:n,versionNumber:2})}))}},{key:"checkForCCPA",value:function(e){var t;null===(t=this.version)||void 0===t||t.checkForCCPA(e)}},{key:"cmpLoaded",value:function(e){if(!y(this.version))return e(!1);this.version.cmpLoaded(e)}},{key:"getConsentData",value:function(e){var t;null===(t=this.version)||void 0===t||t.getConsentData(e)}},{key:"setGDPRConsentPrompt",value:function(){var e;null===(e=this.version)||void 0===e||e.setGDPRConsentPrompt()}},{key:"setCCPAConsentPrompt",value:function(){var e;null===(e=this.version)||void 0===e||e.setCCPAConsentPrompt()}},{key:"setNonPrivacyRegionsPrompt",value:function(){this.consentUIPrompt.setup("You are outside the CCPA jurisdiction.")}},{key:"handleGdprNotApplies",value:function(){var e=this;this.logger.info("[CMP]: GDPR does not apply");var t=!1,i=!1;setTimeout((function(){i||(i=!0,e.reporter.setStateStatus("cmp_check_for_ccpa_timeout"),e.logger.warn("[CMP]: USP API is not responding, continue as if not in CCPA region"),e.setDetermination("none",!0,!0))}),2e3),this.reporter.setStateStatus("cmp_check_for_ccpa_start"),this.checkForCCPA((function(n){var o=n.applies,r=n.privacyString;i?e.logger.warn("[CMP]: Got CCPA response, but timeout already reached"):(i=!0,e.reporter.setStateStatus("cmp_check_for_ccpa_finish"),o?(e.setCCPAConsentPrompt(),t="Y"===(null==r?void 0:r[2].toUpperCase()),e.logger.info("[CMP]: CCPA applies. disablePersonalisation: ".concat(t)),e.setDetermination("ccpa",!t,!1)):(e.logger.info("[CMP]: Not in CCPA region, continue with personalisation"),e.setNonPrivacyRegionsPrompt(),e.setDetermination("none",!0,!1)))}))}},{key:"handleGdprApplies",value:function(){var e=this;this.logger.log("[CMP]: GDPR applies, checking if personalisation is allowed"),this.reporter.setStateStatus("cmp_gdpr_choice_wait_start"),this.setGDPRConsentPrompt();var t=!1;this.getConsentData((function(i){var n=i.gdprChoiceReceived,o=i.personalisedAdsConsent,r=i.tcData;if(n&&(t=!0,e.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),e.logger.info("[CMP]: GDPR decision received via short-circuit. Allow personalisation: ".concat(o)),e.setDetermination("gdpr",Boolean(o),!1,r)),!t){e.dialogShown=!0,e.reporter.setStateStatus("cmp_prompt_shown");var s=0,a=setInterval((function(){e.getConsentData((function(i){var n=i.gdprChoiceReceived,o=i.personalisedAdsConsent,r=i.cmpStatus,u=i.eventStatus,l=i.tcData;n?(t=!0,e.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),e.logger.info("[CMP]: GDPR decision received. Allow personalisation: ".concat(o)),clearInterval(a),e.setDetermination("gdpr",Boolean(o),!1,l)):++s%10==0&&e.logger.info("[CMP]: Waiting for GDPR personalisation choice. cmpStatus: ".concat(r,", eventStatus: ").concat(u))}))}),100)}}))}},{key:"handleCmpLoaded",value:function(){var e=this;this.logger.info("[CMP]: Checking if the GDPR applies"),this.reporter.setStateStatus("cmp_gdpr_applies_check_start");var t=function(t,i){e.reporter.setStateStatus("cmp_gdpr_applies_check_finish"),!1===t?e.handleGdprNotApplies():e.settings.isRequestGdprPersonalisation()?e.handleGdprApplies():(e.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),e.logger.info("[CMP]: The GDPR applies, but we will assume they do not allow personalisation (show limited ads)"),e.setDetermination("gdpr",!1,!1,i))};this.getConsentData((function(i){var n=i.gdprApplies,o=i.tcData;if(m(n)){var r=0;e.logger.debug("[CMP]: Setting a check interval of ".concat(250,"ms"));var s=!1,a=setInterval((function(){e.getConsentData((function(i){var n=i.gdprApplies,o=i.tcData;m(n)?r++%4==0&&e.logger.info("[CMP]: Waiting for GDPR determination"):(clearInterval(a),s||(s=!0,t(n,o)))}))}),250)}else e.logger.debug("[CMP]: GDPR status already available, processing immediately"),t(n,o)}))}},{key:"setDetermination",value:function(e,t,i,n){var o=this.componentStateStore.state.cmp._tag;if("gdpr"===e&&this.reporter.reportCmpGdprDetermined(),"loading"==o){var r={jurisdiction:e,timeout:i,allowPersonalisation:t,dialogShown:this.dialogShown,noCmpTestResult:this.settings.isNoCmpTestMode()?e:void 0,tcData:n};this.logger.info("[CMP]: Determination: ".concat(JSON.stringify(r)));var s=this.reporter.getElapsedTime();this.componentStateStore.updateState("cmp",G(this.componentStateStore.state.cmp,s,r))}else this.logger.error("[CMP]: CMP in unexpected state: ".concat(o))}}])}(),sr=function(){return o((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div[data-fuse-privacy-tool]",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fuse-privacy-tool";i(this,e),this.browserWindow=t,this.domSelector=n,this.elementId=o}),[{key:"setup",value:function(e,t){var i=this.browserWindow.document.querySelector(this.domSelector);if(i)if(t){var n=document.createElement("a");n.href="javascript:void(0)",n.id=this.elementId,n.innerHTML=e,n.addEventListener("click",t),i.appendChild(n)}else i.textContent=e}}])}(),ar=function(){return o((function e(t,n){i(this,e),this.logger=t,this.tcData={cmpStatus:"loaded",eventStatus:"tcloaded",tcfPolicyVersion:2,cmpVersion:44,cmpId:10},this._listenerId=1,this._eventListeners={},this.browserWindow=n,this.allowedOrigin=n.document.referrer?new URL(n.document.referrer).origin:""}),[{key:"load",value:function(){var e=this;this.browserWindow.__tcfapi=function(t,i,n,o){switch(t){case"ping":return e._handlePing(n);case"getTCData":return e._handleGetTCData(n);case"addEventListener":return e._addTcfEventListener(n);case"removeEventListener":return"number"==typeof o&&(e.logger.log("[CMP]: Removing Event Listener ID: ".concat(o)),delete e._eventListeners["".concat(o)]),n(Object.assign({},e.tcData),!0);default:return e.logger.log("[CMP]: Unsupported command: ".concat(t)),n({},!1)}},this.browserWindow.addEventListener("message",(function(t){var i;if(e.allowedOrigin&&t.origin!==e.allowedOrigin)e.logger.log("[CMP]: Ignoring message from origin ".concat(t.origin));else{if("set-tc-data"===t.data.type){e.tcData=Object.assign({},t.data.data);var n=["tcloaded","useractioncomplete"].includes(e.tcData.eventStatus)?"tcloaded":e.tcData.eventStatus;return e.logger.log("[CMP]: Calling event listeners with event status ".concat(n)),void Object.entries(e._eventListeners).forEach((function(t){var i=c(t,2),o=i[0];(0,i[1])(Object.assign(Object.assign({},e.tcData),{listenerId:parseInt(o,10),eventStatus:n}),!0)}))}e.logger.log("[CMP]: unknown iframe message: ".concat(null===(i=t.data)||void 0===i?void 0:i.type))}}))}},{key:"_addTcfEventListener",value:function(e){this.logger.log("[CMP]: Adding Event Listener. Listener ID: ".concat(this._listenerId)),this._eventListeners["".concat(this._listenerId)]=e;var t=Object.assign(Object.assign({},this.tcData),{listenerId:this._listenerId});return this._listenerId++,e(t,!0)}},{key:"_handlePing",value:function(e){e({cmpLoaded:!0,cmpStatus:this.tcData.cmpStatus,cmpVersion:this.tcData.cmpVersion,displayStatus:"disabled",apiVersion:"2",cmpId:this.tcData.cmpId,gdprApplies:this.tcData.gdprApplies})}},{key:"_handleGetTCData",value:function(e){e(Object.assign({},this.tcData),!0)}}])}(),ur=new(function(){return o((function e(){i(this,e)}),[{key:"getStubFunctionsGenerator",value:function(){return this.stubFunctionsGenerator||(this.stubFunctionsGenerator=new $o(E.getLogger(),E.getBrowserWindowObject())),this.stubFunctionsGenerator}},{key:"getConsentManager",value:function(){return this.consentManager||(this.consentManager=new rr(E.getBrowserWindowObject(),E.getLogger(),Pt.getReporter(),this.getStubFunctionsGenerator(),new sr(E.getBrowserWindowObject()),Pt.getComponentStatusStore(),kt.getSettings())),this.consentManager}},{key:"getCmpProviderLoader",value:function(){return this.cmpProviderLoader||(this.cmpProviderLoader=new Xo(E.getLogger(),E.getBrowserWindowObject(),Pt.getReporter())),this.cmpProviderLoader}},{key:"getIframeCmpManager",value:function(){return this.iframeCmpManager||(this.iframeCmpManager=new ar(E.getLogger(),E.getBrowserWindowObject())),this.iframeCmpManager}}])}());var lr=E.getLogger();function cr(e,t,i,n,o,r,s){try{if(window.__iwcshook__&&window.__iwcshook__(),t&&0!==t.length&&i&&n&&o&&r&&s&&(e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[],e.googletag.cmd.push)&&!e.googletag.__yb_init){e.googletag.__yb_init=1;var a,u=function(){a=Date.now()},l=window.document.hasFocus();l&&u();try{window.addEventListener("focus",(function(){try{l=!0,u()}catch(e){}})),window.addEventListener("focusin",(function(){try{l=!0,u()}catch(e){}})),window.addEventListener("blur",(function(){try{l=window.document.hasFocus()}catch(e){}})),window.addEventListener("focusout",(function(){try{l=window.document.hasFocus()}catch(e){}}));var c,d="mousedown scroll touchstart touchend".split(" ");for(c in d)window.addEventListener(d[c],u)}catch(r){}var g=function(e){return parseInt(100*e+1e-4)},h=function(){var e,t=["0.01~0.0~testbid#1vi8sg0#e8eqyo#1dqyry8#n41r7k#1mmls74#5crqps#14vbrpc#rjv9c0#1r2fabk#9sl8u8#19b59ts#io8934#1i6sa2o#wy8lc#10fi9kw#y7liio#1xq5ji8#ggbi0w#1fyvj0g#pbyi9s#1ouij9c#7kohs0#1738irk#trs0e8#1tac1ds#c0hzwg#1bj20w0#kw505c,1kep14w","0.01~0.3~34uznk#12nf0n4#x3n4zk#1wm75z4#fcd4hs#1eux5hc#o804qo#1nqk5q8#6gq48w#15za58g#sntmv4#1s6dnuo#awjmdc#1af3ncw#js6mm8#1jaqnls#20wm4g#11jgn40#zbjw1s#1yu3x1c#hk9vk0#1h2twjk#qfwvsw#1pygwsg#8omvb4#1876wao#1ueaeww,uvqdxc#d4gdfk","0.01~0.59~1cn0ef4#m03dog#1lineo0#48td6o#13rde68#vfpkow#1uy9log#dofk74#1d6zl6o#mk2kg0#1m2mlfk#4ssjy8#14bckxs#qzw2kg#1qig3k0#98m22o#18r6328#i492bk#1hmt3b4#cz1ts#zvj2tc#xnmbr4#1x66cqo#fwcb9c#1fewc8w#orzbi8#1oajchs#70pb0g#16j9c00#t7stmo#1sqcum8#bgit4w#1az2u4g#kc5tds#1jupudc#2kvsw0#123ftvk#wjny80#1w27z7k#esdxq8#1eaxyps#no0xz4#1n6kyyo#5wqxhc#15faygw#s3ug3k#1rmeh34#ackfls#19v4glc#j87fuo#1iqrgu8#1gxfcw#10zhgcg#yrkpa8,1ya4q9s#h0aosg#1giups0#pvxp1c","0.01~1.17~1pehq0w#84nojk#17n7pj4#ubr75s#1tub85c#ckh6o0#1c317nk#lg46ww#1kyo7wg#3ou6f4#137e7eo#vpp62o#1v89728#dyf5kw#1dgz6kg#mu25ts#1mcm6tc#52s5c0#14lc6bk#r9vny8#1qsfoxs#9ilngg#1915og0#ie8npc#1hwsoow#myn7k#105io74#xxlx4w#1xg5y4g#g6bwn4#1fovxmo#p1yww0#1okixvk#7aowe8#16t8xds#thsf0g#1t0cg00#bqieio#1b92fi8#km5erk#1k4pfr4#2uve9s#12dff9c#wtnjls#1wc7klc#f2dj40#1ekxk3k#ny0jcw#1ngkkcg#66qiv4#15pajuo#sdu1hc#1rwe2gw#amk0zk#1a541z4#ji718g#1j0r280#1qx0qo#119h1q8#z1kao0#1yk4bnk#haaa68#1gsub5s#q5xaf4#1pohbeo#8en9xc#17x7aww#ulqsjk#1u4atj4#cugs1s#1cd0t1c#lq3sao#1l8nta8#3ytrsw#13hdssg#v5pzb4#1uoa0ao#defytc#1cwzzsw#ma2z28#1lsn01s#4isykg#141czk0#1q8gi68,qpwh6o","0.02~2.02~8ymgow,18h6hog#hu9gxs,1hcthxc#2zgg0,zljhfk#xdmqdc,1ww6rcw#fmcpvk","0.01~2.11~1f4wqv4#ohzq4g#1o0jr40#6qppmo#1699qm8#sxt88w#1sgd98g#b6j7r4#1ap38qo#k26800#1jkq8zk#2aw7i8#11tg8hs#w9ocu8#1vs8dts,eieccg","0.02~2.27~1e0ydc0,ne1clc#1mwldkw,5mrc3k#155bd34,rtuups#1rcevpc","0.01~2.34~a2ku80#19l4v7k#iy7ugw#1igrvgg#16xtz4#10phuyo#yhl3wg#1y054w0#gqb3eo#1g8v4e8#ply3nk#1p4i4n4#7uo35s#17d845c#u1rls0#1tkbmrk#cahla8,1bt1m9s","0.02~2.52~1koomio,l64lj4#3eul1c,12xem0w#w4ok5c","0.01~2.57~1vn8l4w#edejnk#1dvykn4#n91jwg#1mrlkw0#5hrjeo#150bke8#rov20w#1r7f30g#9xl1j4#19g52io#it81s0#1ibs2rk#11y1a8#10ki29s#yclb7k#1xv5c74#glbaps#1g3vbpc#pgyayo#1oziby8#7poagw#1788bgg#twrt34#1tfbu2o#c5hslc#1bo1tkw#l14su8#1kjotts#39uscg#12setc0#x8mxog#1wr6yo0#fhcx6o#1ezwy68#oczxfk#1nvjyf4#6lpwxs#1649xxc#sstfk0#1sbdgjk#b1jf28#1ak3g1s#jx6fb4","0.05~3.05~1yz3pq8#8tmo00#1cs0740#vkpdds#1m7me4g#9dlurk#100ivi8#owz474#1svcnb4#2pvlkw#1efxreo#s8u8sg#1ivr9j4#h5ahhc#17s7i80#ll3zls#1vd8zr4#57ry0w#1965h4w#y2lpts#1opiqkg","0.06~4.09~bvi77k#12if7y8","0.05~4.2~o30c1s#1s1dv5s#1vwtfk","0.06~4.34~1gxu3uo#uqql8g","0.05~4.45~1ldnlz4#djfri8#146cs8w","0.06~4.59~hz99mo#1x16k1s","0.05~4.7~6vpibk#1au31fk#weo5j4","0.06~4.84~1n1l69s#a7kmww","0.05~4.95~10uhnnk#pqxwcg#1tpbfgg","0.06~5.09~3judq8#1dogvls","0.05~5.2~rhdczk#1i4adq8#gdtlog#170qmf4#ktn3sw#1wjp9mo#6e87wg#1aclr0g#z91zpc#1pvz0g0#d1yh34#13ovhts#mhko3k#1qfy77k#ah5hc#1fcefwg#t5axa8#1js7y0w#epw1ds#15ct24g#j5pji8#1y7mtxc#825s74#1c0jbb4#vn79q8#1ma4agw#9g3r40#1030ruo#ozh0jk#1sxujnk#2sdhxc#1eifnr4#sbc54w#1iy95vk#h7sdts#17upekg#lnlvy8#1uls3y8#4gb280#18eolc0#xb4u0w#1ny1urk#b41beo#11qyc5c#nbjg8w#1r9wzcw#14fxmo#1g6d81s#tz9pfk#1km6q68#eawnb4#14xto1s#iqq5fk#1xsnfuo#7n6e4g#1bljx8g#x651c0","0.5~8.5~fyu7ls#mwk268#8h569s#rwcr28#c1qy2o#i5i0hs#3q34lc#z2t8u8#ejnaio#pi794w#4z1atc#uhzy0w#assruo#k8eyv4#vpaf4#vegmio#gz1qm8#nwrl6o#6pgrgg#rnm3uo#d877y8#jbyadc#2ym8sg#xhdkw0","1.0~21.0~qgjcw0#tiew3k#l6r2m8#wpa800#mfp8u8#sly7ls#icd8g0#yfpon4#ov3oxs#uov5z4#ky0feo#vrklc0#nfwruo#r6raio#jp296o"],i={};for(e in t)try{var n,o=t[e].split("~"),r=g(parseFloat(o[0])),s=g(parseFloat(o[1])),a=o[2].split("#"),u=0;for(n in a)try{var l,c=parseInt(u*r+s),d=[],h=a[n],f=(-1!==h.indexOf(",")?d=h.split(","):d.push(h),c/100);for(l in d)i[d[l]]=f;u++}catch(e){}}catch(e){}return i}(),f=function(e,t){try{for(var i in e)if("string"==typeof e[i]){var n,o=e[i].split(",");for(n in t)for(var r in o)if(o[r]===t[n])return!0}}catch(e){}return!1},p=function(e){var t="u";try{var r,s=e.getTargeting(i);f(s,n)?t="b":f(s,o)?t="o":(r=googletag.pubads().getTargeting(i),f(r,n)?t="b":f(r,o)&&(t="o"))}catch(e){}return t},v=function(e){var t=[{inclusive_min:0,exclusive_max:10,delta:.01},{inclusive_min:10,exclusive_max:20,delta:.05},{inclusive_min:20,exclusive_max:100,delta:.5},{inclusive_min:100,exclusive_max:101,delta:1}];if(e<0)return e;var i,n=g(e);for(i in t){var o=g((s=t[i]).inclusive_min),r=g(s.exclusive_max),s=g(s.delta);if(o<=n&&n<r)return parseInt(n/s)*s}return g(t[t.length-1].inclusive_min)},b=function(e){try{var t,i,n,o,r,s,a,u,l,c,d;e.getTargeting&&e.__setTargeting&&(t=[],i=l=null,"o"!==(n=p(e))&&"b"!==n||(l="nobidder",i=u=-1,o=e.getTargeting("amznbid")[0],void 0===(r=h[o])&&(r=-1),s=function(e){return parseFloat(e)}(e.getTargeting("hb_pb")[0]||-1),a=e.getTargeting("hb_bidder")[0]||"hb_pb_unknown",-1===r&&-1===s||(s<=r?(u=r,l="amznbid",void 0!==(c=e.getTargeting("amznsz")[0])&&(i="a"+c)):(u=s,l=a,void 0!==(d=e.getTargeting("hb_size")[0])&&(i="p"+d))),t=[u=v(u).toString()],"o"===n&&t.push("o_"+u)),e.__setTargeting("in2w_upa_price",t),e.__setTargeting("in2w_upa_bidder",l),e.__setTargeting("in2w_upa_size",i))}catch(e){}};try{var m=new Date,S=new Date(m.toLocaleString("en-US",{timeZone:"UTC"})),y=(new Date(m.toLocaleString("en-US",{timeZone:s})).getTime()-S.getTime())/36e5}catch(r){y=-8}var k,I=r,w=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],E={"1_0010":"01","1_0011":"02","1_0020":"03","1_0021":"04","1_0110":"05","1_0111":"06","1_0120":"07","1_0121":"08","1_0310":"09","1_0311":"0a","1_0320":"0b","1_0321":"0c","1_0610":"0d","1_0611":"0e","1_0620":"0f","1_0621":"0g","1_0810":"0h","1_0811":"0i","1_0820":"0j","1_0821":"0k","2_0000":"19","2_0001":"1a","2_0002":"1b","2_000z":"1c","2_0030":"1d","2_0031":"1e","2_0032":"1f","2_003z":"1g","2_0100":"1h","2_0101":"1i","2_0102":"1j","2_010z":"1k","2_0130":"1l","2_0131":"1m","2_0132":"1n","2_013z":"1o","2_0300":"1p","2_0301":"1q","2_0302":"1r","2_030z":"1s","2_0330":"1t","2_0331":"1u","2_0332":"1v","2_033z":"1w","2_0600":"1x","2_0601":"1y","2_0602":"1z","2_060z":"20","2_0630":"21","2_0631":"22","2_0632":"23","2_063z":"24","2_0800":"25","2_0801":"26","2_0802":"27","2_080z":"28","2_0830":"29","2_0831":"2a","2_0832":"2b","2_083z":"2c","1_0z10":"3l","1_0z11":"3m","1_0z20":"3n","1_0z21":"3o","2_0z00":"3x","2_0z01":"3y","2_0z02":"3z","2_0z0z":"40","2_0z30":"41","2_0z31":"42","2_0z32":"43","2_0z3z":"44"},C={gpt:0,amp:1,video:2,mobile:3,gpt_lite:4,adx_tag:5},T={out_of_page:0,anchor:1,app_open:2,banner:3,instream_audio:4,instream_video:5,interstitial:6,native_advance:7,rewarded:8,others:35},x={desktop:0,smartphone:1,tablet:2,connecttv:3,others:35},_={ios:0,android:1,macos:2,windows:3,others:35},A={chrome:0,safari:1,edge:2,others:35},R={},P={},O={childDirectedTreatment:1,underAgeOfConsent:8,nonPersonalizedAds:64,limitedAds:256,restrictDataProcessing:1024},D={},z=function(){var e=window.navigator;return(e=e&&e.userAgent)||""},L=function(){var e=window.navigator;return(e=e&&e.userAgentData)||null},N=function(e){return W(e,"Win")?"windows":W(e,"like Mac")?"ios":W(e,"Mac")?"macos":W(e,"Android")?"android":"others"},B=function(e){return F(e)?"tablet":M(e)?"smartphone":j(e)?"connecttv":"desktop"},M=function(e){return W(e,"iPod")||W(e,"iPhone")||W(e,"Android")||W(e,"IEMobile")},F=function(e){return W(e,"iPad")||W(e,"Tablet")||W(e,"Android")&&!W(e,"Mobile")||W(e,"Silk")},j=function(e){return W(e,"Roku")||W(e,"SMART-TV")||W(e,"SmartTV")||W(e,"NetCast")||W(e,"crkey")},U=function(e,t){return(t=G(t))||(W(e,"OPR/")||W(e,"Opera")?"others":W(e,"Edg")?"edge":W(e,"Firefox")?"others":W(e,"Chrome")?"chrome":W(e,"Safari")||W(e,"iPad")||W(e,"iPhone")||W(e,"iphone")?"safari":"others")},G=function(e){if(e&&e.brands){if(V(e.brands,"Opera"))return"opera";if(V(e.brands,"Microsoft Edge"))return"edge";if(V(e.brands,"Chrome"))return"chrome"}return null},W=function(e,t){return-1!==e.indexOf(t)},V=function(e,t){return e.some((function(e){return e.brand===t}))},H=function(e,t){if(e)return["0"];for(var i=Math.floor(1e3*Math.random()+1),n=[],o=0,r=0;r<t.length;++r){for(var s=1,a=t[r],u=0,l=0;l<a.length;l++)if(i<=(u+=a[l])){s=l+1;break}1<s&&0<o&&(s=s+o-1),o+=t[r].length;var c=w[s];for(l=0;l<n.length;++l)if(n[l]===c){l=-1;break}-1!==l&&n.push(c)}return n},Z=null,q=null,Y=function(e){e=(new Date).getTime()+36e5*e;var t=parseInt(e/36e5,10)%24;return[[1,0],[3,24],[6,32]].map((function(e){return w[Math.floor(t/e[0])+e[1]]}))},J=function(){var e,t,i;return k||(i=function(){var e=z(),t=L();return{os:N(e),dc:B(e),browser:U(e,t)}}(),e=void 0!==A[i.browser]?A[i.browser]:A.others,t=void 0!==_[i.os]?_[i.os]:_.others,i=void 0!==x[i.dc]?x[i.dc]:x.others,k={dc:w[i],os:w[t],browser:w[e]}),k},Q=function(e,t){if(void 0===(e=C[e]))throw new Error;return t=void 0!==T[t="top_anchor"!==t&&"bottom_anchor"!==t?t:"anchor"]?T[t]:T.others,{rt:w[e],ivf:w[t]}},K=function(e){var t;return R[e]||(t=function(){var e=window.navigator;return(e=e&&e.language)||""}(),R[e]=oe(t,e)),R[e]},X=function(e){var t;return P[e]||(t=function(){var e=window.location;return(e=e&&e.hostname)||""}(),P[e]=ne(t,e)),P[e]},$=function(e,t,i,n,o,r,s,a){var u=[],l=("0"===i||"3"===i?(o=E["2_"+e+t+i+o])&&u.push(o):(o=E["1_"+e+t+i+n])&&u.push(o),[]),c=[];for(g in u){var d=u[g];l.push("-"+d);for(var g=0;g<r.length;++g){var h=d+r[g];for(p in l.push(h),a){var f=a[p];c.push(h+f)}}for(g=0;g<s.length;++g){var p;h="_"+d+s[g];for(p in l.push(h),a)f=a[p],c.push(h+f)}}return{short:l,full:c}},ee=function(e){try{if(!e.length)return"0";for(var t=305419896,i=0;i<e.length;++i)t^=(t<<5)+(t>>2)+e.charCodeAt(i)&4294967295;return(t<0?4294967296+t:t)+""}catch(e){return"-1"}},te=function(e,t){try{var i=t?(e+"").toLowerCase():e+"";return i.length+"_"+ee(i)}catch(e){return"-1"}},ie=function(e){var t;try{t=""===e||null==e?"-2":te(e,!0)}catch(e){t="-1"}return t},ne=function(e,t){var i,n,o=[];try{""===e||null==e?o=["-2"]:(i=e.split(".")).length<2?o=["-3"]:(n=i[i.length-2]+"."+i[i.length-1],o.push(te(n,!0)))}catch(e){o=["-1"]}if(!t)for(var r=o.length,s=0;s<r;++s)o.push("o_"+o[s]);return o},oe=function(e,t){var i,n,o,r,s,a=[];try{""===e||null==e?a=["-2"]:(n=(i=e.split("-"))[0],o=te(n,!0),a.push(o),1<i.length&&(r=i[0]+"-"+i[1],s=te(r,!0),a.push(s)))}catch(e){a=["-1"]}if(!t)for(var u=a.length,l=0;l<u;++l)a.push("o_"+a[l]);return a},re=function(e,t){var i=["u"];try{if(""===e||null==e)throw i=["u1"],new Error("u1");var n=window.document.getElementById(e);if(null==n)throw i=["u2"],new Error("u2");var o,r,s=n.getBoundingClientRect().y,a=window.innerHeight;if(a<=0)throw i=["u3"],new Error("u3");i=s<0?["a","a"+(o=(o=parseInt(s/a,10)-1)<-2?-2:o)]:s<a?["i","i"+(parseInt(s/(a/3),10)+1)]:["b","b"+(r=9<(r=parseInt((s-a)/a,10)+1)?9:r),"bg"+Math.ceil(r/3)]}catch(e){}if(!t)for(var u=i.length,l=0;l<u;++l)i.push("o_"+i[l]);return i},se=function(e){var t=[];try{var i,n=0;for(i in O)!!(2751&O[i])&&t.push(O[i].toString(36)),n+=O[i];t.push(n.toString(36))}catch(e){t=["-1"]}if(!e)for(var o=t.length,r=0;r<o;++r)t.push("o_"+t[r]);return t},ae=function(e){try{return D[e]||(D[e]=se(e)),D[e]}catch(e){return["-1"]}},ue=function(e,t){return(t-=(e+="").length)<=0?e:function(e,t){for(var i="",n=0;n<t;n++)i+=e;return i}("0",t)+e},le=function(){try{var e=1+parseInt(20*Math.random(),10);return ue(e,2)}catch(e){return"-1"}},ce=function(e,t){var i=[];try{var n=(new Date).getTime()+36e5*e,o=parseInt(n/36e5,10)%24,r=Math.floor(o);i.push(ue(r,2))}catch(e){i=["-1"]}if(!t)for(var s=i.length,a=0;a<s;++a)i.push("o_"+i[a]);return i},de=function(e){var t=[];try{var i,n=l?"1":"0",o=(i=null==a?"0":(Date.now()-a)/1e3<=3?"1":"2","visible"===window.document.visibilityState?"1":"0");t.push(n+i+o)}catch(e){t=["-1"]}if(!e)for(var r=t.length,s=0;s<r;++s)t.push("o_"+t[s]);return t},ge=function(e,t,i,n,o,r,s,a){try{if("u"===i)return[{key:"in2w_key16",values:[]},{key:"in2w_key20",values:[]},{key:"in2w_key21",values:null},{key:"in2w_key23",values:null},{key:"in2w_key24",values:[]},{key:"in2w_key26",values:[]},{key:"in2w_key27",values:[]},{key:"in2w_key28",values:[]},{key:"in2w_key30",values:null},{key:"in2w_key31",values:[]},{key:"in2w_key33",values:[]},{key:"in2w_upa_bidder",values:null},{key:"in2w_upa_price",values:[]},{key:"in2w_upa_size",values:null}];var u,l=Q(n,o),c=J(),d=l.rt,g=l.ivf,h=c.dc,f=c.os,p=c.browser,v="b"===i,b=H(v,t),m=function(e,t){return e?["0"]:((null===Z||null===q||36e5<Date.now()-q)&&(Z=H(!1,t),q=Date.now()),Z)}(v,t),S=Y(e),y=$(d,g,h,f,p,b,m,S),k=(v&&(y.short=[]),[]),I=(r&&r.length&&k.push(function(e){var t,i,n,o=e,r=[],s=1e5,a=1,u=1e5,l=1;for(t in o="fluid"===e||"number"==typeof o[0]&&"number"==typeof o[1]?[e]:o)"fluid"===o[t]?r.push(o[t]):((i=o[t][0])<s&&(s=i),a<i&&(a=i),(n=o[t][1])<u&&(u=n),l<n&&(l=n),r.push(i+"x"+n));return r.sort((function(e,t){return e<t?-1:1})),e=r.length,r.push(s),r.push(a),r.push(u),r.push(l),r.push(e),ee(r.join(","))}(r)),[{key:"in2w_key16",values:y.short},{key:"in2w_key20",values:y.full},{key:"in2w_key21",values:k}]),w=["in2w_key23","in2w_key24","in2w_key26","in2w_key27","in2w_key28","in2w_key30","in2w_key31","in2w_key33"];for(u in w)try{switch(w[u]){case"in2w_key23":I.push({key:w[u],values:ie(s)});break;case"in2w_key24":I.push({key:w[u],values:X(v)});break;case"in2w_key26":I.push({key:w[u],values:K(v)});break;case"in2w_key27":I.push({key:w[u],values:re(a,v)});break;case"in2w_key28":I.push({key:w[u],values:ae(v)});break;case"in2w_key30":I.push({key:w[u],values:le()});break;case"in2w_key31":I.push({key:w[u],values:ce(e,v)});break;case"in2w_key33":I.push({key:w[u],values:de(v)})}}catch(e){}return I}catch(e){return[{key:"in2w_key20",values:["4p10","4p1o","4p1w"]}]}},he=function(e){try{if(e.__should_skip_labeling)e.__should_skip_labeling=!1;else{var t,i=p(e),n="banner";if(e.__is_oop)n=googletag.enums.OutOfPageFormat[e.__oop_format]?googletag.enums.OutOfPageFormat[e.__oop_format].toLowerCase():"out_of_page";else try{if(e.__sz_mapping){var o=Math.round(window.innerWidth),r=Math.round(window.innerHeight);for(a in e.__sz_mapping){var s=e.__sz_mapping[a][0];if(s[0]<=o&&s[1]<=r){t=e.__sz_mapping[a][1];break}}}else e.__def_sizes&&(t=e.__def_sizes)}catch(e){}var a,u=ge(y,I,i,"gpt",n,t,e.getAdUnitPath(),e.getSlotElementId());for(a in u)e.__setTargeting(u[a].key,u[a].values)}}catch(e){}},fe=function(){var i=["slotRequested","slotResponseReceived","slotRenderEnded","slotOnload","impressionViewable","slotVisibilityChanged"],n=i.slice(1),o=e.googletag.pubads(),r=(o.__product_version=3,o.__build_id="5588f327-6b8a-4324-8ffe-bce40863e7b1",o.__hook_version=8,e.googletag.__display=e.googletag.display,e.googletag.display=function(t){var i=[];for(n in arguments)i.push(arguments[n]);try{var n,r=this.pubads().getSlots();for(n in r){var s=r[n];b(s)}}catch(t){}return e.googletag.__display.apply(o,i)}.bind(e.googletag),o.__refresh=o.refresh,o.refresh=function(e){var t=[];for(i in arguments)t.push(arguments[i]);try{for(var i in e=e||this.getSlots()){var n,r=e[i],s=(b(r),n=a=c=l=u=void 0,r);try{var a,u=null,l=null,c=p(s);"o"!==c&&"b"!==c||(0<(a=s.__refreshCount||0)&&(l="1"),u=c+((n=a)<11?n:n<26?"10-":n<51?"25-":n<101?"50-":"100-")),s.setTargeting("in2w_key15",u),s.__setTargeting("in2w_key22",l)}catch(e){}}}catch(e){}o.__refresh.apply(o,t)}.bind(o),o.__setPrivacySettings=o.setPrivacySettings,o.setPrivacySettings=function(e){var t,i=[];for(t in arguments)i.push(arguments[t]);try{void 0!==e.childDirectedTreatment&&(null===e.childDirectedTreatment?O.childDirectedTreatment=1:e.childDirectedTreatment?O.childDirectedTreatment=4:O.childDirectedTreatment=2),void 0!==e.underAgeOfConsent&&(null===e.underAgeOfConsent?O.underAgeOfConsent=8:e.underAgeOfConsent?O.underAgeOfConsent=32:O.underAgeOfConsent=16),void 0!==e.nonPersonalizedAds&&(e.nonPersonalizedAds?O.nonPersonalizedAds=128:O.nonPersonalizedAds=64),void 0!==e.limitedAds&&(e.limitedAds?O.limitedAds=512:O.limitedAds=256),void 0!==e.restrictDataProcessing&&(e.restrictDataProcessing?O.restrictDataProcessing=2048:O.restrictDataProcessing=1024),D[!0]=se(!0),D[!1]=se(!1)}catch(e){}return o.__setPrivacySettings.apply(o,i)}.bind(o),o.__setTargeting=o.setTargeting,o.__clearTargeting=o.clearTargeting,e.googletag.__defineOutOfPageSlot=e.googletag.defineOutOfPageSlot,e.googletag.__defineSlot=e.googletag.defineSlot,o.setTargeting=function(){var e=[];for(i in arguments)e.push(arguments[i]);var t=o.__setTargeting.apply(o,e);try{var i,n=this.getSlots();for(i in n){var r=n[i];he(r)}}catch(e){}return t}.bind(o),o.clearTargeting=function(){var e=[];for(i in arguments)e.push(arguments[i]);var t=o.__clearTargeting.apply(o,e);try{var i,n=this.getSlots();for(i in n){var r=n[i];he(r)}}catch(e){}return t}.bind(o),function(e){e.__setTargeting=e.setTargeting,e.setTargeting=function(){var t,i=[];for(t in arguments)i.push(arguments[t]);var n=e.__setTargeting.apply(e,i);return he(e),n}.bind(e)}),s=function(e){e.__clearTargeting=e.clearTargeting,e.clearTargeting=function(){var t,i=[];for(t in arguments)i.push(arguments[t]);var n=e.__clearTargeting.apply(e,i);return he(e),n}.bind(e)},a=function(e){e.__updateTargetingFromMap=e.updateTargetingFromMap,e.updateTargetingFromMap=function(){try{var t,i=[];for(t in arguments)i.push(arguments[t]);e.__updateTargetingFromMap.apply(e,i),b(e)}catch(t){}return e}.bind(e)};e.googletag.defineOutOfPageSlot=function(){var t,i=[];for(t in arguments)i.push(arguments[t]);var n=e.googletag.__defineOutOfPageSlot.apply(e.googletag,i);return n&&(n.__is_oop=!0,n.__oop_format=i[1],r(n),s(n),a(n),he(n)),n}.bind(e.googletag),e.googletag.defineSlot=function(){var t,i=[];for(t in arguments)i.push(arguments[t]);var n=e.googletag.__defineSlot.apply(e.googletag,i);return n&&(n.__is_oop=!1,n.__def_sizes=arguments[1],r(n),s(n),a(n),n.__defineSizeMapping=n.defineSizeMapping,n.defineSizeMapping=function(e){var t,i=[];for(t in arguments)i.push(arguments[t]);var o=n.__defineSizeMapping.apply(n,i);return n.__sz_mapping=e,he(n),o}.bind(n),he(n)),n}.bind(e.googletag);try{var u,l=o.getSlots();for(u in l)try{var c=l[u];void 0!==c.__setTargeting||c.getOutOfPage()||(c.__is_oop=!1,r(c),s(c),he(c))}catch(u){}}catch(u){}o.__reportEvents=function(e,t){if(o.__eventProxy&&o.__eventProxy[e])for(var i in o.__eventProxy[e])try{o.__eventProxy[e][i](t)}catch(e){}},o.__addEventListener=o.addEventListener,o.addEventListener=function(e,r){if(-1!==i.indexOf(e))try{return this.__eventProxy=this.__eventProxy||{},this.__eventProxy[e]?(-1===this.__eventProxy[e].indexOf(r)&&this.__eventProxy[e].push(r),o):(this.__eventProxy[e]=[r],o.__addEventListener(e,(function(i){var r=i.slot;if(r.__skipEvent&&r.__skipEvent[e]&&(new Date).getTime()-r.__skipEvent[e]<3e3)delete r.__skipEvent[e];else if(-1===n.indexOf(e)||!function(e){return(e=e.__getResponseInformation?e.__getResponseInformation():e.getResponseInformation())&&e.advertiserId&&-1!==t.indexOf(e.advertiserId)}(r))for(var s in o.__eventProxy[e])try{o.__eventProxy[e][s](i)}catch(i){}})))}catch(r){}return o.__addEventListener(e,r)}.bind(o),o.__removeEventListener=o.removeEventListener,o.removeEventListener=function(e,t){try{var i=this.__eventProxy;if(i&&i[e])return-1!==i[e].indexOf(t)&&(i[e].splice(i[e].indexOf(t),1),!0)}catch(e){}return o.__removeEventListener(e,t)}.bind(o),o.addEventListener("slotRequested",(function(e){delete(e=e.slot).__responseInfo,e.__refreshCount=e.__refreshCount||0,++e.__refreshCount}))};e.googletag.cmd.unshift?(e.googletag.cmd.unshift(fe),e.googletag.cmd.unshift=function(t){e.googletag.cmd.splice(1,0,t)}):e.googletag.cmd.push(fe)}}catch(r){}}var dr,gr;if(null===(dr=window.self.fusetag)||void 0===dr?void 0:dr.loading){var hr="[FUSE]: Fusetag is already initialising, and may have been included in the page twice";throw console.error(hr),new Error(hr)}if(null===(gr=window.self.fusetag)||void 0===gr?void 0:gr.init){var fr="[FUSE]: Fusetag is already initialised, and may have been included in the page twice";throw console.error(fr),new Error(fr)}var pr=window.self.fusetag||(window.self.fusetag={que:[]});pr.loading=!0;var vr=Pt.getReporter(),br=E.getLogger(),mr=kt.getSettings();br.log("[INIT] Initialising with UUID ".concat(mr.getFuseUUID()));var Sr=ko.getController(),yr=ko.getApiV3(),kr=mn.getUam(),Ir=ur.getConsentManager(),wr=un.getInitManager(),Er=Bo.getWidgetsRenderer(),Cr=Bo.getInterstitialManager(),Tr=Pt.getTelemetry(),xr=ko.getPageManager(),_r=gt.getViewportInfo(),Ar=Pt.getComponentStatusStore();function Rr(e,t,i){e?(br.debug("[INIT]: Running second (".concat(t,") docReady auto-scan and auction")),vr.setStateStatus("second_autoscan_".concat(t,"_start")),Dr(),vr.setStateStatus("second_autoscan_".concat(t,"_finish")),br.debug("[INIT]: Finished second docReady DOM scan")):Ar.updateState("docReadyScan",G(i,vr.getElapsedTime(),void 0))}function Pr(){if(!mr.isUamEnabled())return Ar.updateState("uam",{_tag:"disabled"}),void br.info("[INIT]: Not loading Uam because it is disabled");var e=mr.getUamTagStartCutoffMs(),t=vr.getElapsedTime();if(!(m(e)||t<e))return Ar.updateState("uam",{_tag:"cancelled"}),void br.info("[INIT]: Deferring UAM load because fuse took ".concat(t,"ms to begin loading"));var i=function(e){T(et("fuseDelayUamInit"),"simulate uam download delay",br,(function(){var t=U(vr.getElapsedTime(),e);Ar.updateState("uam",t),kr.load(mr.isCmpRequired(),(function(){Ar.updateState("uam",G(t,vr.getElapsedTime(),void 0))}))}))};mr.isUamEnabledAtBP(_r.getCurrentBreakpoint().name)?i(!1):(Ar.updateState("uam",{_tag:"deferred"}),He.onBreakpointChanged.subscribe((function(e){var t=e.name;mr.isUamEnabledAtBP(t)&&"deferred"===Ar.state.uam._tag&&(br.info("[INIT]: UAM is enabled for breakpoint ".concat(t,", loading it now")),i(!0))})))}function Or(){mr.isCmpRequired()?("none"!==mr.getCmpProvider().partner&&T(et("fuseDelayQuantcastInit"),"simulate quantcast load delay",br,(function(){return ur.getCmpProviderLoader().load(mr.getCmpProvider())})),Ir.enable()):Ar.updateState("cmp",{_tag:"disabled"})}mr.getUseTelemetry()&&(Tr.prepareBackgroundRequestProcessor(),Tr.prepareRecordingWebVitals());var Dr=function(){Sr.registerAndRunAuction(!0,!1,yr)};function zr(){vr.setStateStatus("fuse_bootstrap_start");var e=E.getBrowserWindowObject(),t=e.scrollY;Ko.enableApi(pr);var i,n=mr.getTagStartCutoffMs(),o=vr.getElapsedTime();if(!(m(n)||o<n))return br.warn("[INIT]: Fuse will not show ads because it took ".concat(o,"ms before it began loading")),void vr.setStateStatus("fuse_bootstrap_finish");Or(),mr.isIframeCmp()&&ur.getIframeCmpManager().load(),C(mr.isPubxaiEnabled(),(function(){return mi.setStateStatus("pubxai_load_start"),void D({name:"Pubxai",url:"//cdn.pbxai.com/",file:"e81e688b-e119-4bf8-af5e-9c6af50622c1.js"},(function(){bi.log("[PUBXAI]: Script loaded"),mi.setStateStatus("pubxai_load_finish")}))})),C(mr.isIn2wInjection(),(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5068036699,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"America/Los_Angeles";lr.debug("[INIT]: loadIn2WGptHook: advertiserId: ".concat(t,", optRatio: ").concat(i,", timeZone: ").concat(n));try{var o=Zt();cr(e,[t],"intowow_optimized",["false"],["true"],[[900,10,10,10,10,10,10,10,10,10,10],[900,20,20,20,20,20]],n),qt((function(){var e=Math.random()<i?"true":"false";o.pubads().setTargeting("intowow_optimized",e)}))}catch(e){lr.error("[ERROR]: in2w threw an error during initialisation: ".concat(e))}}(e,mr.getIn2wAdvertiserId(),mr.getIn2wRatio(),mr.getIn2wAdvertiserTimeZone())})),C(mr.isIn2wSafeframe(),(function(){return mo.getIn2wSafeframe().enable()})),function(){if(!mr.isPrebidEnabled())return Ar.updateState("prebid",{_tag:"disabled"}),void br.info("[INIT]: Not loading Prebid because it is disabled");var e=mr.getPrebidTagStartCutoffMs(),t=vr.getElapsedTime();if(m(e)||t<e){var i=function(e){var t=U(vr.getElapsedTime(),e);Ar.updateState("prebid",t),Vn.enable((function(e){var i=vr.getElapsedTime()-e,n=mr.getPrebidDownloadCutoffMs();m(n)||i<=n?Ar.updateState("prebid",G(t,vr.getElapsedTime(),void 0)):(br.log("[PREBID]: Not enabling because library took ".concat(i,"ms to download")),Ar.updateState("prebid",{_tag:"cancelled"}))}))},n=_r.getCurrentBreakpoint().name;mr.isPrebidEnabledAtBP(n)?i(!1):(br.info("[INIT]: Prebid not enabled at breakpoint ".concat(n,", deferring initialisation")),Ar.updateState("prebid",{_tag:"deferred"}),He.onBreakpointChanged.subscribe((function(e){var t=e.name;mr.isPrebidEnabledAtBP(t)&&"deferred"===Ar.state.prebid._tag&&(br.info("[INIT]: Prebid is enabled for breakpoint ".concat(n,", loading it now")),i(!0))})))}else Ar.updateState("prebid",{_tag:"cancelled"}),br.info("[INIT]: Skipping prebid load because fuse took ".concat(t,"ms to begin loading"))}(),Pr(),mr.isYandexEnabled()?(Ar.updateState("gpt",{_tag:"disabled"}),function(){var e=U(vr.getElapsedTime());if(Ar.updateState("yandex",e),window.yaContextCb)Ar.updateState("yandex",G(e,vr.getElapsedTime(),void 0));else{var t=E.getBrowserWindowObject().document,i=t.createElement("script");i.innerHTML="window.yaContextCb=window.yaContextCb||[]",t.head.appendChild(i);var n=t.createElement("script");n.src="https://yandex.ru/ads/system/context.js",n.async=!0,t.head.appendChild(n);var o=setInterval((function(){var t,i;(null===(i=null===(t=window.Ya)||void 0===t?void 0:t.Context)||void 0===i?void 0:i.AdvManager)&&(Ar.updateState("yandex",G(e,vr.getElapsedTime(),void 0)),clearInterval(o))}),100)}}()):(Ar.updateState("yandex",{_tag:"disabled"}),i=U(vr.getElapsedTime()),Ar.updateState("gpt",i),ti((function(e){Ar.updateState("gpt",G(i,vr.getElapsedTime(),void 0)),Cr.initInterstitial()})),qt((function(){ui.enableIfApplicable()}))),mr.isGeoEdgeEnabled()&&mo.getGeoEdgeManager().init(),mr.isPrebidServer()&&mo.getAssertiveYieldManager().init(),C(mr.isConfiantEnabled(),(function(){return gi.enable(mr.getConfiantId())})),C(mr.isId5Enabled(),(function(){return ki.enable()})),C(mr.isIdentityEnabled(),(function(){return wi.enable(e)})),C(mr.getAfsSettings().enabled,(function(){return Co.getAfsManager().loadLibrary()})),C(mr.isResponsiveEnabled(),(function(){br.info("[INIT]: Enabling responsive"),ko.configureResponsive()})),C(mr.isPubstackEnabled(),(function(){return vi.enable(mr.getPubstackId())})),wr.setIsLowDwellPage(xr.isLowDwellUrl(e.location.toString())),function(e){try{e.log("[INIT][onFuseLoadCallback] Start"),e.debug("[INIT][onFuseLoadCallback] Finish")}catch(t){e.error("[INIT][onFuseLoadCallback] Encountered error during evaluation",t)}}(br,mr.getV2CompatOverrides(),ko.getApiV3()),mr.getUseTelemetry()&&Tr.recordFuseLoad(t),mr.isScanDOMOnPageLoad()?function(){var e=document.readyState,t=U(vr.getElapsedTime());if(Ar.updateState("docReadyScan",t),"complete"===e)br.info("[INIT]: Document state is already 'complete'"),Rr(!1,e,t);else{var i=!1;"interactive"===e&&(br.info("[INIT]: Document state is already 'interactive'"),i=!0,Rr(!1,e,t)),document.addEventListener("readystatechange",(function(){var e=document.readyState;vr.setStateStatus("document_readystatechange_".concat(e)),br.info("[INIT]: Received document '".concat(e,"' listener callback"));var n=i;i=!0,Rr(n,e,t)}))}}():Ar.updateState("docReadyScan",{_tag:"disabled"}),function(){if(mr.getIosChromeClickHandle()){var e=Pt.getDeviceInfo();e.getBrowser()===_.Chrome&&e.getOperatingSystem()===A.IOS&&(br.debug("[INIT]: Monitoring touch for Chrome on IOS"),gt.getTouchObserver().monitorTouchDetect(),gt.enableFastClick())}}(),He.onInitManagerReady.immediateOrOnce((function(){vr.setStateStatus("fuse_queue_start"),no(),vr.setStateStatus("fuse_queue_finish"),mr.isWidgetRendererEnabled()&&Er.init(),pr.initialised=!0,pr.init=!0,pr.loading=!1,vr.setStateStatus("tag_initialised"),wr.setTagInitialised(),(xr.isPageInitCalled()||mr.isScanDOMOnPageLoad()||mr.isAutoRegistrationEnabled())&&(vr.setStateStatus("fuse_trigger_auto_auction_start"),Sr.registerAndQueue(!0,!1,yr),vr.setStateStatus("fuse_trigger_auto_auction_finish"),mr.isAutoRegistrationEnabled()&&(Dr(),setInterval((function(){Dr()}),200))),vr.setStateStatus("on_tag_init_event_start"),Ko.tagInitEmitter.emit({}),He.onTagInitComplete.emit({tagInitUrl:e.location.href}),vr.setStateStatus("on_tag_init_event_finish"),Sr.runAuction();var t=He.onPageInit;t.subscribe((function(){return Cr.initInterstitial()})),t.subscribe((function(){br.debug("[PAGE]: Registering slots and running auction after PageInit"),wr.setIsLowDwellPage(xr.isLowDwellUrl(e.location.toString())),Dr()})),Bo.getVideoManager().init(),He.onPageReset.subscribe((function(){br.debug("[PAGE]: Received page reset event"),Cr.clearInterstitial()}))})),vr.setStateStatus("fuse_bootstrap_finish")}T(et("fuseDelayInit"),"simulate slow fuse download",br,(function(){return zr()}))}));
